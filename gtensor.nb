(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    142290,       4133]
NotebookOptionsPosition[    138912,       4016]
NotebookOutlinePosition[    139273,       4032]
CellTagsIndexPosition[    139230,       4029]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["solving issue with dipole radiation expression", "Chapter",
 CellChangeTimes->{{3.8086514969178176`*^9, 3.8086515119795575`*^9}}],

Cell[CellGroupData[{

Cell["Work out explicit form of derivative expression", "Section",
 CellChangeTimes->{{3.80865203815291*^9, 3.808652083140656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sphrWave", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], 
    RowBox[{" ", 
     RowBox[{"4", " ", "\[Pi]", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]}]]}], ";", 
  RowBox[{"(*", 
   RowBox[{"spherical", " ", "wave"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["K\[Delta]", 
    RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], ":=", 
   RowBox[{"KroneckerDelta", "[", 
    RowBox[{
     RowBox[{"SymbolName", "[", "\[Mu]", "]"}], ",", 
     RowBox[{"SymbolName", "[", "\[Nu]", "]"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"symbolic", " ", "Kronecker", " ", "delta"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dipOp", "[", 
    RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"#", ",", "\[Alpha]"}], "]"}], 
       RowBox[{"D", "[", 
        RowBox[{"#", ",", "\[Beta]"}], "]"}]}], "-", 
      RowBox[{
       SubscriptBox["K\[Delta]", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
       RowBox[{"Laplacian", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "-", 
      RowBox[{
       SubscriptBox["K\[Delta]", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
       RowBox[{"DiracDelta", "[", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], "]"}]}]}], ")"}], "&"}]}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "derivative", " ", "op", " ", "in", " ", "the", " ", "expression", " ", 
    "for", " ", "positive", " ", 
    RowBox[{"freq", ".", " ", "component"}], " ", "of", " ", "monochromatic", 
    " ", "dipole", " ", "radation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"\[Alpha]_", ",", "\[Beta]_"}]], ":=", 
   RowBox[{
    RowBox[{"dipOp", "[", 
     RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "[", 
    RowBox[{"sphrWave", "[", 
     RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.808652001284505*^9, 3.8086520344158945`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Below this line is debugging to verify the above expression in a less opaque \
way\
\>", "Subsubsection",
 CellChangeTimes->{{3.8079780697217836`*^9, 3.807978103162321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], 
    RowBox[{" ", 
     RowBox[{"4", " ", "\[Pi]", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]}]], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.8079757370943365`*^9, 3.8079757410696983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.8079757416092987`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["e", "ikr"], "x"}], 
   SuperscriptBox["r", "3"]], "+", 
  FractionBox[
   RowBox[{"i", " ", "k", " ", "x", " ", 
    SuperscriptBox["e", "ikr"]}], 
   SuperscriptBox["r", "2"]]}]], "Input",
 CellChangeTimes->{{3.8079757510689487`*^9, 3.8079757925440006`*^9}}],

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.807976043997475*^9, 3.8079760501978893`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]}]]}], "==", 
   RowBox[{
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "x"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "k"}], " ", "-", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.807976062599936*^9, 3.8079761863390427`*^9}, {
  3.8079762617699575`*^9, 3.8079762623563943`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8079761559684677`*^9, 3.8079761875976753`*^9}, 
   3.8079762632769814`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "x"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "k"}], " ", "-", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]]}], ")"}]}], ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.8079762711668186`*^9, 3.807976275630972*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y"}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], 
     RowBox[{"5", "/", "2"}]]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
   RowBox[{"2", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.80797627660527*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
        FractionBox["1", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
     RowBox[{"2", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x", " ", "y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
        FractionBox["1", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]]}], ")"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], "==", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]], "-", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "k"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"1", "/", "2"}]]], "-", 
      SuperscriptBox["k", "2"]}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8079766827068095`*^9, 3.8079767860686703`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8079767865763164`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplacian", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
     RowBox[{"4", " ", "\[Pi]", " ", "r"}]], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
    "\"\<Spherical\>\""}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.807977219076272*^9, 3.8079772928569117`*^9}, {
  3.807977392633808*^9, 3.8079773954903836`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", 
    SuperscriptBox["k", "2"]}], 
   RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}]], "Output",
 CellChangeTimes->{3.8079773959701366`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["r", "2"]], 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["r", "2"], 
      RowBox[{"D", "[", 
       RowBox[{
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
         RowBox[{"4", " ", "\[Pi]", " ", "r"}]], ",", "r"}], "]"}]}], ",", 
     "r"}], "]"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.807977505708973*^9, 3.807977533251077*^9}, {
  3.8079777127762003`*^9, 3.807977717746931*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", 
    SuperscriptBox["k", "2"]}], 
   RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}]], "Output",
 CellChangeTimes->{3.807977533723611*^9, 3.8079777185413914`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
     RowBox[{"2", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "3"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", "k"}], 
     RowBox[{"2", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "2"]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", 
      SuperscriptBox["k", "2"]}], 
     RowBox[{"4", " ", "\[Pi]", " ", "r"}]], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           SuperscriptBox["r", "2"]}]]}], "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", "k"}], 
         RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}], ")"}]}], "r"]}], "==", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox["r", "2"]}]], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8079772978934393`*^9, 3.807977341495515*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", "k"}], ")"}], " ", "r"}]}], ")"}]}], 
   "r"], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.8079773340244775`*^9, 3.807977342001637*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y"}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["3", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]], "-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "k"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"1", "/", "2"}]]], "-", 
     SuperscriptBox["k", "2"]}], ")"}]}], "-"}]], "Input",
 CellChangeTimes->{3.8079771696086025`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{"r", "\[Rule]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]}], " ", ",", "x"}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{"r", "\[Rule]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]}], " ", ",", "y"}], "]"}]}], "-", 
     RowBox[{
      SubscriptBox["\[Delta]", 
       RowBox[{"x", " ", "y"}]], 
      RowBox[{"Laplacian", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "\[Phi]", ",", "\[Theta]"}], "}"}], ",", 
        "\"\<Spherical\>\""}], "]"}]}]}], "&"}], "[", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
    RowBox[{" ", 
     RowBox[{"4", " ", "\[Pi]", " ", "r"}]}]], "]"}], "/.", 
  RowBox[{"r", "\[Rule]", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}]]}]}]], "Input",
 CellChangeTimes->{{3.8079778226270924`*^9, 3.807978053497179*^9}, {
  3.8079781328720155`*^9, 3.807978166232199*^9}, {3.807978214212369*^9, 
  3.807978219379396*^9}, {3.8079786899983826`*^9, 3.8079786920788145`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
       RowBox[{"4", " ", "\[Pi]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
       RowBox[{"4", " ", "\[Pi]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{"2", " ", "\[Pi]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
      RowBox[{"2", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", 
       SuperscriptBox["k", "2"]}], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]]}], ")"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]]}], ")"}], " ", 
   SubscriptBox["\[Delta]", 
    RowBox[{"x", " ", "y"}]]}]}]], "Output",
 CellChangeTimes->{
  3.8079779494523473`*^9, {3.80797798011229*^9, 3.807977987051283*^9}, 
   3.807978020566272*^9, 3.8079780545284195`*^9, 3.8079781526146283`*^9, 
   3.807978221071866*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"x", " ", "y", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]]}], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
        FractionBox["1", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], "-", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"x", " ", "y"}]], 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{"4", " ", "\[Pi]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["2", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]], "-", 
       FractionBox[
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[ImaginaryI]", " ", "k"}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]], "-", 
       SuperscriptBox["k", "2"], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k"}]}], ")"}]}]}], "==", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]]}], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]]}], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", 
         SuperscriptBox["k", "2"]}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], 
             RowBox[{"4", " ", "\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]]}], ")"}], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"x", " ", "y"}]]}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.807978173673295*^9, 3.807978207494195*^9}, {
  3.8079782495646467`*^9, 3.807978493554508*^9}, {3.807978549012364*^9, 
  3.8079786664997835`*^9}, {3.8079789604753265`*^9, 3.807978963646841*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "k", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x"}], " ", "y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]]}], "+", 
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"8", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"], "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]], "-", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["x", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}], ")"}]}]}], ")"}]}]}], ")"}], 
      " ", 
      SubscriptBox["\[Delta]", 
       RowBox[{"x", " ", "y"}]]}]}], ")"}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{3.807978671094581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]]}], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
       RowBox[{"4", " ", "\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]]}], "+", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
       RowBox[{"4", " ", "\[Pi]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], "==", 
   RowBox[{"x", " ", "y", " ", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"4", " ", "\[Pi]"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], "2"]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", "  ", "k"}], "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], 
         RowBox[{"1", "/", "2"}]]]}], " ", ")"}], "2"]}]}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.807978740907219*^9, 3.8079787474832573`*^9}, {
  3.8079787804955626`*^9, 3.8079788157360334`*^9}, {3.80797897127743*^9, 
  3.8079791242058516`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.807978748657132*^9, {3.807978806123041*^9, 3.8079788170884075`*^9}, 
   3.807978974772047*^9, {3.807979007545408*^9, 3.807979033014269*^9}, {
   3.807979110639911*^9, 3.8079791247693353`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{"2", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
     RowBox[{"2", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], " ", 
      SuperscriptBox["k", "2"]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]]}], ")"}]}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]]}], "==", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{"4", "\[Pi]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], 
    RowBox[{"(", 
     RowBox[{"-", " ", 
      SuperscriptBox["k", "2"]}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8079792049517727`*^9, 3.80797936564664*^9}, {
  3.807980353333067*^9, 3.8079803853365803`*^9}, {3.807980505100255*^9, 
  3.807980505489184*^9}, {3.8079807100096703`*^9, 3.807980717073773*^9}, {
  3.8079807732664557`*^9, 3.8079807967286863`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.8079792245670156`*^9, 3.8079792818494*^9, {3.807980344966443*^9, 
   3.807980386084508*^9}, 3.8079807198603163`*^9, {3.807980779601561*^9, 
   3.80798079726525*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", " ", "y", " ", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", " ", "\[Pi]"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", "  ", "k"}], "-", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"1", "/", "2"}]]]}], " ", ")"}], "2"]}], "-", 
    RowBox[{
     SubscriptBox["\[Delta]", 
      RowBox[{"x", " ", "y"}]], " ", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{"4", "\[Pi]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{"(", 
      RowBox[{"-", " ", 
       SuperscriptBox["k", "2"]}], ")"}]}]}], "==", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]]}], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]]}], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]]}]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
        RowBox[{"2", " ", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", 
         SuperscriptBox["k", "2"]}], 
        RowBox[{"4", " ", "\[Pi]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], 
             RowBox[{"4", " ", "\[Pi]", " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}]}]]}], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]]}], ")"}], " ", 
     SubscriptBox["\[Delta]", 
      RowBox[{"x", " ", "y"}]]}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8079807366873035`*^9, 3.8079807479212866`*^9}, {
  3.8079808054802732`*^9, 3.8079808409032993`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.807980830874341*^9, 3.807980841455821*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Use above simplification to write a more transparent expression\
\>", "Subsubsection",
 CellChangeTimes->{{3.807980863214613*^9, 3.8079808852766247`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["K\[Delta]", 
     RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], ":=", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{
      RowBox[{"SymbolName", "[", "\[Mu]", "]"}], ",", 
      RowBox[{"SymbolName", "[", "\[Nu]", "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"symbolic", " ", "Kronecker", " ", "delta"}], "*)"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"\[Alpha]_", ",", "\[Beta]_"}]], " ", ":=", " ", 
   RowBox[{
    RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", " ", "\[Pi]"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], "2"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", "  ", "k"}], "-", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], 
          RowBox[{"1", "/", "2"}]]]}], " ", ")"}], "2"]}], "+", 
    RowBox[{
     SubscriptBox["K\[Delta]", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}]], " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]]}], 
      RowBox[{"4", "\[Pi]", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GTensor", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    SubscriptBox["G", 
     RowBox[{"\[Alpha]", ",", "\[Beta]"}]], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Beta]", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8079808531914277`*^9, 3.8079808548909197`*^9}, {
   3.807981597115631*^9, 3.8079818410179696`*^9}, {3.8079819684776917`*^9, 
   3.807981995708845*^9}, 3.8079820389991946`*^9, {3.807982350854371*^9, 
   3.8079823715191116`*^9}, 3.8079824226164255`*^9}],

Cell["\<\
Compare to expression generated with definition for G at the top of this \
notebook. Yields that they are equal.\
\>", "Text",
 CellChangeTimes->{{3.807982487946071*^9, 3.8079825264430895`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["x", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
             FractionBox["1", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
         RowBox[{"16", " ", 
          SuperscriptBox["\[Pi]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}], ",", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]], ",", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "z", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "y", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["y", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
             FractionBox["1", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
         RowBox[{"16", " ", 
          SuperscriptBox["\[Pi]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}], ",", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "y", " ", "z", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "x", " ", "z", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]], ",", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]], " ", "y", " ", "z", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
            FractionBox["1", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
        RowBox[{"16", " ", 
         SuperscriptBox["\[Pi]", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]], ",", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["z", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "k"}], "-", 
             FractionBox["1", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]]}], ")"}], "2"]}], 
         RowBox[{"16", " ", 
          SuperscriptBox["\[Pi]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]]}]}], "}"}]}], "}"}], "==", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]], " ", 
           SuperscriptBox["x", "2"]}], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]}]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "k", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["y", "2"], "+", 
                  SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
             RowBox[{"4", " ", "\[Pi]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]}]]}], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], "2"]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "z"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "z"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]], " ", 
           SuperscriptBox["x", "2"]}], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]}]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "k", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["y", "2"], "+", 
                  SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
             RowBox[{"4", " ", "\[Pi]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]}]]}], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], "2"]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "z"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "z"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "x"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "x"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "z"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "z"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "y"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "y"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "z"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}], ")"}], 
              RowBox[{"3", "/", "2"}]]}]]}], "+", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "k", " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["x", "2"], "+", 
                SuperscriptBox["y", "2"], "+", 
                SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "z"}], 
           RowBox[{"4", " ", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "k", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}]]}]], " ", 
           SuperscriptBox["x", "2"]}], 
          RowBox[{"4", " ", "\[Pi]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], 
            RowBox[{"5", "/", "2"}]]}]]}], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"5", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["x", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["y", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["z", "2"]}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]]}]], "-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}]]}]], " ", "k"}], 
         RowBox[{"4", " ", "\[Pi]", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "k", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["x", "2"], "+", 
                  SuperscriptBox["y", "2"], "+", 
                  SuperscriptBox["z", "2"]}]]}]], " ", "z"}], 
             RowBox[{"4", " ", "\[Pi]", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}], ")"}], 
               RowBox[{"3", "/", "2"}]]}]]}], "+", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "k", " ", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["x", "2"], "+", 
                 SuperscriptBox["y", "2"], "+", 
                 SuperscriptBox["z", "2"]}]]}]], " ", "k", " ", "z"}], 
            RowBox[{"4", " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"], "+", 
               SuperscriptBox["z", "2"]}], ")"}]}]]}], ")"}], "2"]}]}], 
      "}"}]}], "}"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8079824497946873`*^9, 3.807982461379141*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8079824623296003`*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compare to expression with dot/cross products", "Section",
 CellChangeTimes->{{3.8086521312721167`*^9, 3.8086521460238056`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "k", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphrWave", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], 
     RowBox[{" ", 
      RowBox[{"4", " ", "\[Pi]", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]}]]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"spherical", " ", "wave"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["K\[Delta]", 
     RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], ":=", 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{
      RowBox[{"SymbolName", "[", "\[Mu]", "]"}], ",", 
      RowBox[{"SymbolName", "[", "\[Nu]", "]"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"symbolic", " ", "Kronecker", " ", "delta"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dipOp", "[", 
     RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"#", ",", "\[Alpha]"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{"#", ",", "\[Beta]"}], "]"}]}], "-", 
       RowBox[{
        SubscriptBox["K\[Delta]", 
         RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
        RowBox[{"Laplacian", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ")"}], 
     "&"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "derivative", " ", "op", " ", "in", " ", "the", " ", "expression", " ", 
    "for", " ", "positive", " ", 
    RowBox[{"freq", ".", " ", "component"}], " ", "of", " ", "Green", " ", 
    "tensor", " ", "element"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Gop", 
     RowBox[{"\[Alpha]_", ",", "\[Beta]_"}]], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"dipOp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "[", 
      RowBox[{"sphrWave", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}], "-", 
     RowBox[{
      SubscriptBox["K\[Delta]", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
      RowBox[{"DiracDelta", "[", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"element", " ", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]", ",", "\[Beta]"}], ")"}], " ", "of", " ", "dipole", 
    " ", "radiation", " ", "Green", " ", "function", " ", "tensor", " ", "in",
     " ", "free", " ", "space"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GTensor", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Gop", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["K\[Delta]", 
         RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
        RowBox[{"DiracDelta", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]], "]"}]}], "3"]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unit", "[", "v_", "]"}], ":=", 
   FractionBox["v", 
    SqrtBox[
     RowBox[{"v", ".", "v"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"\[Alpha]_", ",", "\[Beta]_"}]], " ", ":=", " ", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"4", " ", "\[Pi]"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}], "2"]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", "  ", "k"}], "-", 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"], "+", 
              SuperscriptBox["z", "2"]}], ")"}], 
            RowBox[{"1", "/", "2"}]]]}], " ", ")"}], "2"]}], "+", 
      RowBox[{
       SubscriptBox["K\[Delta]", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}]], " ", 
       FractionBox[
        RowBox[{
         SuperscriptBox["k", "2"], " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}]]}], 
        RowBox[{"4", "\[Pi]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]]}]}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8085638362325325`*^9, 3.808563840279008*^9}, {
   3.8085638876132107`*^9, 3.8085638895629067`*^9}, {3.808564701803763*^9, 
   3.8085647309277725`*^9}, 3.8086521789955883`*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "Test: does ",
 Cell[BoxData[
  FormBox[
   RowBox[{"GdotP", "[", 
    RowBox[{"r", ",", 
     SubscriptBox["e", "i"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"GTensor", "(", "r", ")"}], ".", 
    SubscriptBox["e", "i"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "? Assumes \[Alpha],\[Beta] \[Element] {x,y,z}, the components of the atom \
separation vector. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "i"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is a unit dipole."
}], "Subsubsection",
 CellChangeTimes->{{3.8086525442435846`*^9, 3.808652650426789*^9}, {
  3.8086527231094885`*^9, 3.8086527289947577`*^9}, {3.8086535502892284`*^9, 
  3.808653561379611*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GdotP", "[", 
    RowBox[{"r_", ",", "p_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{"r", ".", "r"}]]}]], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SqrtBox[
       RowBox[{"r", ".", "r"}]]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}], ",", 
        RowBox[{"unit", "[", "r", "]"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           SuperscriptBox["k", "2"], 
           RowBox[{"r", ".", "r"}]}]], "-", 
         FractionBox["\[ImaginaryI]", 
          RowBox[{"k", " ", 
           SqrtBox[
            RowBox[{"r", ".", "r"}]]}]]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", 
          RowBox[{"unit", "[", "r", "]"}], " ", 
          RowBox[{"Dot", "[", 
           RowBox[{
            RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}]}], "-", "p"}], 
        ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8085635012082815`*^9, 3.8085635094710426`*^9}, {
  3.8086531740678988`*^9, 3.808653174547615*^9}}],

Cell["\<\
start with simple p vector, and analyze only the x component of the resultant \
vector\
\>", "Text",
 CellChangeTimes->{{3.808652845379002*^9, 3.808652865079373*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gdpx", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"GdotP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.808563512464431*^9, 3.8085635528157883`*^9}, {
   3.808564294667431*^9, 3.8085642974212847`*^9}, {3.808652734639669*^9, 
   3.8086527373195066`*^9}, {3.808652831148073*^9, 3.808652832432643*^9}, {
   3.808653006082153*^9, 3.808653017922502*^9}, 3.808653127934251*^9, {
   3.808653246340727*^9, 3.8086532665907087`*^9}, {3.80865354079158*^9, 
   3.808653541211492*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"4", " ", 
    SuperscriptBox["k", "2"], " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], "3"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.808653571759797*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gtpx", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"GTensor", ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.80865291420232*^9, 3.808652981228621*^9}, {
   3.8086530324207573`*^9, 3.808653054702979*^9}, 3.808653653821422*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["k", "2"], " ", "\[Pi]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}], ")"}], 
         RowBox[{"5", "/", "2"}]]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}]], " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]]}], "+", 
          RowBox[{
           SuperscriptBox["k", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}],
    "/", 
   RowBox[{"(", 
    RowBox[{"16", " ", 
     SuperscriptBox["\[Pi]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], "3"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", 
   RowBox[{"DiracDelta", "[", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}]], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.8086529185746317`*^9, 3.808652981833994*^9}, {
   3.8086530373615427`*^9, 3.8086530558798037`*^9}, 3.8086535837856517`*^9, 
   3.8086536544208093`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"4", " ", 
    SuperscriptBox["k", "2"], " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}], "3"]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8086537059131975`*^9, 3.808653756951758*^9}}],

Cell[BoxData[
 RowBox[{"gdpx", "\[Equal]", "gtpx"}]], "Input",
 CellChangeTimes->{{3.8086537845769167`*^9, 3.808653814350993*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      SuperscriptBox["k", "2"], " ", "\[Pi]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]]}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]}], ")"}]}], "\[Equal]", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"16", " ", 
      SuperscriptBox["\[Pi]", "2"], " "}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", "\[Pi]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}], ")"}], 
        RowBox[{"5", "/", "2"}]]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["z", "2"]}]]}]], " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]}], ")"}]}]}], ")"}], "x"}]}]}]
  ], "Input",
 CellChangeTimes->{{3.808653838303968*^9, 3.8086539367753763`*^9}, 
   3.8086561978055906`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "k", "]"}]], "Input",
 CellChangeTimes->{{3.8086569956073256`*^9, 3.808656998872604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Laplacian", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], 
     RowBox[{"4", " ", "\[Pi]", " ", "r"}]], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
    "\"\<Spherical\>\""}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8086569547518616`*^9, 3.8086570053233824`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", "r"}]], " ", 
    SuperscriptBox["k", "2"]}], 
   RowBox[{"4", " ", "\[Pi]", " ", "r"}]]}]], "Output",
 CellChangeTimes->{{3.808656988356702*^9, 3.8086570056944027`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Just use G.p in cross-product form. ", "Section",
 CellChangeTimes->{{3.808659105097801*^9, 3.808659123595353*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["r", 
    RowBox[{"i_", ",", "j_"}]], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", "n"}], "]"}], "-", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "n"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "/", "n"}], "]"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "/", "n"}], "]"}]}]}], "}"}], "/.", 
    RowBox[{"n", "\[Rule]", 
     SqrtBox["atomnum"]}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"vector", " ", "between", " ", "atoms", " ", "i"}], ",", 
    RowBox[{"j", " ", "in", " ", "units", " ", "lattice", " ", "spacing"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"unit", "[", "v_", "]"}], ":=", 
   FractionBox["v", 
    SqrtBox[
     RowBox[{"v", ".", "v"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GdotP", "[", 
   RowBox[{"r_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "k", " ", 
      SqrtBox[
       RowBox[{"r", ".", "r"}]]}]], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SqrtBox[
      RowBox[{"r", ".", "r"}]]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}], ",", 
       RowBox[{"unit", "[", "r", "]"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["k", "2"], 
          RowBox[{"r", ".", "r"}]}]], "-", 
        FractionBox["\[ImaginaryI]", 
         RowBox[{"k", " ", 
          SqrtBox[
           RowBox[{"r", ".", "r"}]]}]]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"unit", "[", "r", "]"}], " ", 
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}]}], "-", "p"}], 
       ")"}]}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.808659421329177*^9, 3.8086594226246996`*^9}}],

Cell[TextData[{
 "Following the Ritsch paper, the decay terms are proportional to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "i"], 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{"G", "[", 
       RowBox[{
        SubscriptBox["r", "i"], " ", "-", " ", 
        SubscriptBox["r", "j"]}], "]"}], "]"}], ".", 
     SubscriptBox["P", "j"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " which is the term giving me problems."
}], "Text",
 CellChangeTimes->{{3.8086591578005543`*^9, 3.8086591759141607`*^9}, {
  3.808659207255371*^9, 3.8086593151639643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "k", "]"}], 
  RowBox[{"(*", 
   RowBox[{"limit", " ", "evaluates", " ", "incorrectly", " ", 
    RowBox[{"(", 
     RowBox[{"to", " ", "\[Infinity]"}], ")"}], " ", "if", " ", 
    RowBox[{"defined", "!"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "1"}], ";", " ", 
  RowBox[{"j", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gij", " ", "=", 
   RowBox[{"GdotP", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "ry", ",", "0"}], "}"}], ",", "p"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", ".", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Im", "[", "Gij", "]"}], "]"}], ",", 
    RowBox[{"ry", "\[Rule]", " ", "0"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.808659318284587*^9, 3.8086593854730434`*^9}, {
  3.808659517148038*^9, 3.8086596085587006`*^9}, {3.808659642466114*^9, 
  3.808659701400551*^9}, {3.808659802396549*^9, 3.8086598789379964`*^9}, {
  3.8086599133996363`*^9, 3.80865991607996*^9}, {3.808661569806649*^9, 
  3.8086615810974708`*^9}, {3.808661651821432*^9, 3.8086616740769453`*^9}, {
  3.8086620492259865`*^9, 3.808662072764123*^9}, {3.808662247014866*^9, 
  3.8086622930750504`*^9}, {3.808680832307824*^9, 3.808680834920842*^9}, {
  3.8086808651571803`*^9, 3.80868086911056*^9}, {3.808681190791971*^9, 
  3.8086813063851013`*^9}, {3.8086813744707947`*^9, 3.8086813981315517`*^9}}],

Cell[BoxData[
 FractionBox["k", 
  RowBox[{"6", " ", "\[Pi]"}]]], "Output",
 CellChangeTimes->{{3.808681186012744*^9, 3.808681306815974*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{766, 812},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 135, 1, 156, "Chapter"],
Cell[CellGroupData[{
Cell[740, 27, 131, 1, 137, "Section"],
Cell[874, 30, 2560, 73, 234, "Input"],
Cell[CellGroupData[{
Cell[3459, 107, 183, 4, 49, "Subsubsection"],
Cell[CellGroupData[{
Cell[3667, 115, 600, 18, 96, "Input"],
Cell[4270, 135, 1138, 35, 82, "Output"]
}, Open  ]],
Cell[5423, 173, 330, 10, 68, "Input"],
Cell[5756, 185, 1222, 36, 90, "Input"],
Cell[CellGroupData[{
Cell[7003, 225, 2151, 64, 96, "Input"],
Cell[9157, 291, 129, 2, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9323, 298, 952, 29, 96, "Input"],
Cell[10278, 329, 2236, 70, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12551, 404, 3612, 108, 144, "Input"],
Cell[16166, 514, 75, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16278, 520, 497, 12, 67, "Input"],
Cell[16778, 534, 286, 8, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17101, 547, 582, 17, 68, "Input"],
Cell[17686, 566, 308, 8, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18031, 579, 1678, 46, 84, "Input"],
Cell[19712, 627, 419, 12, 59, "Output"]
}, Open  ]],
Cell[20146, 642, 1204, 38, 90, "Input"],
Cell[CellGroupData[{
Cell[21375, 684, 1555, 45, 67, "Input"],
Cell[22933, 731, 5774, 167, 219, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28744, 903, 8222, 231, 342, "Input"],
Cell[36969, 1136, 3045, 90, 124, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40051, 1231, 3737, 108, 128, "Input"],
Cell[43791, 1341, 248, 4, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44076, 1350, 3828, 111, 121, "Input"],
Cell[47907, 1463, 221, 4, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48165, 1472, 7764, 219, 342, "Input"],
Cell[55932, 1693, 97, 1, 37, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[56078, 1700, 164, 3, 40, "Subsubsection"],
Cell[56245, 1705, 2937, 84, 159, "Input"],
Cell[59185, 1791, 204, 4, 38, "Text"],
Cell[CellGroupData[{
Cell[59414, 1799, 54554, 1439, 1514, "Input"],
Cell[113971, 3240, 75, 1, 37, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[114107, 3248, 134, 1, 119, "Section"],
Cell[114244, 3251, 6153, 181, 673, "Input"],
Cell[CellGroupData[{
Cell[120422, 3436, 789, 25, 85, "Subsubsection"],
Cell[121214, 3463, 1344, 42, 174, "Input"],
Cell[122561, 3507, 176, 4, 38, "Text"],
Cell[CellGroupData[{
Cell[122762, 3515, 732, 16, 37, "Input"],
Cell[123497, 3533, 1890, 59, 124, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125424, 3597, 402, 10, 37, "Input"],
Cell[125829, 3609, 2293, 68, 172, "Output"]
}, Open  ]],
Cell[128137, 3680, 1915, 59, 185, "Input"],
Cell[130055, 3741, 130, 2, 37, "Input"],
Cell[130188, 3745, 2873, 88, 295, InheritFromParent],
Cell[133064, 3835, 126, 2, 37, "Input"],
Cell[CellGroupData[{
Cell[133215, 3841, 448, 11, 67, "Input"],
Cell[133666, 3854, 310, 8, 60, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134037, 3869, 121, 1, 86, "Section"],
Cell[134161, 3872, 2332, 75, 398, "Input"],
Cell[136496, 3949, 593, 17, 66, "Text"],
Cell[CellGroupData[{
Cell[137114, 3970, 1614, 36, 134, "Input"],
Cell[138731, 4008, 141, 3, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

