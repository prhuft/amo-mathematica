(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33834,        947]
NotebookOptionsPosition[     31840,        873]
NotebookOutlinePosition[     32204,        889]
CellTagsIndexPosition[     32161,        886]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Subradiance-protected excitation spreading for collimated photon emission\
\>", "Chapter",
 CellChangeTimes->{{3.804795257142758*^9, 3.8047952870781355`*^9}}],

Cell["See paper by K. Ballantine, J. Ruostekoski", "Text",
 CellChangeTimes->{{3.8047952896493063`*^9, 3.804795315348673*^9}}],

Cell[CellGroupData[{

Cell["personal notes", "Section",
 CellChangeTimes->{{3.805668161042568*^9, 3.8056681662163057`*^9}}],

Cell[CellGroupData[{

Cell["Questions", "Subsection",
 CellChangeTimes->{{3.805668173776622*^9, 3.8056681752571135`*^9}}],

Cell[TextData[{
 "Why can a system which is excited with a single photon be adequately \
described by classical E&M?\n\nThe collective mode which is predominantly \
coupled by the initial excitation (after rotating the polarization to be \
normal to the atom grid plane) decays slowly, i.e. is subradiant, while other \
modes decay superradiantly. Why do these other modes see an a higher rate of \
decay than independent decay? Does it just \[OpenCurlyDoubleQuote]come out of \
the math\[CloseCurlyDoubleQuote] as with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["N"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " enhancement of ensemble Rabi flopping?"
}], "Text",
 CellChangeTimes->{{3.805668178473505*^9, 3.8056683966718793`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["setup", "Section",
 CellChangeTimes->{
  3.804795272338377*^9, {3.8047953612651463`*^9, 3.8047953705323234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"PHYSICAL", " ", "CONSTANTS"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[HBar]", " ", "=", " ", 
     RowBox[{"6.62607015*^-34", "/", 
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]0", " ", "=", 
     RowBox[{"4", "\[Pi]", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", " ", "=", " ", "299792458"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]0", " ", "=", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "\[Mu]0"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ee", " ", "=", " ", "1.602*^-19"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"electron", " ", "charge"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"a0", " ", "=", " ", "5.27*^-11"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Bohr", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"PARAMETERS", " ", "and", " ", "other", " ", "DEFINITIONS"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"atomnum", " ", "=", " ", "16"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "upper", " ", "level", " ", "total", " ", "angular", " ", "momentum"}], 
     "*)"}], " ", "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]", " ", "=", " ", 
     RowBox[{"7.8", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", " ", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"matelem", " ", "=", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "reduced", " ", "matrix", " ", "element", 
        "\[IndentingNewLine]", "\[Gamma]"}], " ", "=", " ", 
       RowBox[{
        SuperscriptBox["matelem", "2"], 
        RowBox[{
         SuperscriptBox["k", "3"], "/", 
         RowBox[{"(", 
          RowBox[{"6", " ", "\[Pi]", " ", "\[HBar]", " ", "\[Epsilon]0"}], 
          ")"}]}]}]}]}], ";"}], "*)"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"single", " ", "two"}], "-", 
     RowBox[{"level", " ", "atom", " ", "linewidth"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"0.7", " ", "\[Lambda]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"atomic", " ", "grid", " ", "spatial", " ", "period"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"pol", " ", "=", " ", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"pol", "[", 
        RowBox[{"[", "\[Mu]", "]"}], "]"}], "/.", 
       RowBox[{"u", "->", "1"}]}], ",", "2", ",", 
      RowBox[{
       RowBox[{"3", " ", "for", " ", "polarization", " ", "\[Sigma]"}], "=", 
       RowBox[{"-", "1"}]}], ",", "0", ",", 
      RowBox[{"+", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"deg", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", "J"}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", " ", "=", " ", 
     RowBox[{"deg", "*", "atomnum"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Hamiltonian", " ", "shape", " ", "is", " ", "dim", " ", "x", " ", 
      "dim"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Hfull", " ", "=", " ", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["H", "##"], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "FUNCTIONS", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["r", 
      RowBox[{"i_", ",", "j_"}]], "=", 
     RowBox[{
      RowBox[{"a", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"j", "-", "1"}], ",", "n"}], "]"}], "-", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"i", "-", "1"}], ",", "n"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "/", "n"}], "]"}], "-", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "/", "n"}], "]"}]}]}], "}"}]}], "/.", 
      RowBox[{"n", "\[Rule]", "atomnum"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"distance", " ", "between", " ", "atoms", " ", "i"}], ",", 
      "j"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sphrWave", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "k", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]], 
      RowBox[{" ", 
       RowBox[{"4", " ", "\[Pi]", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}]}]]}], ";", 
    RowBox[{"(*", 
     RowBox[{"spherical", " ", "wave"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["K\[Delta]", 
      RowBox[{"\[Mu]_", ",", "\[Nu]_"}]], ":=", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{
       RowBox[{"SymbolName", "[", "\[Mu]", "]"}], ",", 
       RowBox[{"SymbolName", "[", "\[Nu]", "]"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"symbolic", " ", "Kronecker", " ", "delta"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dipOp", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"#", ",", "\[Alpha]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{"#", ",", "\[Beta]"}], "]"}]}], "-", 
        RowBox[{
         SubscriptBox["K\[Delta]", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
         RowBox[{"Laplacian", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "-", 
        RowBox[{
         SubscriptBox["K\[Delta]", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
         RowBox[{"DiracDelta", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}]], "]"}]}]}], ")"}], "&"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "derivative", " ", "op", " ", "in", " ", "the", " ", "expression", " ", 
      "for", " ", "positive", " ", 
      RowBox[{"freq", ".", " ", "component"}], " ", "of", " ", 
      "monochromatic", " ", "dipole", " ", "radation"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["G", 
      RowBox[{"\[Alpha]_", ",", "\[Beta]_"}]], ":=", 
     RowBox[{
      RowBox[{"dipOp", "[", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], "[", 
      RowBox[{"sphrWave", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"element", " ", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", ",", "\[Beta]"}], ")"}], " ", "of", " ", "the", 
      " ", "positive", " ", "frequency", " ", "compenent", " ", "of", " ", 
      "monochromatic", " ", 
      RowBox[{"dip", ".", " ", "radiation"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"GTensor", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["G", 
         RowBox[{"\[Alpha]", ",", "\[Beta]"}]], "+", 
        FractionBox[
         RowBox[{
          SubscriptBox["K\[Delta]", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}]], 
          RowBox[{"DiracDelta", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"], "+", 
             SuperscriptBox["z", "2"]}]], "]"}]}], "3"]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Beta]", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["e", "\[Mu]_"], " ", ":=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", "1"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{
            RowBox[{"+", "\[ImaginaryI]"}], " ", "1"}]}], "}"}]}]}], "}"}], 
      "[", 
      RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"polarization", " ", 
        RowBox[{"basis", ".", " ", "\[Mu]"}]}], "=", "1"}], ",", "2", ",", 
      RowBox[{
       RowBox[{"3", " ", "\[Rule]", " ", 
        RowBox[{"polarization", " ", "\[Sigma]"}]}], "=", 
       RowBox[{"-", "1"}]}], ",", "0", ",", 
      RowBox[{"+", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"GTensorSph", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["e", "n"], "\[Conjugate]"}], ".", "GTensor", ".", 
        SubscriptBox["e", "m"]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Range", "[", "3", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", 
         RowBox[{"Range", "[", "3", "]"}]}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"GTensor", " ", "in", " ", "spherical", " ", "basis"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["dipRadKernel", 
      RowBox[{"\[Mu]_", ",", "\[Nu]_", ",", "i_", ",", "j_"}]], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GTensorSph", "[", 
          RowBox[{"[", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[Rule]", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"y", "\[Rule]", 
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"z", "\[Rule]", " ", "0"}]}], "}"}]}], "/.", 
        RowBox[{"u", "\[Rule]", " ", 
         SubscriptBox["r", 
          RowBox[{"i", ",", "j"}]]}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "\[Rule]", " ", 
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"y", "\[Rule]", 
          RowBox[{"u", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"z", "\[Rule]", " ", "0"}]}], "}"}]}], "/.", 
      RowBox[{"u", "\[Rule]", " ", 
       SubscriptBox["r", 
        RowBox[{"i", ",", "j"}]], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"element", " ", 
          RowBox[{"(", 
           RowBox[{"\[Mu]", ",", "\[Nu]"}], ")"}], " ", "of", " ", "the", " ",
           "dipole", " ", "radiation", " ", "kernel", " ", "between", " ", 
          "atoms", " ", "i"}], ",", "j"}], "*)"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.804795372139743*^9, 3.8047954565762587`*^9}, {
   3.804795557477767*^9, 3.804795646192586*^9}, {3.805670829592176*^9, 
   3.8056708978355913`*^9}, {3.8059959856055202`*^9, 3.805995986254162*^9}, {
   3.8059985871648145`*^9, 3.8059986288484855`*^9}, {3.8059997358360014`*^9, 
   3.805999788758046*^9}, {3.8059999118297677`*^9, 3.8059999521643977`*^9}, {
   3.805999992044653*^9, 3.8060000636137767`*^9}, {3.8060001456463013`*^9, 
   3.8060001964015045`*^9}, {3.8060002660690813`*^9, 3.8060002884442167`*^9}, 
   3.806000626716222*^9, 3.806001860902274*^9, 3.8060020439721518`*^9, {
   3.8060026207721825`*^9, 3.80600266366413*^9}, {3.8060026966204414`*^9, 
   3.8060027062593665`*^9}, {3.8060060864367876`*^9, 3.806006284666767*^9}, {
   3.80600633970216*^9, 3.806006436560063*^9}, {3.8060064977258167`*^9, 
   3.8060065810076523`*^9}}],

Cell["TESTING FUNCTIONS, etc", "Text",
 CellChangeTimes->{{3.806001605401622*^9, 3.806001612671781*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["dipRadKernel", 
  RowBox[{"1", ",", "1", ",", "1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.806000532315787*^9, 3.8060005403542857`*^9}, {
  3.8060005987290707`*^9, 3.806000599371353*^9}}],

Cell[BoxData[
 RowBox[{"7.129432685493096`*^23", "-", 
  RowBox[{"1.3062117123689631`*^23", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.806000541183034*^9, 3.8060005998989396`*^9, {3.8060024733699284`*^9, 
   3.8060025002242136`*^9}, 3.8060025407960587`*^9, 3.8060027115675783`*^9, 
   3.806002762668642*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["testkernel", 
  RowBox[{"1", ",", "1", ",", "1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.8060025530955114`*^9, 3.8060025613334217`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"u\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,221,65,30676774639940345479,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.806002588572372*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{\\\"u\\\", \\\"\[LeftDoubleBracket]\
\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,221,66,30676774639940345479,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.806002588606288*^9}],

Cell[BoxData[
 RowBox[{"7.129432685493096`*^23", "-", 
  RowBox[{"1.3062117123689631`*^23", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.806002588609274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Piecewise", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"1", "\[NotEqual]", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"1", "\[Equal]", "1"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8060054460930595`*^9, 3.806005511437373*^9}, {
  3.806005549278163*^9, 3.806005579913167*^9}, {3.806005644899294*^9, 
  3.8060057179019785`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.806005710026045*^9, 3.8060057183289084`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pw", "[", 
  RowBox[{"1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.806005569118046*^9, 3.8060055842685237`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8060055713860044`*^9, 3.806005584729277*^9}}]
}, Open  ]],

Cell[TextData[{
 "Hamiltonian matrix elements: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "j"}], "-", "1", "+", "\[Nu]"}], ",", 
      RowBox[{
       RowBox[{"3", "k"}], "-", "1", "+", "\[Nu]"}]}]], "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["H", "\[Nu]\[Mu]"], 
      RowBox[{"(", "jk", ")"}]], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "\[Mu]"], 
       SubscriptBox["\[Delta]", "jk"], 
       SubscriptBox["\[Delta]", "\[Mu]\[Nu]"]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[CapitalOmega]", "\[Mu]\[Nu]"], 
        RowBox[{"(", "jk", ")"}]], "(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Delta]", "jk"]}], ")"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox[
        SubscriptBox["\[Gamma]", "\[Mu]\[Nu]"], 
        RowBox[{"(", "jk", ")"}]]}]}]}]}], TraditionalForm]]],
 ", where \[Mu],\[Nu] specify polarization projections and j,k are the atom \
indices in the 2D grid.  "
}], "Text",
 CellChangeTimes->{{3.804795955202659*^9, 3.804796203497088*^9}, {
  3.8051540631375103`*^9, 3.8051541172328863`*^9}, {3.8060047095110035`*^9, 
  3.8060047102689743`*^9}}],

Cell["\<\
TODO: 
- find what values the paper used for \[CapitalDelta],\[Gamma], then build \
those into the Hamiltonian. 
- add in initial excitation as the paper does \
\>", "Text",
 CellChangeTimes->{{3.804797675818221*^9, 3.804797723814588*^9}, {
  3.8060077992621117`*^9, 3.8060078474172754`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["run", "Section",
 CellChangeTimes->{{3.8060017187482805`*^9, 3.806001720111932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"fill", " ", "the", " ", "Hamiltonian"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", 
     RowBox[{
      RowBox[{"Length", "[", "atomnum", "]"}], "+", "1"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "<", 
       RowBox[{
        RowBox[{"Length", "[", "atomnum", "]"}], "+", "1"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"\[Nu]", "=", "1"}], ",", 
        RowBox[{"\[Nu]", "<", 
         RowBox[{
          RowBox[{"Length", "[", "pol", "]"}], "+", "1"}]}], ",", 
        RowBox[{"\[Nu]", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"\[Mu]", "=", "1"}], ",", 
          RowBox[{"\[Mu]", "<", 
           RowBox[{
            RowBox[{"Length", "[", "pol", "]"}], "+", "1"}]}], ",", 
          RowBox[{"\[Mu]", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"G", " ", "=", " ", 
            RowBox[{
             FractionBox[
              RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], 
              SuperscriptBox["k", "3"]], " ", 
             SubscriptBox["dipRadKernel", 
              RowBox[{"\[Mu]", ",", "\[Nu]", ",", "i", ",", "j"}]]}]}], ";", 
           " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "this", " ", "currently", " ", "has", " ", "a", " ", "Kronecker",
               " ", "delta"}], ",", " ", 
             RowBox[{
             "and", " ", "so", " ", "evaluates", " ", "to", " ", "an", " ", 
              "indeterminate", " ", 
              RowBox[{"expression", ".", " ", "may"}], " ", "give", " ", 
              "problems", " ", "to", " ", "the", " ", "numerical", " ", 
              RowBox[{"solver", ".", " ", "may"}], " ", "need", " ", "a", " ",
               "piecewise", " ", "expression", " ", "here"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", "=", 
            RowBox[{"Re", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Gamma]\[Mu]\[Nu]ij", " ", "=", 
            RowBox[{"Im", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Hfull", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"3", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "+", "\[Nu]"}], ",", 
               RowBox[{
                RowBox[{"3", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "+", "\[Mu]"}]}], "]"}], 
             "]"}], "=", " ", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "\[Mu]"], 
              RowBox[{"KroneckerDelta", "[", 
               RowBox[{"i", ",", "j"}], "]"}], 
              RowBox[{"KroneckerDelta", "[", 
               RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
             RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Gamma]\[Mu]\[Nu]ij"}]}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8047957075769863`*^9, 3.8047957160186987`*^9}, {
   3.804795751749652*^9, 3.8047957753372602`*^9}, {3.8047958647839427`*^9, 
   3.8047958810052404`*^9}, {3.804796317244423*^9, 3.804796317757765*^9}, {
   3.8047963499082375`*^9, 3.804796350997925*^9}, {3.8047963851916113`*^9, 
   3.8047965802424455`*^9}, {3.804796906204793*^9, 3.8047969231715045`*^9}, {
   3.8047970996371055`*^9, 3.804797130431709*^9}, {3.804797164314621*^9, 
   3.804797189088416*^9}, {3.804797225107823*^9, 3.804797240025271*^9}, {
   3.804797313699103*^9, 3.8047973177373066`*^9}, {3.8047973613239803`*^9, 
   3.804797370009427*^9}, {3.804797408918919*^9, 3.8047975583843765`*^9}, {
   3.806001650976497*^9, 3.8060016589526815`*^9}, {3.8060017314517384`*^9, 
   3.8060017767336435`*^9}, {3.806004878030676*^9, 3.806004924573162*^9}, {
   3.8060049714755926`*^9, 3.806005054720866*^9}, {3.806005159955346*^9, 
   3.8060052104992*^9}, {3.8060055903173656`*^9, 3.806005634391409*^9}, 
   3.8060056645098248`*^9, {3.8060057252014904`*^9, 3.8060057621566105`*^9}, {
   3.806005903864731*^9, 3.8060060711801853`*^9}, {3.806006464504057*^9, 
   3.8060064745453615`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["random tests", "Section",
 CellChangeTimes->{{3.806006805270024*^9, 3.8060068112340417`*^9}}],

Cell["\<\
Check my grid mapping. 2D grid, but only one index to specify atoms\
\>", "Text",
 CellChangeTimes->{{3.8055812128834515`*^9, 3.805581234435918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "num"}], "]"}], ",", " ", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}], "}"}]}],
          ",", 
         RowBox[{"a", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"j", "-", "1"}], ",", "num"}], "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "/", "num"}], "]"}]}], 
           "}"}]}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"a", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "num"}], "]"}], ",", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}], 
            "}"}]}], ",", "0.05"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Range", "[", 
        SuperscriptBox["num", "2"], "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"1", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10", ",", "15", ",", "20", ",", "25"}], "}"}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.805581333965639*^9, 3.8055814341893806`*^9}, {
  3.805581552511201*^9, 3.8055815960303836`*^9}, {3.805581629511797*^9, 
  3.8055816883682003`*^9}, {3.8055817251288686`*^9, 3.8055817262478523`*^9}, {
  3.805581886212476*^9, 3.8055818997023997`*^9}, {3.805581939032192*^9, 
  3.8055820448102236`*^9}, {3.8056697625052896`*^9, 3.8056698196551075`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 0, 1], CircleBox[{0., 0.}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0.7, 0.}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1.4, 0.}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.0999999999999996, 0.}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.8, 0.}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0., 0.7}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0.7, 0.7}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1.4, 0.7}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.0999999999999996, 0.7}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.8, 0.7}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0., 1.4}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0.7, 1.4}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1.4, 1.4}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.0999999999999996, 1.4}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.8, 1.4}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0., 2.0999999999999996}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0.7, 2.0999999999999996}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1.4, 2.0999999999999996}, 0.05]}, 
   {RGBColor[0, 0, 1], 
    CircleBox[{2.0999999999999996, 2.0999999999999996}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.8, 2.0999999999999996}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0., 2.8}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0.7, 2.8}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1.4, 2.8}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.0999999999999996, 2.8}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2.8, 2.8}, 0.05]}, 
   {RGBColor[1, 0, 0], LineBox[{{0., 0.}, {2.8, 0.}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0., 0.}, {2.8, 0.7}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0., 0.}, {2.8, 1.4}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0., 0.}, {2.8, 2.0999999999999996`}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0., 0.}, {2.8, 2.8}}]}},
  Axes->True]], "Output",
 CellChangeTimes->{{3.805581655114204*^9, 3.8055816888449235`*^9}, 
   3.8055819020959787`*^9, {3.805581941482599*^9, 3.805581976920786*^9}, {
   3.805582038182976*^9, 3.8055820450695515`*^9}, 3.805669582249579*^9, {
   3.805669805938079*^9, 3.805669820223586*^9}, 3.8059998840810094`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", 
   RowBox[{"a", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", "num"}], "]"}], "-", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "num"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "/", "num"}], "]"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.805669561032357*^9, 3.8056695676486287`*^9}, {
   3.8056696494029245`*^9, 3.8056696723884273`*^9}, {3.805669718583824*^9, 
   3.8056697393781595`*^9}, 3.805669838869701*^9, 3.8059999759267817`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r", "[", 
  RowBox[{"1", ",", "15"}], "]"}]], "Input",
 CellChangeTimes->{{3.805669571669897*^9, 3.8056695769896364`*^9}, {
  3.8059982614260635`*^9, 3.8059982692525363`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.8`", ",", "1.4`"}], "}"}]], "Output",
 CellChangeTimes->{{3.805669577685768*^9, 3.8056695866737537`*^9}, 
   3.8056696741087875`*^9, 3.805669740869199*^9, 3.8056698433556967`*^9, {
   3.8059998784341445`*^9, 3.80599988876947*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Upsilon]", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.805671166689271*^9, 3.805671284039829*^9}, {
  3.805671390830882*^9, 3.8056714278278937`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8056712255064325`*^9, 3.8056712290519495`*^9}, 
   3.805671265495475*^9, {3.805671398099431*^9, 3.805671434158975*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "1"}], "}"}], ".", "\[Upsilon]"}]], "Input",
 CellChangeTimes->{{3.805671415371196*^9, 3.8056714573818245`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.805671436502689*^9, 3.805671442415837*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 821},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification->1.25,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 168, 3, 91, "Chapter"],
Cell[751, 27, 126, 1, 38, "Text"],
Cell[CellGroupData[{
Cell[902, 32, 101, 1, 86, "Section"],
Cell[CellGroupData[{
Cell[1028, 37, 99, 1, 59, "Subsection"],
Cell[1130, 40, 745, 14, 144, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1924, 60, 119, 2, 86, "Section"],
Cell[2046, 64, 12653, 340, 972, "Input"],
Cell[14702, 406, 104, 1, 38, "Text"],
Cell[CellGroupData[{
Cell[14831, 411, 221, 4, 40, "Input"],
Cell[15055, 417, 325, 6, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15417, 428, 170, 3, 39, "Input"],
Cell[15590, 433, 337, 7, 29, "Message"],
Cell[15930, 442, 337, 7, 29, "Message"],
Cell[16270, 451, 170, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16477, 459, 450, 12, 37, "Input"],
Cell[16930, 473, 96, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17063, 479, 146, 3, 37, "Input"],
Cell[17212, 484, 96, 1, 37, "Output"]
}, Open  ]],
Cell[17323, 488, 1239, 35, 44, "Text"],
Cell[18565, 525, 302, 7, 88, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18904, 537, 90, 1, 86, "Section"],
Cell[18997, 540, 4807, 103, 459, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23841, 648, 99, 1, 86, "Section"],
Cell[23943, 651, 159, 3, 38, "Text"],
Cell[CellGroupData[{
Cell[24127, 658, 2658, 76, 142, "Input"],
Cell[26788, 736, 2144, 37, 466, "Output"]
}, Open  ]],
Cell[28947, 776, 926, 27, 37, "Input"],
Cell[CellGroupData[{
Cell[29898, 807, 199, 4, 37, "Input"],
Cell[30100, 813, 272, 5, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30409, 823, 614, 19, 41, "Input"],
Cell[31026, 844, 402, 10, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31465, 859, 183, 4, 37, "Input"],
Cell[31651, 865, 149, 3, 37, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

