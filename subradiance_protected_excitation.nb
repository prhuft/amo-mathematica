(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    195668,       5126]
NotebookOptionsPosition[    184165,       4747]
NotebookOutlinePosition[    184526,       4763]
CellTagsIndexPosition[    184483,       4760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Subradiance-protected excitation spreading for collimated photon emission\
\>", "Chapter",
 CellChangeTimes->{{3.804795257142758*^9, 3.8047952870781355`*^9}}],

Cell["\<\
P. Huft
See paper by K. Ballantine, J. Ruostekoski\
\>", "Text",
 CellChangeTimes->{{3.8047952896493063`*^9, 3.804795315348673*^9}, {
  3.8069647340862026`*^9, 3.80696474134041*^9}}],

Cell[CellGroupData[{

Cell["personal notes", "Section",
 CellChangeTimes->{{3.805668161042568*^9, 3.8056681662163057`*^9}}],

Cell[CellGroupData[{

Cell["Questions", "Subsection",
 CellChangeTimes->{{3.805668173776622*^9, 3.8056681752571135`*^9}}],

Cell[TextData[{
 "Why can a system which is excited with a single photon be adequately \
described by classical E&M?\n\nThe collective mode which is predominantly \
coupled by the initial excitation (after rotating the polarization to be \
normal to the atom grid plane) decays slowly, i.e. is subradiant, while other \
modes decay superradiantly. Why do these other modes see an a higher rate of \
decay than independent decay? Does it just \[OpenCurlyDoubleQuote]come out of \
the math\[CloseCurlyDoubleQuote] as with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["N"], TraditionalForm]]],
 " enhancement of ensemble Rabi flopping?\n\nHow does my ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "eff"], TraditionalForm]]],
 " \[OpenCurlyDoubleQuote]know\[CloseCurlyDoubleQuote] that atomic \
transitions with circular light are possible? there is no defined \
quantization axis... maybe there should be? but then there would be zeeman \
splitting, which i don\[CloseCurlyQuote]t want. As it stands, all of the \
symmetric basis states for my diagonalized ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "eff"], TraditionalForm]]],
 " have equal occupation in all m=0 sub-states. "
}], "Text",
 CellChangeTimes->{{3.805668178473505*^9, 3.8056683966718793`*^9}, {
   3.808681468062796*^9, 3.808681624587453*^9}, 3.808681678962863*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["setup", "Section",
 CellChangeTimes->{
  3.804795272338377*^9, {3.8047953612651463`*^9, 3.8047953705323234`*^9}}],

Cell["\<\
System description: atomnum two-level atoms arranged in a 2D square grid with \
equal periodicity in x and y. The lower level is has only one angular \
momentum state (J=0) while the upper state has three Zeeman sublevels (J=1). \
\>", "Text",
 CellChangeTimes->{{3.8065110621169147`*^9, 3.806511163740156*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"PHYSICAL", " ", "CONSTANTS"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[HBar]", " ", "=", " ", 
     RowBox[{"6.62607015*^-34", "/", 
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Mu]0", " ", "=", 
     RowBox[{"4", "\[Pi]", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", " ", "=", " ", "299792458"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]0", " ", "=", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "\[Mu]0"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ee", " ", "=", " ", "1.602*^-19"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"electron", " ", "charge"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a0", " ", "=", " ", "5.27*^-11"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Bohr", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PARAMETERS", " ", "and", " ", "other", " ", "DEFINITIONS"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"atomnum", " ", "=", " ", "25"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "should", " ", "be", " ", "an", " ", "odd", " ", "perfect", " ", 
      "square"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"J", " ", "=", " ", "1"}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "upper", " ", "level", " ", "total", " ", "angular", 
      "\[IndentingNewLine]", " ", "momentum"}], "*)"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]", " ", "=", " ", 
     RowBox[{"7.8", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matelem", " ", "=", " ", 
     RowBox[{"ee", " ", "a0"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "just", " ", "assume", " ", "a", " ", "general", " ", "matrix", " ", 
      "element", " ", "is", " ", "of", " ", "this", " ", "order", " ", "for", 
      " ", 
      RowBox[{"now", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]", " ", "=", " ", 
     RowBox[{
      SuperscriptBox["matelem", "2"], 
      RowBox[{
       SuperscriptBox["k", "3"], "/", 
       RowBox[{"(", 
        RowBox[{"6", " ", "\[Pi]", " ", "\[Epsilon]0"}], ")"}]}]}]}], ";", 
    " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"single", " ", "two"}], "-", 
       RowBox[{"level", " ", "atom", " ", "linewidth"}]}], ",", " ", 
      RowBox[{"\[HBar]", "=", "1"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"pol", " ", "=", " ", 
     RowBox[{"Range", "[", "3", "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"pol", "[", 
        RowBox[{"[", "\[Mu]", "]"}], "]"}], "/.", 
       RowBox[{"u", "->", "1"}]}], ",", "2", ",", 
      RowBox[{
       RowBox[{"3", " ", "for", " ", "polarization", " ", "\[Sigma]"}], "=", 
       RowBox[{"-", "1"}]}], ",", "0", ",", 
      RowBox[{"+", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "\[Mu]_"], ":=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "[", 
      RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"no", " ", "Zeeman", " ", "splitting", " ", "for", " ", "now"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"deg", " ", "=", " ", 
     RowBox[{
      RowBox[{"2", "J"}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim", " ", "=", " ", 
     RowBox[{"deg", "*", "atomnum"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Hamiltonian", " ", "shape", " ", "is", " ", "dim", " ", "x", " ", 
       "dim"}], ",", " ", 
      RowBox[{
       RowBox[{"with", " ", "state", " ", "vector"}], " ", "=", " ", 
       "dim"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "FUNCTIONS", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idx", "[", 
      RowBox[{"i_", ",", "j_", ",", "n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "n"}], "+", "j"}], "//", 
      "Simplify"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "get", " ", "1", "D", " ", "atom", " ", "idx", " ", "from", " ", "2", 
      "D", " ", "coordinate", " ", "indices"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["r", 
      RowBox[{"i_", ",", "j_"}]], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"j", "-", "1"}], ",", "n"}], "]"}], "-", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "n"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"j", "-", "1"}], ")"}], "/", "n"}], "]"}], "-", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "/", "n"}], "]"}]}]}], "}"}], "/.", 
      RowBox[{"n", "\[Rule]", 
       SqrtBox["atomnum"]}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"vector", " ", "between", " ", "atoms", " ", "i"}], ",", 
      RowBox[{
      "j", " ", "in", " ", "units", " ", "lattice", " ", "spacing"}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"unit", "[", "v_", "]"}], ":=", 
     FractionBox["v", 
      SqrtBox[
       RowBox[{"v", ".", "v"}]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GdotP", "[", 
      RowBox[{"r_", ",", "p_"}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "k", " ", 
         SqrtBox[
          RowBox[{"r", ".", "r"}]]}]], 
       RowBox[{"4", " ", "\[Pi]", " ", 
        SqrtBox[
         RowBox[{"r", ".", "r"}]]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}], ",", 
          RowBox[{"unit", "[", "r", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            RowBox[{
             SuperscriptBox["k", "2"], 
             RowBox[{"r", ".", "r"}]}]], "-", 
           FractionBox["\[ImaginaryI]", 
            RowBox[{"k", " ", 
             SqrtBox[
              RowBox[{"r", ".", "r"}]]}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            RowBox[{"unit", "[", "r", "]"}], " ", 
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{"unit", "[", "r", "]"}], ",", "p"}], "]"}]}], "-", 
           "p"}], ")"}]}]}], ")"}]}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "r", " ", "is", " ", "the", " ", "positional", " ", "unit", " ", 
       "vector"}], ",", " ", 
      RowBox[{
      "p", " ", "is", " ", "an", " ", "atomic", " ", "dipole", " ", 
       "moment"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["e", "\[Mu]_"], " ", ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "[", 
      RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"generic", " ", "basis", " ", "vector", " ", "set"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["ecart", "\[Mu]_"], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SqrtBox["2"]], 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", " ", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "\[ImaginaryI]"}], 
          SqrtBox["2"]], 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0", ",", " ", "1"}], "}"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1", ",", "0"}], "}"}]}], "}"}], "[", 
      RowBox[{"[", "\[Mu]", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", " ", "in", " ", "spherical", " ", "basis"}]}], 
     "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.804795372139743*^9, 3.8047954565762587`*^9}, {
   3.804795557477767*^9, 3.804795646192586*^9}, {3.805670829592176*^9, 
   3.8056708978355913`*^9}, {3.8059959856055202`*^9, 3.805995986254162*^9}, {
   3.8059985871648145`*^9, 3.8059986288484855`*^9}, {3.8059997358360014`*^9, 
   3.805999788758046*^9}, {3.8059999118297677`*^9, 3.8059999521643977`*^9}, {
   3.805999992044653*^9, 3.8060000636137767`*^9}, {3.8060001456463013`*^9, 
   3.8060001964015045`*^9}, {3.8060002660690813`*^9, 3.8060002884442167`*^9}, 
   3.806000626716222*^9, 3.806001860902274*^9, 3.8060020439721518`*^9, {
   3.8060026207721825`*^9, 3.80600266366413*^9}, {3.8060026966204414`*^9, 
   3.8060027062593665`*^9}, {3.8060060864367876`*^9, 3.806006284666767*^9}, {
   3.80600633970216*^9, 3.806006436560063*^9}, {3.8060064977258167`*^9, 
   3.8060065810076523`*^9}, {3.8065097730595045`*^9, 3.806509811016704*^9}, {
   3.8065108020023785`*^9, 3.8065108352304597`*^9}, {3.806511491827402*^9, 
   3.806511491880254*^9}, {3.8065116937092276`*^9, 3.8065117567284775`*^9}, 
   3.806512394112631*^9, {3.806512596967489*^9, 3.806512597549224*^9}, {
   3.806512635854741*^9, 3.806512639698132*^9}, 3.8065184714886026`*^9, {
   3.806518807617782*^9, 3.806518818536937*^9}, {3.8065188588224583`*^9, 
   3.8065188745589724`*^9}, {3.806522742274407*^9, 3.8065227992408857`*^9}, {
   3.80652624964219*^9, 3.8065263011476345`*^9}, {3.806526338176937*^9, 
   3.806526338878935*^9}, {3.806527870071875*^9, 3.806527886706303*^9}, {
   3.8065280491641827`*^9, 3.8065280499206524`*^9}, {3.8065288434330974`*^9, 
   3.8065288441316767`*^9}, {3.80652935916156*^9, 3.806529360595722*^9}, 
   3.8065909213975697`*^9, {3.8065945956794834`*^9, 3.8065946197902155`*^9}, {
   3.806595111718749*^9, 3.80659511816251*^9}, {3.8066044544589233`*^9, 
   3.8066044646028137`*^9}, {3.80696565986509*^9, 3.8069656634134607`*^9}, {
   3.8069656979471774`*^9, 3.8069657129861*^9}, {3.806965905008503*^9, 
   3.806965917930096*^9}, {3.806969203048703*^9, 3.806969247088546*^9}, {
   3.806969399593093*^9, 3.806969426621357*^9}, {3.8069694691605425`*^9, 
   3.8069695583291035`*^9}, {3.8069696687010384`*^9, 
   3.8069697479909005`*^9}, {3.8069708799936037`*^9, 3.806970937308947*^9}, {
   3.8071341724945297`*^9, 3.8071342023307457`*^9}, {3.807134239967105*^9, 
   3.807134245276909*^9}, {3.8071343282560205`*^9, 3.8071343467146626`*^9}, {
   3.8071344033173037`*^9, 3.8071345328828435`*^9}, {3.8071353004034786`*^9, 
   3.8071353048336315`*^9}, {3.807135353381813*^9, 3.807135371458476*^9}, {
   3.807136104073449*^9, 3.807136128133113*^9}, {3.807136286895579*^9, 
   3.8071363155599303`*^9}, {3.807182165268559*^9, 3.8071821736182346`*^9}, {
   3.807184444104906*^9, 3.8071845076699314`*^9}, {3.8071864003406534`*^9, 
   3.8071864384617157`*^9}, {3.807186480235013*^9, 3.807186493333987*^9}, {
   3.8071866070229807`*^9, 3.807186607130693*^9}, {3.8071868135856285`*^9, 
   3.8071868476256046`*^9}, 3.807203261610388*^9, {3.8072038692517233`*^9, 
   3.8072038740319357`*^9}, {3.807213911849493*^9, 3.8072139140357633`*^9}, {
   3.8072140018354006`*^9, 3.8072140100513997`*^9}, {3.8072173311304865`*^9, 
   3.807217345535433*^9}, {3.807221360734707*^9, 3.8072213636309876`*^9}, {
   3.8079821163915453`*^9, 3.8079821587163076`*^9}, {3.807986244761863*^9, 
   3.807986305420913*^9}, {3.807987427293959*^9, 3.807987461143407*^9}, {
   3.808064660727276*^9, 3.8080646710536537`*^9}, {3.808064978922209*^9, 
   3.8080649889520206`*^9}, {3.808065133138933*^9, 3.808065137247834*^9}, {
   3.8080656978757963`*^9, 3.8080657129905295`*^9}, {3.808068297769658*^9, 
   3.8080682988068843`*^9}, {3.8080683318016787`*^9, 3.808068333322548*^9}, {
   3.8080687285840673`*^9, 3.808068729604082*^9}, {3.808068793234928*^9, 
   3.8080687946362305`*^9}, {3.808071621206293*^9, 3.8080716723275375`*^9}, {
   3.8080729540168924`*^9, 3.8080729609414005`*^9}, 3.8081740669737325`*^9, {
   3.8081741515898724`*^9, 3.808174154407746*^9}, 3.8081757347113743`*^9, {
   3.80850296857384*^9, 3.8085030083264093`*^9}, {3.808503067468046*^9, 
   3.8085031670005584`*^9}, {3.8085034258887215`*^9, 3.808503429488124*^9}, {
   3.808503479673551*^9, 3.8085034823204985`*^9}, {3.8085035467900696`*^9, 
   3.808503594831055*^9}, {3.808503764886863*^9, 3.8085038227088747`*^9}, {
   3.8085062266270256`*^9, 3.8085062282964144`*^9}, 3.8085063375988884`*^9, {
   3.8085064788703156`*^9, 3.808506480017167*^9}, {3.80850652972351*^9, 
   3.8085065309142447`*^9}, {3.8085067139700546`*^9, 3.808506715888835*^9}, {
   3.808563738055747*^9, 3.808563804867737*^9}, {3.808573814421254*^9, 
   3.808573815415248*^9}, 3.808651641220073*^9, {3.8086518769444513`*^9, 
   3.808651893549247*^9}, 3.8086558780542803`*^9, {3.808656024934702*^9, 
   3.8086560272983837`*^9}, {3.808662363748914*^9, 3.808662408664112*^9}, {
   3.808664687414502*^9, 3.808664689986473*^9}, {3.8086682528166385`*^9, 
   3.8086682545748963`*^9}, {3.808676180008201*^9, 3.808676184370633*^9}, {
   3.808676232267743*^9, 3.8086762327931757`*^9}, {3.8086762661744785`*^9, 
   3.8086763102835283`*^9}, {3.8086806992151303`*^9, 3.808680700237514*^9}, {
   3.8087546100096054`*^9, 3.8087546122137136`*^9}, {3.8087547536620526`*^9, 
   3.8087547547062635`*^9}}],

Cell[TextData[{
 "Restricting this problem to the single-excitation subspace, the Hamiltonian \
matrix elements are: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "j"}], "-", "1", "+", "\[Nu]"}], ",", 
      RowBox[{
       RowBox[{"3", "k"}], "-", "1", "+", "\[Nu]"}]}]], "=", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["H", "\[Nu]\[Mu]"], 
      RowBox[{"(", "jk", ")"}]], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "\[Mu]"], 
       SubscriptBox["\[Delta]", "jk"], 
       SubscriptBox["\[Delta]", "\[Mu]\[Nu]"]}], "+", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[CapitalOmega]", "\[Mu]\[Nu]"], 
        RowBox[{"(", "jk", ")"}]], "(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Delta]", "jk"]}], ")"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox[
        SubscriptBox["\[Gamma]", "\[Mu]\[Nu]"], 
        RowBox[{"(", "jk", ")"}]]}]}]}]}], TraditionalForm]]],
 ", \[HBar]=1, where \[Mu],\[Nu] specify polarization in a spherical basis \
and j,k are the atom indices in the 2D grid. The dynamics in this subspace \
are coherent, but H is non-Hermitian, so there is dissipation as the \
excitation diffuses into the collective ground state. "
}], "Text",
 CellChangeTimes->{{3.804795955202659*^9, 3.804796203497088*^9}, {
  3.8051540631375103`*^9, 3.8051541172328863`*^9}, {3.8060047095110035`*^9, 
  3.8060047102689743`*^9}, {3.8066050132591124`*^9, 3.8066050897983627`*^9}, {
  3.806708395044424*^9, 3.806708426075447*^9}, {3.8086762139235163`*^9, 
  3.808676221044484*^9}, {3.808681458085475*^9, 3.80868146251762*^9}}],

Cell["\<\
- \[CapitalDelta],\[Gamma] values used are arbitrary with the given choice of \
plot units. \
\>", "Text",
 CellChangeTimes->{{3.804797675818221*^9, 3.804797723814588*^9}, {
   3.8060077992621117`*^9, 3.8060078474172754`*^9}, {3.806527383456627*^9, 
   3.8065274289762917`*^9}, {3.8069659357565007`*^9, 3.8069660075004425`*^9}, 
   3.8087507235797634`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linewidths vs lattice spacing", "Section",
 CellChangeTimes->{{3.8060017187482805`*^9, 3.806001720111932*^9}, {
  3.807219143212973*^9, 3.8072191566618133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ipmode", " ", "=", " ", 
    RowBox[{"unit", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["ecart", "2"], "&"}], ",", "atomnum"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"in", "-", 
     RowBox[{"plane", " ", 
      RowBox[{"state", ":", " ", 
       RowBox[{
       "each", " ", "atom", " ", "excited", " ", "with", " ", "P"}]}]}]}], 
    "=", "y"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fmode", " ", "=", 
    RowBox[{"unit", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["ecart", "1"], "&"}], ",", "atomnum"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ferromagnetic", " ", 
      RowBox[{"state", ":", " ", 
       RowBox[{
       "each", " ", "atom", " ", "excited", " ", "with", " ", "P"}]}]}], "=", 
     "x"}], ",", " ", 
    RowBox[{"all", " ", "in", " ", "phase"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"afmode", " ", "=", 
    RowBox[{"unit", "[", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "#"], 
          SubscriptBox["ecart", "1"]}], "&"}], ",", "atomnum"}], "]"}]}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"antiferromagnetic", " ", 
      RowBox[{"state", ":", " ", 
       RowBox[{"every", " ", "atom", " ", "has", " ", "P"}]}]}], "=", "x"}], 
    ",", " ", 
    RowBox[{
    "but", " ", "alternating", " ", "phases", " ", "by", " ", "\[Pi]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modelist", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ipmode", ",", "\"\<In-plane\>\"", ",", 
         SubscriptBox["e", "2"]}], "}"}], ","}], "*)"}], 
     RowBox[{"{", 
      RowBox[{"fmode", ",", "\"\<Ferromagnetic\>\"", ",", 
       SubscriptBox["e", "1"]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{"afmode", ",", "\"\<Antiferromagnetic\>\"", ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "k"], 
         SubscriptBox["e", "1"]}]}], "}"}], "*)"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"mode", ",", " ", "name", ",", " ", 
     RowBox[{
     "polarization", " ", "of", " ", "kth", " ", "atom", " ", "in", " ", 
      "cartesian", " ", "basis"}]}], "}"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "}"}], "&"}], ",", 
     RowBox[{"Length", "[", "modelist", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8047957075769863`*^9, 3.8047957160186987`*^9}, {
   3.804795751749652*^9, 3.8047957753372602`*^9}, {3.8047958647839427`*^9, 
   3.8047958810052404`*^9}, {3.804796317244423*^9, 3.804796317757765*^9}, {
   3.8047963499082375`*^9, 3.804796350997925*^9}, {3.8047963851916113`*^9, 
   3.8047965802424455`*^9}, {3.804796906204793*^9, 3.8047969231715045`*^9}, {
   3.8047970996371055`*^9, 3.804797130431709*^9}, {3.804797164314621*^9, 
   3.804797189088416*^9}, {3.804797225107823*^9, 3.804797240025271*^9}, {
   3.804797313699103*^9, 3.8047973177373066`*^9}, {3.8047973613239803`*^9, 
   3.804797370009427*^9}, {3.804797408918919*^9, 3.8047975583843765`*^9}, {
   3.806001650976497*^9, 3.8060016589526815`*^9}, {3.8060017314517384`*^9, 
   3.8060017767336435`*^9}, {3.806004878030676*^9, 3.806004924573162*^9}, {
   3.8060049714755926`*^9, 3.806005054720866*^9}, {3.806005159955346*^9, 
   3.8060052104992*^9}, {3.8060055903173656`*^9, 3.806005634391409*^9}, 
   3.8060056645098248`*^9, {3.8060057252014904`*^9, 3.8060057621566105`*^9}, {
   3.806005903864731*^9, 3.8060060711801853`*^9}, {3.806006464504057*^9, 
   3.8060064745453615`*^9}, {3.8065114209393826`*^9, 3.80651143952631*^9}, {
   3.8065118879410534`*^9, 3.8065119304186153`*^9}, {3.8065120541431723`*^9, 
   3.8065120786660805`*^9}, {3.806512111318968*^9, 3.806512117772833*^9}, {
   3.8065185763323545`*^9, 3.8065185833177795`*^9}, {3.8065263199233694`*^9, 
   3.806526380358791*^9}, {3.806526413832776*^9, 3.8065265127960787`*^9}, {
   3.8065266341848392`*^9, 3.806526870571285*^9}, {3.806526956417033*^9, 
   3.806526986413436*^9}, {3.806527037223099*^9, 3.806527261208042*^9}, {
   3.806527295513465*^9, 3.806527295669182*^9}, {3.806527328020631*^9, 
   3.806527341257271*^9}, {3.806527460505497*^9, 3.8065275012288465`*^9}, {
   3.80652753563792*^9, 3.806527551058766*^9}, {3.8065276922441616`*^9, 
   3.80652770202234*^9}, 3.806528162100207*^9, {3.8065285144117265`*^9, 
   3.8065285303456287`*^9}, {3.806528641328827*^9, 3.8065287551228657`*^9}, 
   3.8065288006188035`*^9, {3.8065292611172466`*^9, 3.8065293276094007`*^9}, {
   3.8065936158772783`*^9, 3.806593622860238*^9}, 3.8065982519928627`*^9, {
   3.806604917453409*^9, 3.806604924169443*^9}, 3.8066049816476774`*^9, {
   3.806708451368812*^9, 3.806708455594513*^9}, {3.8068473498907647`*^9, 
   3.806847379779009*^9}, {3.8069647922603755`*^9, 3.8069648830944805`*^9}, {
   3.806964919513381*^9, 3.8069649748807154`*^9}, {3.8069658378869267`*^9, 
   3.806965842398003*^9}, {3.8069660156645174`*^9, 3.806966051346472*^9}, {
   3.8069660877994947`*^9, 3.8069661333815975`*^9}, {3.8069664344277143`*^9, 
   3.8069664438732514`*^9}, 3.8069664819973645`*^9, {3.8069698662224684`*^9, 
   3.8069699326781263`*^9}, {3.8069699780288734`*^9, 3.80696998974317*^9}, {
   3.8069700309706326`*^9, 3.806970031083357*^9}, {3.806970155418984*^9, 
   3.8069701589201584`*^9}, {3.80713701736033*^9, 3.8071370474544315`*^9}, {
   3.807137082833229*^9, 3.807137085877409*^9}, {3.8071371208042917`*^9, 
   3.807137125000827*^9}, {3.8072050181442795`*^9, 3.807205022818139*^9}, {
   3.807206851507414*^9, 3.8072068536965294`*^9}, {3.8072190528331976`*^9, 
   3.8072190875282907`*^9}, {3.8072191210727825`*^9, 
   3.8072191260164566`*^9}, {3.8072191798435316`*^9, 3.807219181257785*^9}, {
   3.8072192915174055`*^9, 3.807219323507081*^9}, 3.8072194548444233`*^9, {
   3.8072195587851295`*^9, 3.8072195732128196`*^9}, {3.807219631033788*^9, 
   3.807219656275481*^9}, 3.8080650747429304`*^9, 3.808065866016163*^9, {
   3.808679601044403*^9, 3.8086796585571594`*^9}, {3.8086797991134033`*^9, 
   3.808679803082793*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "calculate", " ", "the", " ", "collective", " ", "linewidths", " ", "for", 
    " ", "modelist", " ", "modes", " ", "as", " ", "a", " ", "function", " ", 
    "of", " ", "lattice", " ", "spacing"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solntime", " ", "=", " ", 
     RowBox[{
      RowBox[{"Timing", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"d", "=", "0.8"}], ",", 
          RowBox[{"d", "<", "0.9"}], ",", 
          RowBox[{"d", "++"}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "loop", " ", "over", " ", "fractional", " ", "lattice", " ", 
            "period"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode", "=", "1"}], ",", 
             RowBox[{"mode", "<", 
              RowBox[{
               RowBox[{"Length", "[", "modelist", "]"}], "+", "1"}]}], ",", 
             RowBox[{"mode", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"e", "[", "k_", "]"}], "=", 
               RowBox[{"modelist", "[", 
                RowBox[{"[", 
                 RowBox[{"mode", ",", "3"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"build", " ", "the", " ", "Hamiltonian"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Hfull", " ", "=", " ", 
               RowBox[{"Array", "[", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["H", "##"], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"buildtime", " ", "=", " ", 
               RowBox[{
                RowBox[{"Timing", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{"atomnum", "+", "1"}]}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ",", 
                    RowBox[{"j", "<", 
                    RowBox[{"atomnum", "+", "1"}]}], ",", 
                    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"\[Nu]", "=", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"\[Nu]", "<", "2"}], ",", 
                    RowBox[{"\[Nu]", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"\[Mu]", "=", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"\[Mu]", "<", "2"}], ",", 
                    RowBox[{"\[Mu]", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"u", "=", 
                    RowBox[{"d", " ", "\[Lambda]", " ", 
                    SubscriptBox["r", 
                    RowBox[{"i", ",", "j"}]]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Gij", "=", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
                    RowBox[{"GdotP", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}], ",", 
                    RowBox[{"e", "[", "j", "]"}]}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], "k"], 
                    RowBox[{"Re", "[", 
                    RowBox[{"Gij", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rx", " ", "\[Rule]", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ry", "\[Rule]", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
                    RowBox[{"rz", "\[Rule]", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], " ", 
                    "]"}]}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"\[Gamma]\[Mu]\[Nu]ij", "=", 
                    RowBox[{"Piecewise", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "j"}], "&&", " ", 
                    RowBox[{"\[Mu]", "\[Equal]", "\[Nu]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    FractionBox[
                    RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], "k"], 
                    RowBox[{"Im", "[", 
                    RowBox[{"Gij", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rx", " ", "\[Rule]", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"ry", "\[Rule]", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
                    RowBox[{"rz", "\[Rule]", " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}], " ",
                     ",", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Gamma]", ",", 
                    RowBox[{"i", "\[Equal]", "j"}]}], "}"}]}], "}"}], "]"}]}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Hfull", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"3", "i"}], "-", "1", "+", "\[Nu]"}], ",", 
                    RowBox[{
                    RowBox[{"3", "j"}], "-", "1", "+", "\[Mu]"}]}], "]"}], 
                    "]"}], "=", " ", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"2", "-", "\[Mu]"}]], 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], 
                    RowBox[{"KroneckerDelta", "[", 
                    RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
                    "\[CapitalOmega]\[Mu]\[Nu]ij", "+", 
                    RowBox[{
                    "\[ImaginaryI]", " ", "\[Gamma]\[Mu]\[Nu]ij"}]}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]",
                  "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<built H. `` s\>\"", ",", "buildtime"}], "]"}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "find", " ", "the", " ", "linewidth", " ", "of", " ", 
                 "eigenmode", " ", "which", " ", "most", " ", "nearly", " ", 
                 "overlaps", " ", "the", " ", "state", " ", "vector", " ", 
                 "of", " ", "interest"}], ",", " ", 
                RowBox[{
                 RowBox[{"e", ".", "g", ".", " ", "the"}], " ", 
                 "ferromagnetic", " ", "excitation"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"diagtime", " ", "=", " ", 
               RowBox[{
                RowBox[{"Timing", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"evals", ",", "evecs"}], "}"}], " ", "=", " ", 
                   RowBox[{"Eigensystem", "[", "Hfull", "]"}]}], ";"}], 
                 "\[IndentingNewLine]", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<diagonalized H. `` s\>\"", ",", "diagtime"}], 
                  "]"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"overlap", " ", "=", " ", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"overlaptime", " ", "=", " ", 
               RowBox[{
                RowBox[{"Timing", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"For", "[", 
                   RowBox[{
                    RowBox[{"i", " ", "=", " ", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "evecs", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"overlap", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"modelist", "[", 
                    RowBox[{"[", 
                    RowBox[{"mode", ",", "1"}], "]"}], "]"}], ".", 
                    RowBox[{"evecs", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"maxIdx", "=", 
                   RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"overlap", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"Print", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{
                    "\"\<evals[[maxIdx]]: ``, Im[evals[[maxIdx]]]: ``, \
Log10[Im[evals[[maxIdx]]]/\[Gamma]]: ``\>\"", ",", 
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "maxIdx", "]"}], "]"}], ",", 
                    RowBox[{"Im", "[", 
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", 
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}], "/", 
                    "\[Gamma]"}], "]"}]}], "]"}], "]"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"v", "=", " ", 
                   RowBox[{"Im", "[", 
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}]}], ";", 
                  RowBox[{"(*", 
                   RowBox[{"mode", " ", "linewidth"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<eigenval: ``\>\"", ",", 
                    RowBox[{
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "maxIdx", "]"}], "]"}], "//", 
                    "ComplexExpand"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "mode", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"v", "/", "\[Gamma]"}], "]"}]}], "}"}]}], "]"}]}],
                   ";"}], "\[IndentingNewLine]", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<simulation took `` minutes\>\"", ",", 
     RowBox[{"Floor", "[", 
      RowBox[{"solntime", "/", "60"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8047957075769863`*^9, 3.8047957160186987`*^9}, {
   3.804795751749652*^9, 3.8047957753372602`*^9}, {3.8047958647839427`*^9, 
   3.8047958810052404`*^9}, {3.804796317244423*^9, 3.804796317757765*^9}, {
   3.8047963499082375`*^9, 3.804796350997925*^9}, {3.8047963851916113`*^9, 
   3.8047965802424455`*^9}, {3.804796906204793*^9, 3.8047969231715045`*^9}, {
   3.8047970996371055`*^9, 3.804797130431709*^9}, {3.804797164314621*^9, 
   3.804797189088416*^9}, {3.804797225107823*^9, 3.804797240025271*^9}, {
   3.804797313699103*^9, 3.8047973177373066`*^9}, {3.8047973613239803`*^9, 
   3.804797370009427*^9}, {3.804797408918919*^9, 3.8047975583843765`*^9}, {
   3.806001650976497*^9, 3.8060016589526815`*^9}, {3.8060017314517384`*^9, 
   3.8060017767336435`*^9}, {3.806004878030676*^9, 3.806004924573162*^9}, {
   3.8060049714755926`*^9, 3.806005054720866*^9}, {3.806005159955346*^9, 
   3.8060052104992*^9}, {3.8060055903173656`*^9, 3.806005634391409*^9}, 
   3.8060056645098248`*^9, {3.8060057252014904`*^9, 3.8060057621566105`*^9}, {
   3.806005903864731*^9, 3.8060060711801853`*^9}, {3.806006464504057*^9, 
   3.8060064745453615`*^9}, {3.8065114209393826`*^9, 3.80651143952631*^9}, {
   3.8065118879410534`*^9, 3.8065119304186153`*^9}, {3.8065120541431723`*^9, 
   3.8065120786660805`*^9}, {3.806512111318968*^9, 3.806512117772833*^9}, {
   3.8065185763323545`*^9, 3.8065185833177795`*^9}, {3.8065263199233694`*^9, 
   3.806526380358791*^9}, {3.806526413832776*^9, 3.8065265127960787`*^9}, {
   3.8065266341848392`*^9, 3.8065267362762146`*^9}, {3.806529448137672*^9, 
   3.806529455533886*^9}, {3.806593653293211*^9, 3.806593706613532*^9}, {
   3.8065946436774864`*^9, 3.8065948179722404`*^9}, {3.806594852246138*^9, 
   3.8065948787010107`*^9}, {3.806594931101742*^9, 3.8065949805788956`*^9}, {
   3.8065982572353477`*^9, 3.806598259873415*^9}, {3.8066044924851975`*^9, 
   3.8066045591648235`*^9}, {3.806604863937566*^9, 3.806604890282112*^9}, {
   3.806605116811099*^9, 3.8066051462822666`*^9}, {3.8066051808078985`*^9, 
   3.8066052494263363`*^9}, {3.806605394813945*^9, 3.8066054097140183`*^9}, {
   3.8066054927858195`*^9, 3.806605565753239*^9}, {3.806605596617673*^9, 
   3.806605663242216*^9}, 3.806605709203844*^9, {3.8066058652745733`*^9, 
   3.8066058672672696`*^9}, {3.8066074950118074`*^9, 3.8066075001789837`*^9}, 
   3.8069658936377726`*^9, {3.806966160947524*^9, 3.8069663217924857`*^9}, 
   3.8069663781431*^9, {3.806966411571516*^9, 3.80696646392134*^9}, {
   3.8069665448983564`*^9, 3.806966568630046*^9}, {3.8069673593729687`*^9, 
   3.8069673660476894`*^9}, {3.806968816107303*^9, 3.806968820992465*^9}, 
   3.806970264844627*^9, {3.8069711650392084`*^9, 3.8069711850846257`*^9}, {
   3.8069715960283747`*^9, 3.806971606548246*^9}, {3.8069716609886713`*^9, 
   3.8069717063782983`*^9}, {3.8069717862507153`*^9, 
   3.8069717975445166`*^9}, {3.807182765946335*^9, 3.8071827827035246`*^9}, {
   3.807183623268838*^9, 3.807183825589827*^9}, 3.807183991389476*^9, {
   3.807185124709716*^9, 3.807185129977629*^9}, {3.807185430792245*^9, 
   3.807185434426527*^9}, {3.8071868029031944`*^9, 3.8071868214446135`*^9}, {
   3.807186914985483*^9, 3.8071869343925905`*^9}, {3.807187191087182*^9, 
   3.807187191478136*^9}, 3.807187430274591*^9, {3.8072036818530736`*^9, 
   3.8072037710175476`*^9}, {3.8072038399810686`*^9, 3.807203843177478*^9}, {
   3.8072039579257393`*^9, 3.8072040493342533`*^9}, {3.8072041291975822`*^9, 
   3.807204139768303*^9}, {3.807204249329215*^9, 3.8072042599777565`*^9}, {
   3.807205322749794*^9, 3.8072053232803736`*^9}, {3.8072140864481754`*^9, 
   3.80721409358803*^9}, {3.8072174008216853`*^9, 3.8072174061025977`*^9}, {
   3.807217471490721*^9, 3.8072175770615673`*^9}, {3.80721786178631*^9, 
   3.807217885031418*^9}, 3.8072180360199223`*^9, 3.8072181522682824`*^9, {
   3.8072190528660793`*^9, 3.807219052881073*^9}, {3.807219235537444*^9, 
   3.807219264148366*^9}, {3.8072195946121626`*^9, 3.8072196056627574`*^9}, {
   3.8072196658308086`*^9, 3.8072197157743206`*^9}, {3.8072211866564255`*^9, 
   3.8072211900952253`*^9}, {3.807221254034566*^9, 3.8072213053944144`*^9}, {
   3.808065336572613*^9, 3.808065338361801*^9}, 3.8080654228421946`*^9, {
   3.808065667529977*^9, 3.808065668868394*^9}, {3.808065941173425*^9, 
   3.808065942359216*^9}, 3.808067972021418*^9, 3.80806801445197*^9, {
   3.8080681464242287`*^9, 3.808068154845772*^9}, {3.8080690173426304`*^9, 
   3.8080690903433137`*^9}, {3.808069122829056*^9, 3.8080691855742984`*^9}, {
   3.808069219765608*^9, 3.8080692356620836`*^9}, {3.808069486454792*^9, 
   3.8080695340095773`*^9}, {3.8080697776923676`*^9, 
   3.8080698580402346`*^9}, {3.808071524082116*^9, 3.808071533988641*^9}, {
   3.8080719334440207`*^9, 3.8080719398957605`*^9}, {3.8080719878654633`*^9, 
   3.8080720132814717`*^9}, {3.808177881819213*^9, 3.8081778818959956`*^9}, {
   3.8081779871963606`*^9, 3.8081779897036285`*^9}, {3.8081781073260584`*^9, 
   3.8081781074216366`*^9}, {3.808503207946022*^9, 3.808503213581484*^9}, 
   3.808504301512636*^9, {3.8085059303221674`*^9, 3.8085059414902973`*^9}, {
   3.808506612070572*^9, 3.8085066194395204`*^9}, 3.8085066587653275`*^9, 
   3.808521989153084*^9, 3.808573760965603*^9, 3.8086516696820087`*^9, {
   3.8086517244337473`*^9, 3.808651728110808*^9}, {3.808651770102971*^9, 
   3.8086518084602995`*^9}, 3.808651848503468*^9, {3.808655907160466*^9, 
   3.8086559481818533`*^9}, {3.808662599693982*^9, 3.808662625351404*^9}, 
   3.8086626607497454`*^9, {3.808663957539449*^9, 3.8086640132546577`*^9}, {
   3.8086652237141485`*^9, 3.808665231209956*^9}, {3.8086664283161726`*^9, 
   3.80866647814299*^9}, {3.808666618429018*^9, 3.8086667737728205`*^9}, 
   3.8086668199034896`*^9, {3.8086668504797993`*^9, 3.8086668525741987`*^9}, {
   3.8086668967670355`*^9, 3.8086669284852977`*^9}, {3.808668221874334*^9, 
   3.8086682219082117`*^9}, {3.8086683052534676`*^9, 3.8086683592032704`*^9}, 
   3.8086684669871335`*^9, {3.8086690488395567`*^9, 3.8086690595011024`*^9}, {
   3.808669095369139*^9, 3.8086690968980503`*^9}, {3.8086693562166924`*^9, 
   3.808669377031019*^9}, {3.808669561764237*^9, 3.808669578975232*^9}, {
   3.8086759263140435`*^9, 3.8086759282975483`*^9}, {3.8086763176076536`*^9, 
   3.808676334341853*^9}, {3.80867700553382*^9, 3.8086770187803993`*^9}, {
   3.808677692996764*^9, 3.8086776973840404`*^9}, {3.8086789119711*^9, 
   3.808678938393476*^9}, {3.808679004664196*^9, 3.808679011771489*^9}, {
   3.8086790422099605`*^9, 3.8086790427594914`*^9}, {3.8086806891370754`*^9, 
   3.8086806897276006`*^9}, 3.808681094178609*^9}],

Cell[BoxData[
 InterpretationBox["\<\"eigenval: \
\\!\\(\\*RowBox[{\\\"8.781998813754673`*^-51\\\", \\\"+\\\", \
RowBox[{\\\"3.389127853658406`*^-51\\\", \\\" \\\", \\\"\[ImaginaryI]\\\"}]}]\
\\)\"\>",
  StringForm["eigenval: ``", 
   Complex[8.781998813754673*^-51, 3.389127853658406*^-51]],
  Editable->False]], "Print",
 CellChangeTimes->{3.808679023292524*^9, 3.8086790575692053`*^9, 
  3.808753855880839*^9, 3.80875467642365*^9}],

Cell[BoxData[
 InterpretationBox["\<\"simulation took \\!\\(\\*RowBox[{\\\"0\\\"}]\\) \
minutes\"\>",
  StringForm["simulation took `` minutes", 0],
  Editable->False]], "Output",
 CellChangeTimes->{{3.80867904435323*^9, 3.808679057583869*^9}, 
   3.8087538558919277`*^9, 3.8087546764354715`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Im", "[", 
  RowBox[{"evals", "[", 
   RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.808754337634367*^9, 3.808754338365411*^9}, {
  3.8087543895446143`*^9, 3.8087544386254253`*^9}}],

Cell[BoxData["3.389127853658406`*^-51"], "Output",
 CellChangeTimes->{
  3.808754338874132*^9, {3.8087543984996767`*^9, 3.808754439302678*^9}, 
   3.8087555584766016`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["maxIdx"], "Input",
 CellChangeTimes->{{3.8087544564867725`*^9, 3.8087544576616774`*^9}}],

Cell[BoxData["30"], "Output",
 CellChangeTimes->{3.808754457981685*^9, 3.8087555668483367`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e", "[", "j", "]"}]], "Input",
 CellChangeTimes->{{3.808680544653819*^9, 3.808680551210376*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.808680551736884*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evecs", "[", 
  RowBox[{"[", "maxIdx", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8086777281811695`*^9, 3.8086777344693527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.08372103157275701`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.006078760630870871`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.04355318687214719`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.11955752803245372`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.12727421844490383`"}], "-", 
    RowBox[{"0.11347876740158311`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.2947211542889459`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.08223576360304381`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1195886893995742`"}], "+", 
    RowBox[{"0.1585066134302816`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.17513246488937134`"}], "-", 
    RowBox[{"0.07627084982723861`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1987713676305302`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.1907227668266888`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1518952342893062`"}], "-", 
    RowBox[{"0.15006864538733752`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.04687613334122416`"}], "+", 
    RowBox[{"0.3407914122140266`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.599073029276394`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.30016292989428467`"}], "+", 
    RowBox[{"0.0008421005105086674`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.29891009938210966`"}], "-", 
    RowBox[{"0.0008421005105084187`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.618476483502141`*^-17"}], "-", 
    RowBox[{"8.156811712440658`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"4.096078425171003`*^-17", "-", 
    RowBox[{"3.006828966376853`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.6728863236119714`*^-17", "+", 
    RowBox[{"1.274643248163885`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.176874807189512`*^-16"}], "+", 
    RowBox[{"4.1644364558263223`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.2118589348942374`*^-16"}], "+", 
    RowBox[{"4.649272523384075`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.2122847200667985`*^-16"}], "+", 
    RowBox[{"4.6506000744135335`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.808677759890518*^9, 3.8086790682424064`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evecs", "[", 
  RowBox[{"[", "maxIdx", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8086790870503807`*^9, 3.8086790909439955`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.08372103157275701`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.006078760630870871`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.04355318687214719`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.11955752803245372`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.12727421844490383`"}], "-", 
    RowBox[{"0.11347876740158311`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.2947211542889459`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.08223576360304381`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1195886893995742`"}], "+", 
    RowBox[{"0.1585066134302816`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.17513246488937134`"}], "-", 
    RowBox[{"0.07627084982723861`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1987713676305302`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.1907227668266888`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.1518952342893062`"}], "-", 
    RowBox[{"0.15006864538733752`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.04687613334122416`"}], "+", 
    RowBox[{"0.3407914122140266`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.599073029276394`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.30016292989428467`"}], "+", 
    RowBox[{"0.0008421005105086674`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.29891009938210966`"}], "-", 
    RowBox[{"0.0008421005105084187`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.618476483502141`*^-17"}], "-", 
    RowBox[{"8.156811712440658`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"4.096078425171003`*^-17", "-", 
    RowBox[{"3.006828966376853`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.6728863236119714`*^-17", "+", 
    RowBox[{"1.274643248163885`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.176874807189512`*^-16"}], "+", 
    RowBox[{"4.1644364558263223`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.2118589348942374`*^-16"}], "+", 
    RowBox[{"4.649272523384075`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.2122847200667985`*^-16"}], "+", 
    RowBox[{"4.6506000744135335`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2.9095664223082824`*^-19"}], "+", 
    RowBox[{"3.1877593031803056`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.037749026217359`*^-17", "-", 
    RowBox[{"2.3094137366646445`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "6.517500308602625`*^-18"}], "-", 
    RowBox[{"6.187961937684148`*^-18", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8086790913010454`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"evecs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "evecs", "]"}], "]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8086790940707645`*^9, 3.8086791147075024`*^9}, {
  3.8086792358308372`*^9, 3.8086792659329414`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7N9NXm51ZsJhe6iAAyqfw+ELCl/AocFnKqvB
4pP7IXwRh1oUvgQaX8bhBYp+BTS+EhpfBc18NTS+Bhpfy0F+EzPnNt6LUP06
aHw9NL6BQw2KfkM0vhEa39jhFYr7TND4pmh8M4dqFP3maHwLNL6lwwcU/VZo
fGs4HwBG9nt7
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7FWNJ7gur7xkDxVwUEHhc6DxBRzW9NQedI7c
sQfCF3GImb/m0p9J26B8CQcVH586/fO7oXwZB1mI/v0QvoKDNApfCY2v4pDE
cHs2dzVMvxoaXwONr+WwUrGM75r6RihfB42vh8Y3cJi2xNTt2+QlNhC+IRrf
CI1vjOY+EzS+KRrfzEHlnXTWJOOVUP3maHwLNL6lgzhK+Fqh8a3hfABLCnMG

      "]]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7NdKC02XMbiwHyrgsAmFz4HGF3BoVmm7Fxt4
yh7CF3FoQuFLOLSg8GUcpjJz2rxbdnAPhK/gkDGxpLb4934oXwmNr+JQiaJf
DY2vgcbXcvCfK/daS3gJVL8OGl8PjW8Acz/UP4ZofCM0vrHDyb+mwkcmboTq
N0Hjm6LxzRx6UfSbo/Et0PiWDvsh4Qv1jxUa3xrOBwDM83bs
      "]]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7BnUTv49fXSOPVTA4acqMp/DQRJFXsBhMXNC
o5HDcShfxGEZCl/CYRUKX8Zhpt+hByViF/ZD+AoOc1D4Smh8FQd37WlCcvxn
oXw1NL6GgysKX8shZ9YtfyavLhsIXweNr4fGN3DwhOiHus8QjW+Exjd2WABx
H5RvgsY3ReObwcIH6j5zNL4FGt/SwRYSvlC+FRrfGs4HAIDScgg=
      "]]}, 
    {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7GeFPZf1brpiDxVw6Efhc6DxBRxqrUtP3z96
BMoXcShB4Us41KDwZRwmCE9WmKq5bg+Er+BwsPLSl137uqB8JTS+ikMBin41
NL4GGl/LIeF4gsRrxsU2EL4OGl8PjW/gUAfRvx/CN0TjG6HxjR0Wn8x46j1x
E9R9Jmh8UzS+mUMVin5zNL4FGt/SYRIkfKF8KzS+NZwPAHL6iFo=
      "]]}, 
    {RGBColor[0.772079, 0.431554, 0.102387], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7L9KTo13ca62hwo4fJJC5nM4OEsj8wUcGrln
nDrVfBTKF3HoRuFLOHSh8GUcmqQi9BTrrkD5Cg5tKHwlhxYUvoqD137vmtb/
h/dD+GoO3ih8DQc/FL6WQ5P8ApHGA3NsIHwdNL4eGt/AIQSiH2qfIRrfCI1v
7NAAcR/UPhM0vika38xhIsT/UL45Gt8CjW/p8AUS3lC+FRrfGs4HAH/KdZg=

      "]]}, 
    {RGBColor[0.363898, 0.618501, 0.782349], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7Dez9x+55nViP1TAYQMKn8NhHQpfwMGrtU8l
/lUDlC/icACFL+Egh8KXcdiOol8Bja+ExldxcGpD1q+GxtdA42s5vPgewHj7
/C17CF8Hja+HxjdwUEDRb4jGN0LjGztsQXGfCRrfFI1v5rAXxf/maHwLNL6l
w24U/VZofGs4HwCvI4Z5
      "]]}, 
    {RGBColor[1, 0.75, 0], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7LMSbl6crXTAHirgkI7C53AoRuELOFT/mHWr
Re8klC/iUIzCl3CoQeHLOGSi6FdwyEHhK6HxVRzyUfSrofE10PhaDs8Sz3PN
rLwE5eug8fXQ+AZo+g3R+EZofGOHbBT3maDxTdH4Zg4ZKPrN0fgWaHxLtPC2
QuNbw/kAXIeDog==
      "]]}, 
    {RGBColor[0.647624, 0.37816, 0.614037], PointSize[0.0055000000000000005`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7FmD7ObOOrrNBirg8N02YHfPuxNQPofDgdn3
F0cy7IPyBRzkjSe4Lq+8ZA/hi6DxJRzkUPgyDm+/8e289+AoVL+CQ6/shNcr
mQ5C+UoOitUHXySVXIDyVRykIfr3Q/hqDlIofA0HCRS+lsMvn/6SdbkX90D4
Omh8PTS+AZr5hmh8IzS+sUN6i8YbiSc7oO4zQeObovHN0Pxvjsa3QONbOvzw
dimv6z4C1W+FxreG8wEQUnkU
      "]]}, 
    {RGBColor[0.571589, 0.586483, 0.], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7MUdRLbo/dy6Hyrg4Oamd/7WzDVQPofDrI1X
efmUD9lD+AIO8y2eVbl3XoHKizi0RPQtjj5yGCov4bBTwi7I2O8olC/j4Pnu
o529wASoegWHIz89ns15vwvKV3KIKWXdtubzPqh6FYf1dldzGZkeQPlqDtJr
so2aOC9A1Ws4LFpUG8T49TyUr+Vw46h7BYd9ng2Er+MQvnUNc7TBDChfz0Fs
1om3yxmmQvkGDoternX5Ed8A5Rs6TNlXviFlD4xv5NCkf3j3fDjf2MHiSSGv
plM/lG+CxjdF45s5dKX5tzKzZ0H55mh8CzS+pYOQ10zW+psNeyB8KzS+NZwP
AL8xcCU=
      "]]}, 
    {RGBColor[0.915, 0.3325, 0.2125], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7H96T8xr+flwP1TAISvO+Ch77lN7CJfDoWGy
wFapObuh8gIOPAd+RYTZHYLyRRympGUXecbPgaqXcEhaFhV6K2UvlC/jcI0p
os3TegdUvYKDdKPKlScTVkPllRy2t3RbrHu6BMpXcfiyWHr1G9HpUL6ag4ZM
jNCS6W1Q/RoOdjq3nU2ntEP5Wg5eN86L7n400QbC13E4/UN2/eEDrVC+nsN6
lYjpbErdUL6Bg/Us66/brs+B8g0dfCPP7bK9BuMbObS+ktslBOcbO8zJrKxa
O6sDyjdB45ui8c0c/rG6vZJfrLMHwjdH41ug8S0dMnzFFn04XwzVb4XGt4bz
AaVweJM=
      "]]}, 
    {RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7C+XrLg8X+ikPVTAYZV99habypv7IVwOh0Iu
vak378PkBRwyJ8799qzjOJQv4rB9V8fJpLrdUPUSDn/TNylnT94M5cs4PD1z
mvmoxn2oegWHgGlbXO8tOwuVV3LY1/jxQWjoBShfxUEkfc9u0+ZZUPVqDu8+
xTTxTmmHyms4nL4l/TW2qBfK13K4cEdLfevFpD0Qvo7D2QPVn08wdUP5eg4f
F869fNBvGpRv4LBxcXxyxa/FUL6hw5r8K487HsD4Rg6hr/3+Z8H5xg57/mnk
PkmusYHwTdD4pmh8MwfWM3/4tq6vgPLN0fgWaHxLB4F9U5VXbq6D8q3Q+NZw
PgBA5Ic9
      "]]}, 
    {RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
     PointSize[0.0055000000000000005`], AbsoluteThickness[1.6], 
     PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7B8snX5lb95We6iAw1eHxqJZPsugfA4HBeU3
ba1eB/ZD+AIOawWOy267cwkqL+LAFvzRNXbuPqi8hMOp8qkz9mYdg/JlHGKj
1oqGF56Eqldw4M29Mdm38DBUXskhamswuxrDCihfxSGVZ6rxbO3HUPVqDsyt
1yffM70MlddwODM56HK4Ioyv5fBm1V3dgOsz9kD4Og5zC5PX7pvTbgPh6zlk
+gad+36hDso3cLjqp3Pl2dcFUPWGDicnWKb/KFsI5Rs5RFkd7u6qgPGNHXSF
Zf8yV4hC+SZofFM0vpnDbOnZ3ULpE6H2maPxLdD4lg7q+gdnNvLFQfVbofGt
4XwAydh2FA==
      "]]}, 
    {RGBColor[0.736782672705901, 0.358, 0.5030266573755369], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7GcdDTBvkNq0HyrgoKCx/cC1mUfsIVwOh/4u
WS9dye1QeQGHN8K/XljyzYLyRRwetGxsSnv5CMqXcGgK/Rl4Y+djqH4Zhxrj
R6nmH3ZA+QoOL68e2iyfdhLKV3K4+j1ys+z7S1D9Kg69oVPv59xeA5VXc/Bd
euisrOwcqLyGw0XWjI+7Z86F8rUcLpxa+4hPcsYeCF/HIdHZ7Er4xsU2EL6e
w65jLDZ/tjZB5Q0c7gs/4zjuYwKVN3TYW2Qn07cqEipv5PAmwKtwK28UlG/s
UFTitLvTYipUvQka3xSNb+ZwhSdgj/KBbCjfHI1vgca3dFj57EbD4iv9UL4V
Gt8azgcAIct/vg==
      "]]}, 
    {RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7F+4/Lm1asHB/VABB6lfP6zKZl+2h3A5HPzW
f53lOO0oVF7AIfmDTOltbZh6EYdcXsuW5ElboXwJB5lyS3Per6eh+mUc2n/z
5My1vwPlKzisCBasFhG9BFWv5LDF//tDwdAjUL6KQ2/Nni8s1vugfDUHY7m3
axL/r4Pq13DYdavbZkXZWihfy8HRfcrHt6+b90D4Og4CmgdfC69dZAPh6zmU
iwVX5H2YCZU3cLDuyZ3g/agWyjd0cFjJ8CtBMQHKN3LYsYJ/Yta9OCjf2KE+
ur5P68ZEqHkmaHxTNL6Zw9Wz++K2vJ4C5Zuj8S3Q+JYOsiv8jL73dUD5Vmh8
azgfAIy/ft8=
      "]]}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7D+7L4/2s9u7HyrgsGGVXlin+iV7CJfDoXhj
Z93r9Ueh8gIO2RwxV5atOQHlizjUBr94aMF/AKpewuFo5vMnt602QvkyDluN
In5OmnkHyldw6EuM9Zyx9TJUv5KD3qKv8V+PH4TyVRz2rGCaUat/A8pXc1h0
f1/ogRfHofo1HK4Uut2yKjsB5Ws5OAvf53v+fvIeCF/HYfbtv+tuv5lqA+Hr
OTyYzX937cdmqLyBg5jePMfzn+uh8oYOXsq/5iy9Mw3KN3IINPu1cCnbdCjf
2MFUKXH/5OwGKN8EjW+Kxjdz+Okd11hoXQblm6PxLdD4lg5XznSUl7/ohvKt
0PjWcD4A8AqBaA==
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7J3sxE//vH9oP1TAYdafzIgjRsftIVwOh6Sf
XqZa3guh8gIODZuzhZIbD0D5Ig7HNyy+lPB4G1S9hENcTvqSU3ZLoHwZB+sj
tfeVfc5A+QoOs+Z8F4+WnQzVr+Qw9UJdTcWLk1C+isMjvl7J86q7oHw1h6sB
YT9SZO9C9Ws4KPB+Nvw4+RpUXstBUuPHkp2CcrYQvo6DyV3NxBf6onshfD2H
J+GZ0kkHGKF8A4ftkbPUlU//sIHwDR20z097sv7u0z0QvpFDsrVDdfm+F1C+
sYM9Y80apW3ToepN0PimaHwzBw454UXyS+qh+s3R+BZofEsHxXfrQhe8bIDq
t0LjW8P5AGzvd6E=
      "]]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7KWXW15/XPXbBirgcC5433YvB569EC6Hg8Pp
Gwt2Mf6Fygs47Cu5wLVDls0WwhdxOJR35uRMv497IHwJh/yb38ulz/2C8mUc
tlmsa1y1gQVqnoLDK7EDIW/auKD6lRxiv1+84Cn1HKpexWG6Zs2BcIG5UPvU
HF7sYd3mP1MAql/DYZFlzav1eQJQ/VoODqk1PyMZnu6H8HUcIt7PEmcveWYP
4es5RC588fCi1XKovIFDb0LDg4bOzVB5Q4dcMH8xVN7IYR4K39ihIWFzouvC
fKh7TBx09z5aefZgOtS9pg43Jz1YPIU/Gco3czB2cv1266QPlG+OxrdA41s6
VN7KvOrxJgFqvhUa3xrOBwAQb4JA
      "]]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7MM5P4Y3ff22ByrgsKbyRYbUZA5bCJfDYSHn
9oAY019QeQGHFXba3CKxzHshfBEHw+2CrIvmvbGB8CUczvX/iMwq+QHlyzgc
0HKNsXVjhJqn4BDidaJ7wnIOqH4lh38ztv49a/MWql7FYad+N+f+DVugfDWH
TpfV/3JuckH1azgERH+pupHLDdWv5WAQ/7dyDveB/RC+joPGokc2rNsfQ/l6
Dp9+Jka/2fncHsI3cMixvC/JvPsYVN7QoRPM3waVN3LwQOEbO7zVZO5+nHwQ
6n8TBy2xxdYlppug7jN18BITPLS1dSOUb+Ygf2WiSLBtNpRvjsa3QONbOjzM
mj/j4v5AqPlWaHxrOB8AZVN2hw==
      "]]}, 
    {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7GeJSX3dePzpHqiAg/yBpHdHrzHZQrgcDryZ
7l6Fe39B5QUcdBmCjzbu+wflizhsfPH5dfbkuzYQvoTDwamSOrsrv0P5Mg5b
PjKz5rB/hPIVHPav/NF17RrXXghfySEjfUqqcQjMPhUHzvshpclez6Hq1Rwy
3Pq9lzx6C+VrOFjvNTyVfAjmHi0H8/bPk1R6Vu6H8HUcHreeX7yg4gKUr+dw
5puumeqqy/YQvoFDue7zVWKfHkL5hg5FYP5FqHojhwoUvrGD9tE3vU/f7YTa
b+Jgv+yakPypZVD7TR16og4X/uBcB+WbOWx1P9V16WsulG+OxrdA41s6vA9Z
XBj7gAtqvhUa3xrOBwC1UoTb
      "]]}, 
    {RGBColor[0.772079, 0.431554, 0.102387], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7NP3PN51m2GRDVTA4YLA6vl63zbugXA5HH4e
+1X8YQlMXsBBUHPz1Cq1TVC+iIOW2xnmST8WQtVLOPiWvLghs3UBlC/jwO3/
aI9S6nooX8FBqmNT1a4LW6H6lRw0sgWWmNrMhcqrOHSlH7Ytm9kF5as5BJxr
/iyetA3K13B441Y4ZeHS7VD9Wg6HDvUZ/toSbA/h6zjw/RW5sFCwGcrXcyi4
6ibm2NG6H8I3cOiy21BeLRoE5Rs6TJ5no50w/RmUb+SwpuzHi6wFz6D6jR18
n25uq/+cAeWbOHzRf5o+L7UWqt7Uoc22e8m91wVQeTMHnhcKj3+uqYS619wh
8u66lAqbaijfwiH/+9bfyX+qoHxLh6XpC08vyNKF+scKjW8N5wMA03uBVg==

      "]]}, 
    {RGBColor[0.363898, 0.618501, 0.782349], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7Bc4HLFq35dtAxVwUNpzJtqVfwKUz+Ggtznr
+tOsqXsgfAGH0Kf/2kWmFUD5Ig6J0/bGiW2thqqXcJBIiw4KT+iC8mUc3pVt
S0n6PQWqXsEhlm3yz+R/y6B8JYe6SWkiudOWQNWrONQdLY0+9qwVyldz4C5a
8fzt/AVQ9RoO6eaVLidCiqDyWg6qgmZzXhlq2kP4Og5+W64xXZ8cvx/C13P4
+dF//czcGKi8gUOUXEv8lmfpUL6hw4TPgQ/W1UyH8o0cQsqdclorZ0H1Gzts
4rmXcJ73BVTexOGaiL+9YulNqLypQzdLblPtsmtQvpnD5fK3Uuydq6DuM3co
El8WP992DtT9Fg4dLxm7Z2ROg/ItHQxOc9hwTvWCqrdC41vD+QDqXnRp
      "]]}, 
    {RGBColor[1, 0.75, 0], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7AOCTpjN/Fy+ByrgsMFuz0Vn+W4bCJfDIfxU
frxIeTNUXsDB+ZCWlXTQFChfxOH4pL9LFRuaoOolHPg8s8r3z6+D8mUc6tr+
v1RorIfyFRwevGLeFm3VCdWv5GBgwverQqEFKq/ikOEXe2T+qTYoX81B8R2j
3a0/E6B8DYeWH5G367ZOh+rXcnjkEl0kvUR7P4Sv4/DhrZ3plFNBUL6ew7qw
rsXi9mH2EL6Bw3SVfRfXqBhA5Q0dDk/fI/t73y6ovJHDlJuvCq6t2wWVN3aI
atYy2vl3K5Rv4rAkuOCm3bSnUPWmDlbM2pvbrz2Cyps5yD/a0v+U8zHUfeYO
Jau28T5Yeh/qfgsH+YaLG4867YLyLR02NKdLpD5zhvKt0PjWcD4AALZ7cA==

      "]]}, 
    {RGBColor[0.647624, 0.37816, 0.614037], PointSize[0.0055000000000000005`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7DNv3DgYdqDQEirgYMZReMT3YbUNhMvhwPZa
KnHn0Zo9EL6AQ9xUXvcNUfVQeRGHW3MsFR2tWqHyEg4cLUt/lUlkQvkyDrlZ
FSwZxV1QvoKDtdSqRTobk6H6lRzSu+7Klf4pgsqrOCgySF5cbFoBlVdzyOdg
vrHMOgYqr+FQqtp/RvhVElRey6HmnsTOLx8nQeV1HD4slXffYjEBKq/n8O1s
XIr3nQYo38AhTsX2yUJdGN/Q4Y3f8lPHbuyE6jdycH/t8Yp5w2aovLHDCrET
P+b+3w6VN3Hg8p37dp7MfSjf1GF1kp3K1eePoOrNHOx0eAr2Kryyh/DNHfrA
/Fv7IXwLh5fayHxLB13zIJnj2WZQ/VYO2aG/LnuJRkP51nA+APINdTo=
      "]]}, 
    {RGBColor[0.571589, 0.586483, 0.], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7PXM2s49fxe9EyrgUH1rluYrA6s9EC6HQ8IN
sTOPHIptIHwBh/eWD4T77aKh8iIOlwTEzpz9CZOXcJjx/dqW1KoSKF/GQfun
g1SKWjmUr+Cgv/afiMymJqh+JYcv3sE1N70qoPIqDrs4mTln5ztA5dUcnC3f
nPx6phMqr+GQWSzOfvJ6AlRey8HyyiOGzNl5UL6Og/4aVc5uhUIoX89BSNyz
sN8UZr6Bw593Z6bnXiyA8g0dnjJ+e2Oalg9Vb+TArTZhxk+OZqi8sYO68gf9
MsODUHkTh7x5BzZcWHQUKm/qsPpKgWBH5HKovJnDdC7h6ZfXHNsP4Zs7iK3y
m+dq+QjKt3DYlSPcUvXkuT2Eb+kwLadYx9mrGarfysG0r2dqZEQG1HxrOB8A
SA12Mw==
      "]]}, 
    {RGBColor[0.915, 0.3325, 0.2125], PointSize[0.0055000000000000005`], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7APE7+ldTL1uARVwCNM3qmmWyrKBcDkcznoI
vtv4zmQPhC/g8PX/jc1CqUFQvohD3Ip78SEsCVD1Eg59Obe3BX9JhfJlHIwm
zXnfbpoM5Ss4WFVHKhcoGED5Sg6ec97o9ksYQc1Tcai+mxaVcDgOyldzuP/v
xCGRiEQoX8PBIyzHM/BcElS/loPHBpfE0kkJUHkdB//b3O0NuTB5PYeyduGf
OfOToPIGDv6WETfuNFRB5Q0dRP19BKv7YP41crCrTH3yur0Cqt7YYULSfB7+
S6VQeROHuekaLwOuKEHlTR12nm399LO4GMo3c2i4E2Sj0+9oD+GbO9T0K0uL
PjfdD+FbOEwJYtndlqcF5Vs6tL1ctnaHwiuoeiuHFjD/FlTe2qEVygcAh0R2
zQ==
      "]]}, 
    {RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], PointSize[
     0.0055000000000000005`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7F/Mu/v164M8U6iAg2DXjqDK1TF7IFwOhxu/
JyU0OcXZQPgCDhrK+T9KfihB5UUcjmsorvg4RR0qL+HAsTD36yYRH6i8jINp
+aNvs667QeUVHAqm8b911o6Dyis5TG3wqdDwM4PKqzgo7oq5FadnA5VXc7Dm
2TgxaJkrVF7DwURy3t8fHYZQvpbDPYWkwr385lC+jsNrt8O5W1dyQfXrOTiX
vWkLfcUIlTdwOP+5y+5ZiClU3tDhgqTVMsELgVB5I4e2zrfKMa7ZUL6xw983
5yrjGR2gfBOHsqlO+5h73aF8U4enpreuJQq5QPlmDkevhHZu+dcHNd/cQWDJ
P7snO7uh8hYOsyOOiU/KLoTyLR2mT7q2oGlVPlS9lcNZ6/q0eQue2UP41g5n
IPz9ACreeNU=
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 27.}, {-0.4257208866548876, 0.45712240849652475`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8086791057972665`*^9, 3.8086791151483603`*^9}, 
   3.8086792671215568`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Length", "[", "Hfull", "]"}]], "Input",
 CellChangeTimes->{{3.8087544750570526`*^9, 3.808754478787078*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "fmode", "]"}]], "Input",
 CellChangeTimes->{{3.808754516120101*^9, 3.8087545215615344`*^9}}],

Cell[BoxData["243"], "Output",
 CellChangeTimes->{3.8087545218357477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"9", "*", "9", "*", "3"}]], "Input",
 CellChangeTimes->{{3.808754482945957*^9, 3.8087544857355385`*^9}}],

Cell[BoxData["243"], "Output",
 CellChangeTimes->{{3.8087544792727747`*^9, 3.808754486007778*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "fmode", "]"}]], "Input",
 CellChangeTimes->{{3.80868255813274*^9, 3.8086825594904966`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7NN+/btbq33OHirgwIACOByg8vshfAEHVPUi
aOol0NTLoKlXQFOvhKZeBU29Gpp6DTT1WmjqddDU66GpN0BTb4im3ghNvTGa
ehM09aZo6s3Q1JujqbdAU2+Jpt4KTb01XD0AZI9q8g==
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 27.}, {-0.23570226039551584`, 0.23570226039551584`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.8086825599572716`*^9, 3.8086827199165187`*^9, 
  3.8086827750540495`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"Re", "[", 
     RowBox[{"evecs", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "evecs", "]"}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8086794467195287`*^9, 3.8086794549287157`*^9}, {
  3.808679891224814*^9, 3.8086799280244446`*^9}, {3.8086817070627575`*^9, 
  3.8086817098893204`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
      15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 
      33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
      51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
      69, 70, 71, 72, 73, 74, 75}}}, Typeset`size$$ = {450., {128., 133.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`i$1151$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$1151$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ListPlot[
        Re[
         Part[$CellContext`evecs, $CellContext`i$$]]], 
      "Specifications" :> {{$CellContext`i$$, {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 
         28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 
         45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 
         62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75}}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{511., {186., 193.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.8086794558063912`*^9, {3.8086799111925316`*^9, 3.8086799309737215`*^9}, 
   3.8087545685568647`*^9, 3.808755575518808*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"overlap", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", 
    RowBox[{"i", "<", 
     RowBox[{
      RowBox[{"Length", "[", "evecs", "]"}], "+", "1"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"overlap", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{"fmode", ".", 
          RowBox[{"evecs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sorted", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"overlap", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ">", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"maxIdx", " ", "=", " ", 
  RowBox[{"sorted", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8086820148503127`*^9, 3.8086820184062595`*^9}, {
  3.8086820909972963`*^9, 3.8086821193243895`*^9}, {3.8086821962190833`*^9, 
  3.8086822134104204`*^9}, {3.8086824022747197`*^9, 3.8086824064876385`*^9}}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.8086820189330797`*^9, 3.8086822158071737`*^9, 
  3.808682407653258*^9, 3.808682727008562*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"fmode", ".", 
   RowBox[{"evecs", "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808682254340369*^9, 3.808682270035014*^9}, {
  3.8086823168441067`*^9, 3.808682319895033*^9}, {3.8086824143486567`*^9, 
  3.8086824156917744`*^9}}],

Cell[BoxData["0.7812635105566526`"], "Output",
 CellChangeTimes->{{3.8086822553442793`*^9, 3.808682270479822*^9}, 
   3.8086823202741184`*^9, 3.808682416270314*^9, 3.808682597052067*^9, 
   3.808682729873905*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sorted", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8086823462397366`*^9, 3.808682354879644*^9}, {
  3.808682608707913*^9, 3.8086826152323656`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "0.9568484777596488`"}], "}"}]], "Output",
 CellChangeTimes->{{3.808682349037287*^9, 3.808682355255683*^9}, {
  3.808682610220866*^9, 3.808682615590801*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"sorted", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "overlap", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8086821222075586`*^9, 3.808682188587579*^9}, {
  3.80868222367203*^9, 3.8086822243132772`*^9}, {3.8086826357762103`*^9, 
  3.808682638491536*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEKDilHckJlGF7aQ/gyDusee/VsdzoL5Ws4mLud
S82YcwLKV3FYbHXm86MkGN/cwexs+ekPdcehfDUHFfF/UTwRx6B8Qwd1Az+n
io1HoXxrh5BQEIDxTR2iIm+be9jD+EYOzDlytutZj0D5Jg5vf+/qtd50GMq3
dCjuMSyZ5X0IyjdwSLu/LLBu7QEoX8th0r5n/NFpML6xw8qDrpunXtwP5Zs5
vNkntCTs8G4o38rBNdTyStLyHVC+hcN0lwMxJotgfB0H7Z+FV9/7boTy9Rxk
e74uPnpyJZT/wT4iI8ZX0XYJlK/k0O33mUP07CkbCJ/DYc/9fQrT9h+E8hkc
ZqrNvrpDYw2UL+DAqGV0U6R1GZQv4aDj9Mmgz2cxlC/iYGP+tqN81UIbAIIW
dXQ=
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.59375, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{1., 27.}, {0, 0.7812635105566526}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.808682157163379*^9, 3.808682170346114*^9}, 
   3.8086822246683235`*^9, 3.80868242139353*^9, {3.8086826232985573`*^9, 
   3.808682638898449*^9}, 3.8086827323373213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fmode", ".", 
  RowBox[{"evecs", "[", 
   RowBox[{"[", "13", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8086820460426154`*^9, 3.8086820591993265`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2.9956038303900513`*^-19"}], "-", 
  RowBox[{"7.433147186851402`*^-17", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.8086820545766716`*^9, 3.8086820595414066`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Re", "[", 
  RowBox[{"evecs", "[", 
   RowBox[{"[", "i", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.808681718081306*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.15285637725824536`", ",", "0.15285637725824536`", ",", 
   "0.15285637725824552`", ",", 
   RowBox[{"-", "0.20029258988015286`"}], ",", 
   RowBox[{"-", "0.20029258988015278`"}], ",", 
   RowBox[{"-", "0.20029258988015278`"}], ",", "0.1528563772582452`", ",", 
   "0.1528563772582452`", ",", "0.1528563772582452`", ",", 
   RowBox[{"-", "0.20029258988015286`"}], ",", 
   RowBox[{"-", "0.20029258988015286`"}], ",", 
   RowBox[{"-", "0.20029258988015286`"}], ",", "0.26646185760799485`", ",", 
   "0.26646185760799485`", ",", "0.26646185760799485`", ",", 
   RowBox[{"-", "0.20029258988015275`"}], ",", 
   RowBox[{"-", "0.20029258988015275`"}], ",", 
   RowBox[{"-", "0.20029258988015275`"}], ",", "0.15285637725824525`", ",", 
   "0.15285637725824525`", ",", "0.15285637725824525`", ",", 
   RowBox[{"-", "0.20029258988015272`"}], ",", 
   RowBox[{"-", "0.20029258988015272`"}], ",", 
   RowBox[{"-", "0.20029258988015272`"}], ",", "0.1528563772582454`", ",", 
   "0.1528563772582454`", ",", "0.1528563772582454`"}], "}"}]], "Output",
 CellChangeTimes->{3.8086817197488427`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fmode", " ", "=", " ", 
  RowBox[{"unit", "[", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1"}], "}"}], "&"}], ",", "atomnum"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8086817513002353`*^9, 3.808681896175793*^9}, {
  3.8086827021352143`*^9, 3.8086827039213066`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"3", " ", 
     SqrtBox["2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.8086818974094915`*^9, 3.8086827051230884`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fmode", ".", 
  RowBox[{"evecs", "[", 
   RowBox[{"[", "8", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8086791442566295`*^9, 3.808679168466241*^9}, 
   3.8086819645026093`*^9}],

Cell[BoxData[
 RowBox[{"0.7447366552326555`", "\[VeryThinSpace]", "-", 
  RowBox[{"0.23609317499703714`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.8086819651618147`*^9, 3.8086827081938553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"evecs", "[", 
    RowBox[{"[", "maxIdx", "]"}], "]"}], "\[Conjugate]"}], ".", 
  RowBox[{"evecs", "[", 
   RowBox[{"[", "maxIdx", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.808679177466838*^9, 3.808679196179821*^9}}],

Cell[BoxData[
 RowBox[{"1.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.8086791539796143`*^9, 3.808679197149226*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fmode", ".", "fmode"}]], "Input",
 CellChangeTimes->{{3.808679477146677*^9, 3.808679480773508*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.808679481769322*^9, 3.808679817325801*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "fmode", "]"}]], "Input",
 CellChangeTimes->{{3.808677753204447*^9, 3.808677753884757*^9}, {
  3.808679078010309*^9, 3.808679082723993*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBmIQDQEf7NN+/btbq33OHirgwIACOByg8vshfAEHVPUi
aOol0NTLoKlXQFOvhKZeBU29Gpp6DTT1WmjqddDU66GpN0BTb4im3ghNvTGa
ehM09aZo6s3Q1JujqbdAU2+Jpt4KTb01XD0AZI9q8g==
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 27.}, {-0.23570226039551584`, 0.23570226039551584`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.808677734906184*^9, 3.8086777543522067`*^9}, 
   3.8086790831768055`*^9, 3.8086798243459544`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"evecs", "[", 
     RowBox[{"[", "i", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "evecs", "]"}], "]"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8086778053499575`*^9, 3.808677824435967*^9}, {
  3.808678837219039*^9, 3.8086788811564407`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{13., 0.2793073113826636}, {14., 0.2793073113826636}, {15., 
      0.2793073113826636}}]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.28867513459481303`}, {2., 0.2886751345948132}, {3., 
      0.2886751345948129}, {7., -0.28867513459481303`}, {
      8., -0.28867513459481303`}, {9., -0.28867513459481303`}, {
      19., -0.28867513459481287`}, {20., -0.28867513459481287`}, {
      21., -0.28867513459481287`}, {25., 0.2886751345948124}, {26., 
      0.2886751345948124}, {27., 0.2886751345948124}}]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{10., 0.24367841658179382`}, {11., 0.2436784165817937}, {12., 
      0.2436784165817937}, {16., -0.24367841658179376`}, {
      17., -0.24367841658179376`}, {18., -0.24367841658179376`}}]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{4., -0.24021809295604601`}, {5., -0.24021809295604607`}, {
      6., -0.24021809295604613`}, {10., -0.24021809295604654`}, {
      11., -0.24021809295604654`}, {12., -0.24021809295604654`}, {16., 
      0.24021809295604665`}, {17., 0.24021809295604665`}, {18., 
      0.24021809295604665`}, {22., 0.24021809295604593`}, {23., 
      0.24021809295604593`}, {24., 0.24021809295604593`}}]}, 
    {RGBColor[0.528488, 0.470624, 0.701351], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{13., 0.26828423660945233`}, {14., 0.26828423660945233`}, {15.,
       0.26828423660945233`}}]}, 
    {RGBColor[0.772079, 0.431554, 0.102387], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{7., 0.3345327055459254}, {8., 0.3345327055459252}, {9., 
      0.33453270554592557`}, {19., -0.3345327055459254}, {
      20., -0.3345327055459254}, {21., -0.3345327055459254}}]}, 
    {RGBColor[0.363898, 0.618501, 0.782349], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.33971968498584143`}, {2., 0.3397196849858417}, {3., 
      0.3397196849858415}, {25., -0.3397196849858416}, {
      26., -0.3397196849858416}, {27., -0.3397196849858416}}]}, 
    {RGBColor[1, 0.75, 0], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], 
     PointBox[{{13., 0.42221965616693596`}, {14., 0.42221965616693596`}, {15.,
       0.42221965616693596`}}]}, 
    {RGBColor[0.647624, 0.37816, 0.614037], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], 
     PointBox[{{4., 0.28867513459481314`}, {5., 0.28867513459481264`}, {6., 
      0.2886751345948129}, {10., -0.28867513459481303`}, {
      11., -0.28867513459481303`}, {12., -0.288675134594813}, {
      16., -0.288675134594813}, {17., -0.288675134594813}, {
      18., -0.288675134594813}, {22., 0.28867513459481275`}, {23., 
      0.28867513459481275`}, {24., 0.28867513459481275`}}]}, 
    {RGBColor[0.571589, 0.586483, 0.], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], PointBox[{{4., 0.5383285156825438}}]}, 
    {RGBColor[0.915, 0.3325, 0.2125], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], PointBox[{{7., 0.5658012365890402}}]}, 
    {RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], PointSize[
     0.012833333333333334`], AbsoluteThickness[1.6], 
     PointBox[{{1., 0.6159373885769786}}]}, 
    {RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
     PointSize[0.012833333333333334`], AbsoluteThickness[1.6], 
     PointBox[{{6., 0.5754701860109085}}]}, 
    {RGBColor[0.736782672705901, 0.358, 0.5030266573755369], PointSize[
     0.012833333333333334`], AbsoluteThickness[1.6], 
     PointBox[{{8., 0.5501721532917875}}]}, 
    {RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], PointSize[
     0.012833333333333334`], AbsoluteThickness[1.6], 
     PointBox[{{3., 0.49996091178980456`}}]}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{5., 0.582602681565586}}]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{12., 0.6998591497779203}}]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{13., 0.7948735233523827}}]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{15., 0.6242214485230512}}]}, 
    {RGBColor[0.528488, 0.470624, 0.701351], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{16., 0.8070514694191883}, {17., -0.4035257347095937}, {
      18., -0.40352573470959435`}}]}, 
    {RGBColor[0.772079, 0.431554, 0.102387], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{18., 0.7069282069569697}}]}, 
    {RGBColor[0.363898, 0.618501, 0.782349], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[{{19., 0.7630260530921733}}]}, 
    {RGBColor[1, 0.75, 0], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], PointBox[{{21., 0.763903622468189}}]}, 
    {RGBColor[0.647624, 0.37816, 0.614037], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], 
     PointBox[{{22., 0.8164965809277261}, {23., -0.4082482904638616}, {
      24., -0.40824829046386435`}}]}, 
    {RGBColor[0.571589, 0.586483, 0.], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], PointBox[{{23., 0.7083349972738773}}]}, 
    {RGBColor[0.915, 0.3325, 0.2125], PointSize[0.012833333333333334`], 
     AbsoluteThickness[1.6], 
     PointBox[{{25., 0.8164965298911111}, {26., -0.40824826494555533`}, {
      27., -0.40824826494555544`}}]}, 
    {RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], PointSize[
     0.012833333333333334`], AbsoluteThickness[1.6], 
     PointBox[{{26., 0.7071067811865477}, {
      27., -0.7071067811865475}}]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 1}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.808677815650424*^9, 3.8086778248139553`*^9}, 
   3.8086788496288643`*^9, 3.808678881588375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fmode", ".", 
  RowBox[{"Re", "[", 
   RowBox[{"evecs", "[", 
    RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.808677778354288*^9, 3.8086778012790537`*^9}}],

Cell[BoxData["0.9473232133330073`"], "Output",
 CellChangeTimes->{{3.8086777861695766`*^9, 3.8086778017309885`*^9}}]
}, Open  ]],

Cell[BoxData["\[Gamma]"], "Input",
 CellChangeTimes->{{3.8086767335939817`*^9, 3.8086767343468585`*^9}}],

Cell[BoxData[
 RowBox[{"Log10", "[", 
  RowBox[{"1.2201407406990124`*^-47", "/", "2.232298141701227`*^-28"}], "]"}]],\
 "Input",
 CellChangeTimes->{{3.808676749606765*^9, 3.8086767561363115`*^9}}],

Cell[BoxData[
 RowBox[{"-", "19.26234226919443`"}]], "Output",
 CellChangeTimes->{3.8086767568933134`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArrayReshape", "[", 
  RowBox[{
   RowBox[{"soln", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"soln", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.8086771496131015`*^9, 3.808677163269555*^9}, {
  3.808677265236551*^9, 3.808677308413988*^9}, {3.808677380748048*^9, 
  3.808677398434622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.1`", ",", "6.399153039192837`*^-16", ",", "0.15000000000000002`", ",", 
     RowBox[{"-", "2.0438143642229961`*^-16"}], ",", "0.2`", ",", 
     "1.1418056686958344`*^-16", ",", "0.25`", ",", 
     "5.2971536985584224`*^-17", ",", "0.3`", ",", "8.49044731186657`*^-33", 
     ",", "0.35`", ",", "4.254936636960862`*^-16", ",", 
     "0.39999999999999997`", ",", "1.3635050163620007`*^-16", ",", 
     "0.44999999999999996`", ",", 
     RowBox[{"-", "5.576392031856468`*^-16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.49999999999999994`", ",", 
     RowBox[{"-", "3.7265829813557636`*^-17"}], ",", "0.5499999999999999`", 
     ",", "2.1701273108178034`*^-16", ",", "0.6`", ",", 
     "1.3474559305100665`*^-16", ",", "0.65`", ",", 
     RowBox[{"-", "5.541721429670936`*^-34"}], ",", "0.7000000000000001`", 
     ",", 
     RowBox[{"-", "3.600542421738367`*^-32"}], ",", "0.7500000000000001`", 
     ",", 
     RowBox[{"-", "3.037998242832788`*^-32"}], ",", "0.8000000000000002`", 
     ",", 
     RowBox[{"-", "7.680002827837866`*^-16"}], ",", "0.8500000000000002`", 
     ",", 
     RowBox[{"-", "4.724355490416366`*^-33"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8086773990403466`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pts", ",", " ", "gamma"}], "}"}], " ", "=", " ", 
   RowBox[{"Transpose", "@", 
    RowBox[{"soln", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.808677327089044*^9, 3.8086773400256786`*^9}, {
  3.8086774412124567`*^9, 3.8086775003782663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"logdata", " ", "=", " ", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{"pts", ",", 
     RowBox[{"Log10", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{"gamma", "/", "\[Gamma]"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.808677502341014*^9, 3.8086775519293137`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "12.457370298955217`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15000000000000002`", ",", "11.961689249386406`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "11.70883999708304`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25`", ",", "11.375290376582972`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3`", ",", 
     RowBox[{"-", "4.4198216264491`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.35`", ",", "12.280140899381509`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.39999999999999997`", ",", "11.785904542333991`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.44999999999999996`", ",", "12.397601100236065`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.49999999999999994`", ",", "11.22255859856316`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5499999999999999`", ",", "11.987733014816925`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6`", ",", "11.780762372461236`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.65`", ",", 
     RowBox[{"-", "5.605107506772337`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", 
     RowBox[{"-", "3.7923842655621613`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7500000000000001`", ",", 
     RowBox[{"-", "3.8661646793921287`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8000000000000002`", ",", "12.5366091822176`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8500000000000002`", ",", 
     RowBox[{"-", "4.674409628487301`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8086775287148986`*^9, 3.808677552340208*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"soln", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8086774488709736`*^9, 3.8086774512875276`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1`", ",", "6.399153039192837`*^-16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.15000000000000002`", ",", 
     RowBox[{"-", "2.0438143642229961`*^-16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "1.1418056686958344`*^-16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.25`", ",", "5.2971536985584224`*^-17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3`", ",", "8.49044731186657`*^-33"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.35`", ",", "4.254936636960862`*^-16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.39999999999999997`", ",", "1.3635050163620007`*^-16"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.44999999999999996`", ",", 
     RowBox[{"-", "5.576392031856468`*^-16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.49999999999999994`", ",", 
     RowBox[{"-", "3.7265829813557636`*^-17"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5499999999999999`", ",", "2.1701273108178034`*^-16"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.6`", ",", "1.3474559305100665`*^-16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.65`", ",", 
     RowBox[{"-", "5.541721429670936`*^-34"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7000000000000001`", ",", 
     RowBox[{"-", "3.600542421738367`*^-32"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7500000000000001`", ",", 
     RowBox[{"-", "3.037998242832788`*^-32"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8000000000000002`", ",", 
     RowBox[{"-", "7.680002827837866`*^-16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.8500000000000002`", ",", 
     RowBox[{"-", "4.724355490416366`*^-33"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8086771639347734`*^9, {3.8086773279607897`*^9, 3.808677340396474*^9}, {
   3.808677424719446*^9, 3.8086774515886717`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"markers", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", " ", 
        RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Red", ",", 
        RowBox[{"Rectangle", "[", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Green", ",", " ", 
        RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colors", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Blue", ",", "Red", ",", "Green"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"lidx", "=", "1"}], ",", 
   RowBox[{"lidx", "<", 
    RowBox[{
     RowBox[{"Length", "[", "soln", "]"}], "+", "1"}]}], ",", 
   RowBox[{"lidx", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"plots", ",", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"logdata", " ", ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"modelist", "[", 
          RowBox[{"[", 
           RowBox[{"lidx", ",", "2"}], "]"}], "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"markers", "[", 
             RowBox[{"[", "lidx", "]"}], "]"}], ",", "0.02"}], "}"}]}], 
         "*)"}], 
        RowBox[{"Joined", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"colors", "[", 
          RowBox[{"[", "lidx", "]"}], "]"}]}]}], "]"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"plots", ",", 
   RowBox[{"PlotRange", "->", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", " ", "Large"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.806966605988142*^9, 3.8069668785025563`*^9}, {
   3.8069669094459763`*^9, 3.8069669488841476`*^9}, {3.806967026112821*^9, 
   3.8069671494877334`*^9}, {3.8069671797051277`*^9, 
   3.8069672856823015`*^9}, {3.8069683696733265`*^9, 
   3.8069683861487656`*^9}, {3.806970990567198*^9, 3.80697099134589*^9}, {
   3.806971040492061*^9, 3.806971046639067*^9}, {3.8070116081394787`*^9, 
   3.807011633961431*^9}, {3.8072066777131057`*^9, 3.8072067642169304`*^9}, 
   3.8072190529009857`*^9, {3.808068659764369*^9, 3.8080686734411545`*^9}, {
   3.8080687755233097`*^9, 3.8080687791107416`*^9}, {3.8081780872156944`*^9, 
   3.808178088685889*^9}, {3.8081783122117805`*^9, 3.808178346181322*^9}, {
   3.8081783893557816`*^9, 3.8081783924068155`*^9}, {3.808677129275464*^9, 
   3.808677143611243*^9}, {3.8086775677448597`*^9, 3.8086776386191435`*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         AbsoluteThickness[1.6], 
         RGBColor[0, 0, 1]], 
        PointBox[{{0.1, 12.457370298955217`}, {0.15000000000000002`, 
         11.961689249386406`}, {0.2, 11.70883999708304}, {0.25, 
         11.375290376582972`}, {0.3, -4.4198216264491}, {0.35, 
         12.280140899381509`}, {0.39999999999999997`, 11.785904542333991`}, {
         0.44999999999999996`, 12.397601100236065`}, {0.49999999999999994`, 
         11.22255859856316}, {0.5499999999999999, 11.987733014816925`}, {0.6, 
         11.780762372461236`}, {0.65, -5.605107506772337}, {
         0.7000000000000001, -3.7923842655621613`}, {
         0.7500000000000001, -3.8661646793921287`}, {0.8000000000000002, 
         12.5366091822176}, {
         0.8500000000000002, -4.674409628487301}}]}, {}}}, {}, {}, {{}, {}}}, \
{PlotRange -> All, ImageSize -> Large, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 0.8500000000000002}, {-5.605107506772337, 
       12.5366091822176}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 0.8500000000000002}, {-5.605107506772337, 
       12.5366091822176}}, PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox["\"Ferromagnetic\"", TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.806967258061098*^9, 3.8069672871023836`*^9}, 
   3.8069683758333592`*^9, 3.8069709947451887`*^9, 3.806971047793018*^9, 
   3.8070115445564775`*^9, 3.8070116354314995`*^9, 3.807182115211413*^9, 
   3.807206638203826*^9, 3.8072066916246386`*^9, {3.807206758861227*^9, 
   3.8072067647734404`*^9}, 3.8080679823767157`*^9, 3.8080686324955473`*^9, {
   3.8080686661926236`*^9, 3.808068673995758*^9}, {3.80806875272583*^9, 
   3.808068779799876*^9}, {3.8081780711456804`*^9, 3.808178089467665*^9}, 
   3.8081782698114147`*^9, {3.8081783176695805`*^9, 3.8081783470189447`*^9}, 
   3.8081784101389456`*^9, 3.8085063587760344`*^9, 3.808669489076524*^9, 
   3.808677640407056*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Log10", "[", 
   FractionBox["1", 
    SuperscriptBox["31", "6"]], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8081785726386523`*^9, 3.808178601730525*^9}}],

Cell[BoxData[
 RowBox[{"-", "8.948170163005633`"}]], "Output",
 CellChangeTimes->{{3.8081785880934057`*^9, 3.8081786043245783`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Log10", "[", 
  FractionBox["1", 
   SuperscriptBox["3", 
    RowBox[{"2", "*", ".9"}]]], "]"}]], "Input",
 CellChangeTimes->{{3.8081786454093547`*^9, 3.8081786853933163`*^9}, 
   3.808178731210154*^9}],

Cell[BoxData[
 RowBox[{"-", "0.8588182584953924`"}]], "Output",
 CellChangeTimes->{3.8081786875295987`*^9, 3.8081787317964535`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Log10", "[", 
    FractionBox["3", 
     RowBox[{"4", "\[Pi]", " ", 
      SuperscriptBox["d", "2"]}]], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0.02", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "5"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8072118624029236`*^9, 3.807211974834529*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
     1.], LineBox[CompressedData["
1:eJwVznk81PkfwHEzhtrFRn6u+JkOaX7yI7FFyvsrlUL0EEOySNmE3K2ldXSh
ZSmh60GOQRiUeygfszSp3Pc4xvF1jetLuUaD3/7+eD2e/772uPpYu5FFREQC
/un/ppJNX42GJEKD1V3qop441jmypFTwKREeRbZfct8ljv3AzkgMUkwCFb6G
h4mIOBYYvvlQsjwJuhylXio1iWFmwrLAI4vJEDhRUiT0EMNWl9XM/rz+HK5/
3JzLLKNgml3t9Tblz0GscrfwaBoFcy2NAKrYC7DZbWsuFUPBmv0H9EozXkD4
5z1Pb12hYAziCZU3+BJ2/+JKk5OhYBf45GUdm1RQFWbHBYWIYpENb3yEGakQ
NVcce8ddFKvOcZrmLKaCVPx8BIsuiqn/WjV0Of4VKPYdKirSFcXCFvXHT7ql
QXqCv1kKQcZsvBdavNLSQWX/56E2bzJGcnfOqpVnwLzCu06DSBJWOxin+5sx
AxJ9r8XeCyJhYRdr2Ae9GEBPbKDNupOwdaN/85LZDDguQ5VWtCBhX+X65W96
ZYHvhTunmmRJ2FgdPVrp72zQvmqSZP5aBGugWnr638wF30pNZ1HOFkQmhQoO
PMuFbtKQOircglMSBVGDf+dC6VJQevrTLWCvSDDOKubBa+Mjxb03tqCq6dOA
al0eOFpoDpCktyD/9mnLL4pMkM8KcR9w3YS4nuM6avWFIHt0wXaVugGtlXK6
YrOFUMvcFrAltQE7X8zrTcgWwdvK2AJVoRCSHNP0X18tAl+DHfHpvUJoXiDt
Tia9AZoFm12cIITuW24HdqW/gTStyPCOH4UwHq55ZO/wW0iXS9Ng/fAdRBOr
Lh52KgV68Gk7GwMBRPDtS2r8SoHbVaNO0RTAptHqTvMHpSAjEOTVqgpgja/b
fpVZCpb/uejnTBHAPBRcSFovBWFJwRWd1jXom3l1fi25DIxDW8RkPdbgjckD
05qWcshwIu8zzF4Fx29WhmbGLNiuc3+nzvEVmIlxqAujs8ARKVf/eWgFQtTc
zEs8WRBXEUOdV1uBZ7Yhl1WSWWB/zqS/TWoFuioYt+enWVBQMXdFYngZLP8Q
VCckVkHgWMpZg8hlwMQyj/dPVoNWQEK6CncJ9imsnPCKqwEORYp3JvkbvOka
cwirZUOUYfRrp4hFoJDtGF+868E+Y0fLqgIBk5/E6hOlPwJfpqSvjTUDFDNz
VbkHnwBTYMrIT0+BvaZS5AutRrAjXOjbaBMwyQml9eQ1Q1nE0BKzGYe7YfGt
pn+1wgd5t5SywhFgmjGeZA+1QaJn1ZSC4hAs+VOWXJQ74Fqu/4ko136wa6T1
p/h1QpCzWY5KWg/cCfAseMbugkM+HT/nanTCp98EKsR6N4ic9uCxqW2gmW8u
22DZC9Ff732QIjUC05CfLYzhAnW7L3M9mANnN8zYJXgfXL6RfVa1oRbyJb9w
aD8PAFlPNWN2phwO/p58Q+AzCBTSe7/8wTz4+C/1JxYfeDCgV3cU8mKhNlKk
YIM0DAGyezK3LSYiEY0NMb3UYVhQgtR05XzUPH45I990BAaNypWvnShH+VYu
Um3jI3BE6Qx3VLIGybVzqo8+HoVjXhPyNcp16Ortd86hBjhkD77enBZwEGq3
a/ftxsH4v/QTXkGfUe5J2+isiDGYUDepKd7TjDJc1iSjqeMQ6TpgirFaUViW
RtS56nE4GDer7Xi+HU2R0SmLaxPQtTNaz3i1A135SdAqJE2Cz8NT2v7BXej6
4aS0eeYkhOfqkJ5K96A/KD1GcRZT4HGA7Bh9txfd2shpl+RPQbVey4jqGBd9
/6k/tzGBD9I3fzyzfqkfPWousTqmMw2Z0gvIuHAAlWTP6/MHpiHFqTtBQp6H
WFmVCkEPZuCR8XtvhvcQaramfSjeOwtI+/uck80w8lNcL9NumgVPPz+RrvVh
tDfW75aD1xzQfvWhNSWMoAr13zWubZ8HnmdvfLHaKOrjDu8tejsPevur+plo
FEkYEvwcKwK2CoPvW57HETlGxeyGNQESdLGEWiscrfWdy9OwJaDxSYT7YWsc
jYUwPAocCNCP9fKVs8PRu6pLM8VuBNgQtLleFxx5HauffX+bgP3UVxm2gThq
MnhOdOQQcFPUAVN/iaP6hxyrpDwCvE96hD1OwVEV91sRvYCA+zIvI4WvcJQd
bOnLLSZgoPfechsDR2Es0UXeewL624IsQwpxpGXg/ZXfQYB6+o7lWjaO1B6+
tM7vJsBdNJpLq8fRLm5DsReXgApUFv2IgyPx4H0BBI+ATDW6qfMXHPEqe78t
8QngaDLPrHfiqHO7uE35LAFuG613XHpw9NletzSIIMA6eymKw8VR+dpfgetL
BEjL/rL8mIcj5tnqzupVAlaVSh1Xh3GU8WxKL3SdAHq4VrwjjqNnU3JJRhsE
dDh1xbLHcRSvb7K8tfXPT9tbW/UpHP0Pr0+8Vg==
      "]]}}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.2}, {-5, 3}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 0}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.807211929888115*^9, 3.8072119750909085`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["radiation in the time domain", "Section",
 CellChangeTimes->{{3.8072191650127316`*^9, 3.807219170191807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"initialize", " ", "the", " ", "state", " ", 
     RowBox[{"vector", ".", " ", "excite"}], " ", "central", " ", "9", " ", 
     "atoms", " ", "in", " ", "m"}], "=", 
    RowBox[{"0", " ", "states"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"state", " ", "=", " ", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["b", "##"], "&"}], ",", "dim"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"excitedIdcs", " ", "=", " ", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"deg", "*", "atomnum"}], "-", "1"}], "2"], "+", 
         RowBox[{"deg", "*", 
          SqrtBox["atomnum"], " ", "i"}], "+", 
         RowBox[{"deg", " ", "j"}], "-", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"state", "[", 
      RowBox[{"[", "excitedIdcs", "]"}], "]"}], "=", "1"}], ";"}], " ", 
   "*)"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["tests", "Section",
 CellChangeTimes->{{3.8067085522849584`*^9, 3.806708562119661*^9}}],

Cell["\<\
pick out element from G depending on the dressing polarization of atoms i,j. \
Ferromagnetic:\
\>", "Text",
 CellChangeTimes->{{3.8072182223730817`*^9, 3.8072182246347685`*^9}, {
  3.807218318957305*^9, 3.8072183713810096`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "i", "]"}]], "Input",
 CellChangeTimes->{{3.807218473024479*^9, 3.8072184824784236`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e", "[", "k_", "]"}], ":=", 
  SubscriptBox["e", "1"], 
  RowBox[{"(*", 
   RowBox[{"k", " ", "is", " ", "the", " ", "atom", " ", "number"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.807218376113436*^9, 3.8072183818910475`*^9}, {
   3.807218412346057*^9, 3.8072185139425883`*^9}, {3.80721856995821*^9, 
   3.8072185706203938`*^9}, 3.8072186045658665`*^9, {3.807218662060046*^9, 
   3.8072186767719126`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.807218516741705*^9, 3.807218519254943*^9}, {
  3.807218576707239*^9, 3.807218576816016*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8072185218935156`*^9, {3.8072185732820187`*^9, 3.807218607049359*^9}, 
   3.807218665596816*^9}]
}, Open  ]],

Cell["Anti-ferromagnetic:", "Text",
 CellChangeTimes->{{3.8072186228360834`*^9, 3.807218627780967*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e", "[", "k_", "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "k"], 
   SubscriptBox["e", "1"]}]}]], "Input",
 CellChangeTimes->{{3.8072186311851797`*^9, 3.807218692922546*^9}}],

Cell["In-plane:", "Text",
 CellChangeTimes->{{3.807218724098126*^9, 3.807218729986911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "k_", "]"}], ":=", 
   SubscriptBox["e", "2"]}], ";"}]], "Input",
 CellChangeTimes->{{3.8072187314062014`*^9, 3.807218738620578*^9}, {
  3.8072188400508375`*^9, 3.807218850443463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"duh", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"x", ",", 
    SuperscriptBox["x", "2"]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8072188963683653`*^9, 3.8072189078396273`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", 
   SuperscriptBox["x", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8072189031579723`*^9, 3.807218908399756*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8072189769403477`*^9, 3.807218977982123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], "=", 
  RowBox[{"duh", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8072189099218016`*^9, 3.807218976520224*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "x_", "]"}], "=", 
  RowBox[{"duh", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8072189975330105`*^9, 3.807219004746293*^9}}],

Cell[BoxData["x"], "Output",
 CellChangeTimes->{{3.80721898429687*^9, 3.8072190052501745`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.807218921197901*^9, 3.8072189270031567`*^9}, {
  3.8072190073024178`*^9, 3.807219007394373*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.8072189272181287`*^9, {3.807218961589218*^9, 3.807219007668685*^9}}]
}, Open  ]],

Cell["\<\
made a mistake in my polarization basis. no zeeman splitting, and \
ferro/anti-ferro states have x polarizations. use spherical basis for atomic \
states; need to work in Jz basis because this is good quantum number here. \
\>", "Text",
 CellChangeTimes->{{3.8069705690257435`*^9, 3.8069706658863373`*^9}, {
  3.807132252500268*^9, 3.8071324097138753`*^9}, {3.8072182121124315`*^9, 
  3.8072182192840557`*^9}}],

Cell[TextData[{
 "Px excitation is superposition of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"+", "1"}]}]], TraditionalForm]]],
 ". Likewise for Py.  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"X"},
     "Ket"], "=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], 
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{RowBox[{"-", "1"}]},
        "Ket"], "-", 
       TemplateBox[{RowBox[{"+", "1"}]},
        "Ket"]}], ")"}]}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"Y"},
     "Ket"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"-", "\[ImaginaryI]"}], 
      SqrtBox["2"]], 
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{RowBox[{"-", "1"}]},
        "Ket"], "+", 
       TemplateBox[{RowBox[{"+", "1"}]},
        "Ket"]}], ")"}]}]}], TraditionalForm]]],
 ". So with the basis {",
 Cell[BoxData[
  TemplateBox[{RowBox[{"-", "1"}]},
   "Ket"]]],
 ",",
 Cell[BoxData[
  TemplateBox[{RowBox[{"+", "1"}]},
   "Ket"]]],
 ",|0\[RightAngleBracket]}, the x,y,z states are:"
}], "Text",
 CellChangeTimes->{{3.807132426360362*^9, 3.8071324373788986`*^9}, {
  3.807132472320464*^9, 3.807132541291037*^9}, {3.807132594427947*^9, 
  3.8071326222455616`*^9}, {3.8071327615101657`*^9, 3.807132771182302*^9}, {
  3.8071328100204477`*^9, 3.807132903591238*^9}, {3.80713319821441*^9, 
  3.8071332218681593`*^9}, {3.8071332794621525`*^9, 3.8071332827074738`*^9}, {
  3.8071333814843416`*^9, 3.8071334284647155`*^9}, {3.8071334710348825`*^9, 
  3.8071334998021655`*^9}, {3.807133532090824*^9, 3.8071335784528527`*^9}, {
  3.8071336218238773`*^9, 3.8071336912731686`*^9}, {3.8071340951842575`*^9, 
  3.8071341092326927`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["esphr", "1"], "-", 
     SubscriptBox["esphr", "2"]}], ")"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"recover", " ", "x"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["esphr", "1"], "+", 
     SubscriptBox["esphr", "2"]}], ")"}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"recover", " ", "y"}], "*)"}]}], "\n", 
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0"}], "}"}], "\n", 
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "Input",
 CellChangeTimes->{{3.8071335294578643`*^9, 3.8071335300034075`*^9}, {
  3.8071339102745533`*^9, 3.8071340041277466`*^9}, {3.807134073429431*^9, 
  3.8071340866131773`*^9}, {3.8071363831023207`*^9, 3.807136410279177*^9}}],

Cell["Cross product expression for G*p:", "Text",
 CellChangeTimes->{{3.8085032985514975`*^9, 3.8085033118782406`*^9}, 
   3.808504416752344*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"d", ",", "\[Lambda]", ",", "k", ",", "\[Gamma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "10"}], ";", " ", 
  RowBox[{"j", " ", "=", " ", "10"}], ";", 
  RowBox[{"\[Mu]", "=", "1"}], ";", " ", 
  RowBox[{"\[Nu]", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"d", " ", "\[Lambda]", " ", 
    SubscriptBox["r", 
     RowBox[{"i", ",", "j"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gij", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
    RowBox[{"GdotP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}], ",", 
      RowBox[{"e", "[", "j", "]"}]}], " ", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], 
        SuperscriptBox["k", "3"]], 
       RowBox[{"Re", "[", "Gij", "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rx", " ", "\[Rule]", " ", 
         RowBox[{"u", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"ry", "\[Rule]", 
         RowBox[{"u", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
        RowBox[{"rz", "\[Rule]", " ", 
         RowBox[{"u", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], "  ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]\[Mu]\[Nu]ij", "=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], "&&", " ", 
         RowBox[{"\[Mu]", "\[Equal]", "\[Nu]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], 
           SuperscriptBox["k", "3"]], 
          RowBox[{"Im", "[", "Gij", "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rx", " ", "\[Rule]", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"ry", "\[Rule]", 
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
           RowBox[{"rz", "\[Rule]", " ", 
            RowBox[{"u", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], " ", ",", 
        RowBox[{"i", "\[NotEqual]", "j"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Gamma]", 
         SuperscriptBox["k", "2"]], ",", 
        RowBox[{"i", "\[Equal]", "j"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", ",", "\[Gamma]\[Mu]\[Nu]ij"}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Hfull", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"3", "i"}], "-", "1", "+", "\[Nu]"}], ",", 
        RowBox[{
         RowBox[{"3", "j"}], "-", "1", "+", "\[Mu]"}]}], "]"}], "]"}], "=", 
     " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalDelta]", 
        RowBox[{"2", "-", "\[Mu]"}]], 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"i", ",", "j"}], "]"}], 
       RowBox[{"KroneckerDelta", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
      RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "\[Gamma]\[Mu]\[Nu]ij"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.808503360587469*^9, 3.8085033810004005`*^9}, {
   3.808504435543336*^9, 3.808504459352911*^9}, {3.808504504769993*^9, 
   3.8085045693613143`*^9}, {3.8085048749204607`*^9, 
   3.8085048921852975`*^9}, {3.808504973890214*^9, 3.8085049780719953`*^9}, {
   3.8085051405024424`*^9, 3.8085052518678665`*^9}, {3.808505327701624*^9, 
   3.808505430010433*^9}, {3.808505530233368*^9, 3.8085056179353986`*^9}, {
   3.8085056501915197`*^9, 3.808505828008895*^9}, {3.808505869247547*^9, 
   3.808505879893098*^9}, 3.8085193429967985`*^9, {3.808519773173853*^9, 
   3.808519796192793*^9}, {3.808520224713136*^9, 3.8085202510559635`*^9}, {
   3.8085203112871885`*^9, 3.8085203712558794`*^9}, {3.808520401607708*^9, 
   3.808520471833541*^9}, {3.8085205282737827`*^9, 3.808520610892769*^9}, 
   3.8085206424364395`*^9, 3.808520911106373*^9, {3.8085216600398917`*^9, 
   3.8085218394932356`*^9}, {3.8085218801752114`*^9, 3.8085219224419837`*^9}, 
   3.8085737321284475`*^9, {3.8086641822832*^9, 3.8086641928481236`*^9}, {
   3.8086643256213217`*^9, 3.8086643401414127`*^9}, {3.8086643768865957`*^9, 
   3.80866438551757*^9}, {3.8086649036098394`*^9, 3.8086650105607395`*^9}, {
   3.80866510484888*^9, 3.8086651785377445`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["\[Gamma]", 
    SuperscriptBox["k", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.808664386267524*^9, {3.808664892150963*^9, 3.8086649143222876`*^9}, 
   3.8086649501432233`*^9, 3.8086649816759605`*^9, 3.8086650169865565`*^9, {
   3.8086651063666763`*^9, 3.8086651789057894`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.8086650605402346`*^9, 3.808665070189354*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8086650660334578`*^9, 3.808665070549388*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"k", " ", "=", " "}]], "Input",
 CellChangeTimes->{{3.808664990153287*^9, 3.8086649923614216`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gij", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
    RowBox[{"GdotP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rx", ",", "ry", ",", "rz"}], "}"}], ",", 
      RowBox[{"e", "[", "j", "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Gij", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rx", " ", "\[Rule]", " ", 
     RowBox[{"u", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ry", "\[Rule]", 
     RowBox[{"u", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], " ", ",", 
    RowBox[{"rz", "\[Rule]", " ", 
     RowBox[{"u", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.808664481462076*^9, {3.808664566160923*^9, 3.8086645878200316`*^9}, {
   3.8086646189976983`*^9, 3.808664651645958*^9}, 3.808664876267931*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "11194.234761936394`"}], "-", 
  RowBox[{"141687.47616267603`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.808664652145666*^9, 3.8086648784002542`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8086646454505463`*^9, 3.808664664881615*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "11194.234761936397`"}], ",", "33843.84413382672`", ",", 
   "33843.84413382672`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8086646276405525`*^9, 3.808664637369547*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", ",", "\[Gamma]\[Mu]\[Nu]ij"}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.8086643425908413`*^9, 3.8086643628152456`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "8.545072922384079`*^-10"}], ",", "2.5834558792773075`*^-9",
      ",", "2.5834558792773075`*^-9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0815655038033065`*^-8"}], ",", 
     RowBox[{"-", "2.3469238364432947`*^-10"}], ",", 
     RowBox[{"-", "2.3469238364432947`*^-10"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.808664363172341*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "[", "j_", "]"}], ":=", 
  SubscriptBox["e", "1"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"period", " ", "=", " ", 
   RowBox[{"0.5", " ", "\[Lambda]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "2"}], ";", 
  RowBox[{"\[Nu]", "=", "2"}], ";", 
  RowBox[{"i", "=", "2"}], ";", 
  RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{"d", " ", "\[Lambda]", " ", 
     SubscriptBox["r", 
      RowBox[{"i", ",", "j"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rhat", " ", "=", " ", 
     RowBox[{"unit", "[", 
      SubscriptBox["r", 
       RowBox[{"i", ",", "j"}]], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8085742129335823`*^9, 3.808574263646336*^9}, {
   3.8085743017934275`*^9, 3.8085743025821347`*^9}, {3.808574352493675*^9, 
   3.8085744222416697`*^9}, {3.808574489866373*^9, 3.8085745362002745`*^9}, {
   3.808574596154747*^9, 3.8085746531136284`*^9}, 3.808574934931218*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComplexExpand", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
   RowBox[{"GdotP", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"e", "[", "j", "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808574955448227*^9, 3.808575083142727*^9}, {
  3.8085763628792367`*^9, 3.808576430148181*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2.4527291936448207`*^-15", " ", 
    SqrtBox[
     SuperscriptBox["x", "2"]], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"8.055365778435368`*^6", " ", 
      SqrtBox[
       SuperscriptBox["x", "2"]]}], "]"}]}], 
   SuperscriptBox["x", "4"]], "+", 
  FractionBox[
   RowBox[{"1.9757630810255867`*^-8", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"8.055365778435368`*^6", " ", 
      SqrtBox[
       SuperscriptBox["x", "2"]]}], "]"}]}], 
   SuperscriptBox["x", "2"]], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"1.9757630810255867`*^-8", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"8.055365778435368`*^6", " ", 
          SqrtBox[
           SuperscriptBox["x", "2"]]}], "]"}]}], 
       SuperscriptBox["x", "2"]]}], "+", 
     FractionBox[
      RowBox[{"2.4527291936448207`*^-15", " ", 
       SqrtBox[
        SuperscriptBox["x", "2"]], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"8.055365778435368`*^6", " ", 
         SqrtBox[
          SuperscriptBox["x", "2"]]}], "]"}]}], 
      SuperscriptBox["x", "4"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8085763745427823`*^9, 3.8085764321556044`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"3", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "/.", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", " ", 
   SubscriptBox["unit", 
    RowBox[{"i", ",", "j"}]]}]}]], "Input",
 CellChangeTimes->{{3.808521525077567*^9, 3.8085216236119967`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3", " ", "x"}], ",", 
   RowBox[{"3", " ", "y"}], ",", 
   RowBox[{"3", " ", "z"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8085215862634788`*^9, {3.8085216188327265`*^9, 3.8085216240596423`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
   RowBox[{"GdotP", "[", 
    RowBox[{
     RowBox[{"nhat", "[", 
      RowBox[{"[", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "j", "]"}], "matelem"}]}], " ", "]"}]}], "/.", 
  RowBox[{
   RowBox[{"nhat", "[", 
    RowBox[{"[", "]"}], "]"}], " ", "\[Rule]", "  ", 
   RowBox[{"unit", "[", 
    SubscriptBox["r", 
     RowBox[{"i", ",", "j"}]], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8085208605127945`*^9, 3.808520888353305*^9}, {
  3.8085212576795144`*^9, 3.808521262333093*^9}, {3.8085213070302763`*^9, 
  3.808521313110072*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.6343357228337218`*^-37", "+", 
    RowBox[{"3.3365223945517654`*^-38", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.171678614168609`*^-38"}], "-", 
    RowBox[{"1.6682611972758827`*^-38", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.171678614168609`*^-38"}], "-", 
    RowBox[{"1.6682611972758827`*^-38", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8085208623091707`*^9, 3.808520891650981*^9}, 
   3.8085212628594327`*^9, {3.8085213084950304`*^9, 3.8085213137597375`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
  RowBox[{"GdotP", "[", 
   RowBox[{
    RowBox[{"unit", "[", 
     SubscriptBox["r", 
      RowBox[{"i", ",", "j"}]], "]"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "j", "]"}], "matelem"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{3.8085212451911135`*^9}],

Cell[BoxData[
 RowBox[{"1.6343357228337218`*^-37", "+", 
  RowBox[{"3.3365223945517654`*^-38", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.8085212476579723`*^9, 3.8085212662598867`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unit", "[", 
  SubscriptBox["r", 
   RowBox[{"i", ",", "j"}]], "]"}]], "Input",
 CellChangeTimes->{{3.8085207812861233`*^9, 3.8085208052921557`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8085208057713704`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "1", "]"}], ".", "Gij"}], "/.", 
  RowBox[{"nhat", "\[Rule]", " ", 
   SubscriptBox["r", 
    RowBox[{"1", ",", "2"}]]}]}]], "Input",
 CellChangeTimes->{{3.8085206580594316`*^9, 3.8085206700665083`*^9}, {
  3.80852073838618*^9, 3.80852074446512*^9}, {3.808520785037217*^9, 
  3.8085207885141525`*^9}}],

Cell[BoxData[
 RowBox[{"1.6343357228337218`*^-37", "+", 
  RowBox[{"3.3365223945517654`*^-38", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.8085206589375343`*^9, 3.8085206705020924`*^9}, 
   3.8085207451582975`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GdotP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"rx", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808519410078174*^9, 3.8085194694934626`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        SuperscriptBox["rx", "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{"py", "-", 
       RowBox[{"py", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            SuperscriptBox["rx", "2"]}]], "-", 
          FractionBox["\[ImaginaryI]", 
           RowBox[{"k", " ", 
            SqrtBox[
             SuperscriptBox["rx", "2"]]}]]}], ")"}]}]}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SqrtBox[
      SuperscriptBox["rx", "2"]]}]], ",", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "k", " ", 
       SqrtBox[
        SuperscriptBox["rx", "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{"pz", "-", 
       RowBox[{"pz", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            SuperscriptBox["rx", "2"]}]], "-", 
          FractionBox["\[ImaginaryI]", 
           RowBox[{"k", " ", 
            SqrtBox[
             SuperscriptBox["rx", "2"]]}]]}], ")"}]}]}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SqrtBox[
      SuperscriptBox["rx", "2"]]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.808519429628251*^9, 3.8085194704695253`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Im", "[", 
    RowBox[{"GdotP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"x", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8085194800450277`*^9, 3.8085195086249895`*^9}, {
  3.8085195740078773`*^9, 3.808519630575795*^9}, {3.8085198525674815`*^9, 
  3.80851998603854*^9}, {3.808520017123431*^9, 3.808520076075248*^9}, {
  3.80852015662908*^9, 3.8085202003481183`*^9}, {3.8085202629302373`*^9, 
  3.808520286486987*^9}, {3.808520485799205*^9, 3.808520487363611*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"427350.4273504274`", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.808519986722577*^9, {3.8085200187172484`*^9, 3.8085200765301514`*^9}, {
   3.8085201527600327`*^9, 3.8085202013116283`*^9}, {3.8085202640965776`*^9, 
   3.808520286983735*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.808519956568185*^9, 3.8085199644430556`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "27688.870160516664`"}], "+", 
    RowBox[{"72713.74820928033`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"4610.486775056376`", "\[VeryThinSpace]", "-", 
    RowBox[{"6568.792086595198`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8085194864851017`*^9, 3.8085195100609255`*^9}, {
   3.8085195649192853`*^9, 3.8085196308735714`*^9}, 3.808519860517461*^9, {
   3.808519904750622*^9, 3.8085199469437885`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
  RowBox[{"GdotP", "[", 
   RowBox[{"u", ",", 
    RowBox[{
     RowBox[{"e", "[", "j", "]"}], "matelem"}]}], " ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.808505858604048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", 
    RowBox[{"GdotP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "j", "]"}], "matelem"}]}], " ", "]"}]}], ",", 
   RowBox[{"x", "\[Rule]", " ", "0"}]}], "]"}]], "Input"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.8085057468990602`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"GdotP", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "j", "]"}], "matelem"}]}], " ", "]"}], ",", 
   RowBox[{"x", "\[Rule]", " ", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.808504671901643*^9, 3.8085047848293614`*^9}, {
  3.80850503634097*^9, 3.8085050417983537`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.808504460316269*^9, 3.808504532829954*^9, 3.808504583766158*^9, {
   3.8085046431801662`*^9, 3.808504655485555*^9}, {3.8085047324285927`*^9, 
   3.8085047522475786`*^9}, 3.808504785412903*^9, 3.808504916303697*^9, 
   3.8085049850918036`*^9, 3.808505042189314*^9}]
}, Open  ]],

Cell["Derivative expr. for G", "Text",
 CellChangeTimes->{{3.8085033304574986`*^9, 3.8085033371881175`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "[", "k_", "]"}], ":=", 
  SubscriptBox["e", "1"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"period", " ", "=", " ", 
   RowBox[{"0.5", " ", "\[Lambda]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", "1"}], ";", 
  RowBox[{"\[Nu]", "=", "2"}], ";", 
  RowBox[{"i", "=", "2"}], ";", 
  RowBox[{"j", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", 
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"d", " ", "\[Lambda]", " ", 
    SubscriptBox["r", 
     RowBox[{"i", ",", "j"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], "\[Conjugate]"}], ".", "GTensor", ".", 
       RowBox[{"e", "[", "j", "]"}]}], ")"}], "/.", 
     RowBox[{"z", "\[Rule]", "0"}]}], " ", "//", "ComplexExpand"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"x", " ", "polarized", " ", "for", " ", "now"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", " ", "=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], 
       SuperscriptBox["k", "3"]], 
      RowBox[{"Re", "[", 
       RowBox[{"v", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]\[Mu]\[Nu]ij", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"i", "\[Equal]", "j"}], "&&", " ", 
      RowBox[{"\[Mu]", "\[Equal]", "\[Nu]"}]}], ",", "\[Gamma]", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"6", " ", "\[Pi]", " ", "\[Gamma]", " "}], 
       SuperscriptBox["k", "3"]], 
      RowBox[{"Im", "[", 
       RowBox[{"v", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"y", "\[Rule]", " ", 
           RowBox[{"u", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[CapitalDelta]", "\[Mu]"], 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"i", ",", "j"}], "]"}], 
    RowBox[{"KroneckerDelta", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "+", 
   RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ")"}]}], "+", 
   RowBox[{"\[ImaginaryI]", " ", "\[Gamma]\[Mu]\[Nu]ij"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"\[CapitalOmega]\[Mu]\[Nu]ij", ",", "\[Gamma]\[Mu]\[Nu]ij"}], 
  "}"}]}], "Input",
 CellChangeTimes->{{3.8071866255693874`*^9, 3.8071866267921176`*^9}, {
  3.807186862954615*^9, 3.807186875931912*^9}, {3.807986971253048*^9, 
  3.807986997150771*^9}, {3.807987056393287*^9, 3.807987077604811*^9}, {
  3.8079871764853454`*^9, 3.8079872091957884`*^9}, {3.807987244760651*^9, 
  3.8079872556475244`*^9}, {3.808489687538264*^9, 3.8084897122062793`*^9}, {
  3.8084897471876965`*^9, 3.808489779278876*^9}, {3.8084898300570107`*^9, 
  3.8084898306284823`*^9}, {3.808489880496086*^9, 3.8084899452708035`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0.`\\\", RowBox[{\\\"5\\\", \\\"/\\\", \\\"2\\\"}]]]\\) \
encountered.\"",2,97,25,30691357932426416162,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.808489920979779*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"",2,97,26,30691357932426416162,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.808489921012692*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0.`\\\", RowBox[{\\\"5\\\", \\\"/\\\", \\\"2\\\"}]]]\\) \
encountered.\"",2,97,27,30691357932426416162,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.8084899210396185`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"",2,97,28,30691357932426416162,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.8084899210665827`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0.`\\\", RowBox[{\\\"3\\\", \\\"/\\\", \\\"2\\\"}]]]\\) \
encountered.\"",2,97,29,30691357932426416162,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.8084899210944757`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Power\\\", \\\"::\\\", \
\\\"infy\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,97,30,30691357932426416162,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.808489921123396*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0.`\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"",2,97,31,30691357932426416162,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.808489921155308*^9}}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Infinity\\\", \
\\\"::\\\", \\\"indet\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,97,32,30691357932426416162,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8084898345559735`*^9, {3.808489902581997*^9, 3.808489921183237*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "Indeterminate"}], "}"}]], "Output",
 CellChangeTimes->{
  3.807987004526037*^9, {3.8079870579032483`*^9, 3.8079870785801997`*^9}, {
   3.8079871831973352`*^9, 3.8079872103038216`*^9}, {3.8079872454857073`*^9, 
   3.807987256038478*^9}, 3.8080659145812445`*^9, 3.808489617948433*^9, 
   3.8084897699807186`*^9, {3.8084898139830065`*^9, 3.808489834765413*^9}, {
   3.8084899028113823`*^9, 3.808489921212157*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Find", " ", "the", " ", "basis", " ", "eigenvalues", " ", "of", " ", 
     "interest", " ", "by", " ", "diagonalizing", " ", "the", " ", 
     "Hamiltonian", " ", "and", " ", "then", " ", "finding", " ", "the", " ", 
     "overlap", " ", "of", " ", "the", " ", "resultant", " ", "e"}], "-", 
    RowBox[{
    "vecs", " ", "with", " ", "the", " ", "desired", " ", "basis", " ", 
     "vectors"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"evals", ",", "evecs"}], "}"}], " ", "=", " ", 
    RowBox[{"Eigensystem", "[", "Hfull", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8065952218391623`*^9, 3.8065953086384783`*^9}, {
  3.806597529455181*^9, 3.806597540499772*^9}, {3.806598112163319*^9, 
  3.8065981349225707`*^9}, {3.80659833695348*^9, 3.806598345744561*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fmode", " ", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["ecart", "1"], "&"}], ",", "9"}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"ferromagnetic", " ", 
    RowBox[{"state", ":", " ", 
     RowBox[{
     "each", " ", "atom", " ", "excited", " ", "with", " ", "polarization", 
      " ", "x"}], ":"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"afmode", " ", "=", " ", 
    RowBox[{"Array", "[", 
     RowBox[{"KroneckerDelta", "[", 
      RowBox[{",", 
       RowBox[{"Mod", "[", 
        RowBox[{"#", ",", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "J"}], "+", "1"}], ")"}]}]}], "]"}]}], "]"}], 
     "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8066042263585916`*^9, 3.8066042331171265`*^9}, {
   3.8066045940285583`*^9, 3.8066046949067063`*^9}, 3.806604730512274*^9, 
   3.8067085878259225`*^9, 3.806708757379533*^9, {3.8071365391322765`*^9, 
   3.8071366001325936`*^9}, {3.807136650754224*^9, 3.8071366639958963`*^9}, {
   3.8071367041897383`*^9, 3.807136717488803*^9}, {3.8071369912408504`*^9, 
   3.8071369997741237`*^9}, {3.8072190664421096`*^9, 3.807219073170845*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8071367180817337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"afmode", " ", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "#"], 
       SubscriptBox["ecart", "1"]}], "&"}], ",", "9"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8071367384285836`*^9, 3.8071367610069284`*^9}, 
   3.807219066474024*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.807136761727888*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ipmode", " ", "=", " ", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["ecart", "2"], "&"}], ",", "9"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8071367741204185`*^9, 3.8071367833456526`*^9}, {
   3.8071369713031483`*^9, 3.807136971397895*^9}, 3.807219087568183*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8071369771233664`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"evals", ",", "evecs"}], "}"}], " ", "=", " ", 
   RowBox[{"Eigensystem", "[", "Hfull", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overlap", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"list", " ", "with", " ", "entries", " ", 
    RowBox[{"{", 
     RowBox[{"idx", ",", " ", 
      RowBox[{"overlap", " ", "coefficient"}]}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "evecs", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"overlap", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"fmode", ".", 
         RowBox[{"evecs", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxIdx", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"overlap", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ">", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"linewidth", "=", 
   RowBox[{"Log10", "[", 
    RowBox[{
     RowBox[{"Im", "[", 
      RowBox[{"evals", "[", 
       RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}], "/", "\[Gamma]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8065983608537827`*^9, 3.8065984863567386`*^9}, {
   3.806598533305806*^9, 3.8065986043554926`*^9}, {3.806598847253667*^9, 
   3.806598852003512*^9}, 3.806598892536357*^9, 3.8065989245490074`*^9, {
   3.8066040321433735`*^9, 3.806604059458463*^9}, {3.8066041045712357`*^9, 
   3.8066041523416862`*^9}, {3.8066048314854064`*^9, 
   3.8066048433855705`*^9}, {3.8066051274197187`*^9, 3.8066051348418655`*^9}, 
   3.8072190732178154`*^9}],

Cell[BoxData["7.334217681424114`"], "Output",
 CellChangeTimes->{3.806604060408924*^9, 3.8066041154610705`*^9, 
  3.806604156065667*^9, 3.806604740300089*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["period"], "Input",
 CellChangeTimes->{{3.8066041665743856`*^9, 3.8066041672049*^9}}],

Cell[BoxData["1.05`"], "Output",
 CellChangeTimes->{3.806604167778209*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Re", "[", 
   RowBox[{"evecs", "[", 
    RowBox[{"[", "maxIdx", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.806598665685319*^9, 3.806598666608183*^9}, {
  3.8066037060469522`*^9, 3.806603757484418*^9}, {3.806603805954069*^9, 
  3.806603820025482*^9}, {3.806603938940955*^9, 3.8066039537964478`*^9}, {
  3.8066040040165625`*^9, 3.806604045818885*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxdlG1IU2EUx2+x0OhNbJXYu1iUhM1enL3ur9ucOr1uF8u+VK4xgsT8UIx9
KLzRF8HpaiIb+xDEglpB6uhtWbQi0twHIxOjZkFFZaAZUZBfrPAZnLMLl8vv
/u7zcO55zjnrjzUrrrmSJFn/3f+fs9eUYXJK42h96TeIF1jR0a9rvhQSnIns
H9RnweEb+nY8dlmwFu8D7hPJrIjgHJxifhU6D38qXNOT8uvwUdK0aAqigvMQ
YD4fXcWj48NXewRvRNge8f5uvyt4E/zMFyA5c215CLcEb4H5TMyZd+WB4EJ8
YV4HXcZ4/Uhnar8ifMgNeadvxAVvQxHz2zGQrU989t8XvAMzzrX3GgafCN6J
YeaL0dd9MRrSPRSsh3uob2wi/FRwCWLM70L9bb1xwvFI8G5cH+zIea17JngP
DjG/Fx5jXWKzLxXvPkglB+cva+wXvB8tzBuwsCmjbWTrY8HA0TeLV8vywCyr
wALmS7F0MrjhzwXBaimCHll/c1R8L5VhEfNlcC7pcnt6U+uNON/kPRee91x4
IxqYN8HG1pvwi+1vTvNmtLP4ypH7lsZfDj/zFuSbyP+rFnxn+alI8xVI3qH5
rUQsQfKvVuId81WQe8n5qVUIvKDna4WFeSvqtLQ+qqF1kfpRq3GA+RqczCT1
p9bg1UpanzIamZcxLUVIfdfi61lS/2otfjJvg6wn/QMbogrpLzXNx23wH6H9
aYdvDulf2NFGvWrHGO3/uB2tQTofFCSph4LTdL6oClx0/sQVeIT/C0SdYAE=

      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 75.}, {0, 0.19548457933056448`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.806598667189864*^9, 3.806598858697175*^9, {3.8066037223937216`*^9, 
   3.806603758905113*^9}, {3.8066038114623947`*^9, 3.8066038206245885`*^9}, {
   3.8066039408577785`*^9, 3.806603954351776*^9}, 3.8066047593273296`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "fmode", "]"}]], "Input",
 CellChangeTimes->{{3.806603860382429*^9, 3.8066038776486382`*^9}, {
   3.8068473967980094`*^9, 3.806847402153802*^9}, 3.807219073227759*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxdjk0OwVAURm+MDA0MDAwQERER///0KaWUokuQGNvCW1qXZAkIN/JOk6Y5
Oed+afn2SO4ZEYne7+f7fZ6euI9xMWvcLgefBxfQF+FL4Ar6KnwNXEffgG+C
W+jb8B1wF30Pvg8eoB/Cj8Bj9BP4KXiGfg6/AC/Re/DGZaus/QoeLL7bWx9+
jXtl3d/AgyXAfgC/xb2y7u/gwRJiP4Tf415Z9w/wYImwH8Efca+s+yd4sMTY
j+HPuFfW/YvrDdgq//oUXq64V9b/gU/Bkri9SVxvwem/fwFysFGL
      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 75.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8066038781502857`*^9, 3.8066047629267006`*^9, {3.806847397616864*^9, 
   3.8068474032467427`*^9}, {3.807132112560506*^9, 3.8071321228569713`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "afmode", "]"}]], "Input",
 CellChangeTimes->{{3.8068474101586657`*^9, 3.8068474188468065`*^9}, 
   3.8072190664839993`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxdjEkOAUEYRv9YWVpYWFggIiIi5nkoY9NmR5BYu0LdTB/JERD1k3qVdCqv
X30ve71fbjER2b6/z/09z4m7H+6HEe/EwQnj75LwKXBa37t+Bj4HzqNfgC+C
S+iX4SvgKvo1+Dq4gX4TvgVuo9+B74J76PfhB+Ah+iP4MXiCvvG9BcvU79sp
/Ax7Ze3P4cGyQH8Bv8ReWfsreLAE6Afwa+yVtb+BB0uIfgi/xV5Z+zt4sOzR
38MfsFfW/hEeLCe/b06+t+Do9971z743YKvs+hG8XLBXdn0LH/35BZ0tWAs=

      "]]}, {}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 75.}, {-1., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.80684741937995*^9, 3.8071321188476925`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fmode", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"2", ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "3"}], "]"}]}], "]"}], "&"}], ",", "dim"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"anti", "-", 
    RowBox[{"ferromagnetic", " ", "state"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.806595368710807*^9, 3.8065953873140383`*^9}, {
   3.806595424919409*^9, 3.806595425728244*^9}, {3.8065968094545674`*^9, 
   3.806596831147527*^9}, {3.806597432910872*^9, 3.806597457653801*^9}, 
   3.8072190732347717`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"afmode", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Boole", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"u", "\[Equal]", "1"}], "||", " ", 
         RowBox[{"u", "\[Equal]", "0"}]}], ")"}], "/.", 
       RowBox[{"u", "\[Rule]", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "6"}], "]"}]}]}], "]"}], "&"}], ",", "15"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.806841967001171*^9, 3.8068420115617456`*^9}, {
   3.8068421997990174`*^9, 3.806842199900831*^9}, {3.8068422457581863`*^9, 
   3.8068422817385874`*^9}, {3.8068423310007696`*^9, 3.806842343588249*^9}, {
   3.8068424244685297`*^9, 3.806842446463051*^9}, {3.806842496008189*^9, 
   3.806842526091095*^9}, {3.8068470051075377`*^9, 3.8068470184053044`*^9}, {
   3.8068471004494576`*^9, 3.8068471407337437`*^9}, {3.806847304784029*^9, 
   3.8068473156648207`*^9}, 3.807219066489028*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8068473101531677`*^9, 3.8068473159528604`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Array", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Boole", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"u", "\[Equal]", "1"}], "||", " ", 
        RowBox[{"u", "\[Equal]", "0"}]}], ")"}], "/.", 
      RowBox[{"u", "\[Rule]", " ", 
       RowBox[{"Mod", "[", 
        RowBox[{"#", ",", "6"}], "]"}]}]}], "]"}], "&"}], ",", "12"}], "]"}]],\
 "Input",
 CellChangeTimes->{{3.80684696416131*^9, 3.8068469641919403`*^9}, {
  3.806847022355571*^9, 3.806847091776332*^9}, {3.8068471485085464`*^9, 
  3.8068472355615053`*^9}, {3.8068472713001223`*^9, 3.8068472838333406`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8068472363118377`*^9, {3.8068472762623158`*^9, 3.8068472842498827`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",",
   "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", 
  "15"}], "\[IndentingNewLine]", 
 RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",",
   "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
  "0"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8068455484326334`*^9, 3.8068456647525463`*^9}}],

Cell["\<\
every other group of three, use KroneckerDelta[1or2,Mod[#,3]]] to set value \
to 1. \
\>", "Text",
 CellChangeTimes->{{3.806845698524151*^9, 3.8068457789501963`*^9}}],

Cell["\<\
Build anti/ferromag. states, and then calculate overlap with a given basis \
vector list\
\>", "Text",
 CellChangeTimes->{{3.806596848133563*^9, 3.8065969131695623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fmode", " ", "=", " ", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"2", ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "3"}], "]"}]}], "]"}], "&"}], ",", "9"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8065969291614404`*^9, 3.8065970719526896`*^9}, 
   3.8072190732457113`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.806970560224367*^9, 3.806970560236228*^9}}],

Cell[CellGroupData[{

Cell[BoxData["%"], "Input",
 CellChangeTimes->{3.806597017598461*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "299792458", ",", "599584916", ",", "899377374", ",", "1199169832", ",", 
   "1498962290", ",", "1798754748", ",", "2098547206", ",", "2398339664", ",",
    "2698132122"}], "}"}]], "Output",
 CellChangeTimes->{3.8065970180822887`*^9}]
}, Open  ]],

Cell["\<\
Check my grid mapping. 2D grid, but only one index to specify atoms\
\>", "Text",
 CellChangeTimes->{{3.8055812128834515`*^9, 3.805581234435918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", 
   SqrtBox["atomnum"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";", 
  RowBox[{"(*", 
   RowBox[{"0.7", ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "num"}], "]"}], ",", " ", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}], "}"}]}],
          ",", 
         RowBox[{"a", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"j", "-", "1"}], ",", "num"}], "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "/", "num"}], "]"}]}], 
           "}"}]}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"a", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "num"}], "]"}], ",", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}], 
            "}"}]}], ",", "0.05"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Range", "[", 
        SuperscriptBox["num", "2"], "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"1", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5", ",", "8"}], "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"PlotLegends", "\[Rule]", " ", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"{", "\"\<hi\>\"", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"a", " ", "num"}], ")"}]}], "//", "N"}], ",", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"a", " ", "num"}], ")"}]}], "//", "N"}]}], "}"}]}], 
       "]"}]}], ","}], "*)"}], " ", 
   RowBox[{"Axes", "->", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"num", "-", "1"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "num"}], "-", "1"}], ")"}]}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.805581333965639*^9, 3.8055814341893806`*^9}, {
  3.805581552511201*^9, 3.8055815960303836`*^9}, {3.805581629511797*^9, 
  3.8055816883682003`*^9}, {3.8055817251288686`*^9, 3.8055817262478523`*^9}, {
  3.805581886212476*^9, 3.8055818997023997`*^9}, {3.805581939032192*^9, 
  3.8055820448102236`*^9}, {3.8056697625052896`*^9, 3.8056698196551075`*^9}, {
  3.8065230852646923`*^9, 3.8065230871668463`*^9}, {3.806523244000454*^9, 
  3.8065232904876947`*^9}, {3.806523351830069*^9, 3.806523378934533*^9}, {
  3.806523835979823*^9, 3.8065238841500297`*^9}, {3.806523947442684*^9, 
  3.8065240254449883`*^9}, {3.8065240606577477`*^9, 3.8065240730513306`*^9}, {
  3.806524114790417*^9, 3.806524148044992*^9}, {3.808175601187192*^9, 
  3.808175634705696*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0, 0, 1], CircleBox[{0, 0}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1, 0}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2, 0}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0, 1}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1, 1}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2, 1}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{0, 2}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{1, 2}, 0.05]}, 
   {RGBColor[0, 0, 1], CircleBox[{2, 2}, 0.05]}, 
   {RGBColor[1, 0, 0], LineBox[{{0, 0}, {1, 0}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0, 0}, {1, 1}}]}, 
   {RGBColor[1, 0, 0], LineBox[{{0, 0}, {1, 2}}]}},
  Axes->True,
  PlotRange->{{0, 2}, {0, 2}}]], "Output",
 CellChangeTimes->{{3.805581655114204*^9, 3.8055816888449235`*^9}, 
   3.8055819020959787`*^9, {3.805581941482599*^9, 3.805581976920786*^9}, {
   3.805582038182976*^9, 3.8055820450695515`*^9}, 3.805669582249579*^9, {
   3.805669805938079*^9, 3.805669820223586*^9}, 3.8059998840810094`*^9, 
   3.806523291233897*^9, 3.8065233798524733`*^9, {3.8065238580323625`*^9, 
   3.8065238847552323`*^9}, {3.806524006640272*^9, 3.8065240259317565`*^9}, {
   3.8065240672190237`*^9, 3.8065240738995457`*^9}, 3.806524148572755*^9, 
   3.8081755189332676`*^9, 3.808175636178617*^9}]
}, Open  ]],

Cell["What 1D atom idx corresponds to (i,j)?", "Text",
 CellChangeTimes->{{3.8065241686881685`*^9, 3.8065241926268225`*^9}, {
  3.806524263972519*^9, 3.806524264679307*^9}, {3.806526088903438*^9, 
  3.8065261000657825`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"idx", "[", 
    RowBox[{"i_", ",", "j_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], "n"}], "+", "j"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8065261073327303`*^9, 3.8065261752678614`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"idx", "[", 
  RowBox[{"2", ",", "2", ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.806526154473009*^9, 3.806526188045511*^9}}],

Cell[BoxData[
 RowBox[{"2", "+", "n"}]], "Output",
 CellChangeTimes->{{3.8065261587426662`*^9, 3.8065261885116243`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8065252772599363`*^9, 3.806525334063403*^9}, 
   3.80652546870558*^9, {3.8065255331270447`*^9, 3.806525549422365*^9}, 
   3.8065256111507196`*^9, 3.806526080694502*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"idx", "[", 
   RowBox[{"1", ",", "1", ",", "n"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.806525554899561*^9, 3.8065255918755627`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "+", "n"}], "2"]], "Output",
 CellChangeTimes->{{3.8065255617129545`*^9, 3.8065256130363503`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "+", "2"}], "==", " ", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "  ", "+", " ", "\[Beta]"}], ")"}]}]}], ",", 
     RowBox[{"n", "\[Equal]", 
      RowBox[{"\[Alpha]", " ", "+", 
       RowBox[{"\[Beta]", " ", "n"}]}]}]}], " ", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.806525336012368*^9, 3.8065254434850245`*^9}, {
  3.8065254736283855`*^9, 3.806525499280048*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Alpha]", "\[Rule]", 
     FractionBox[
      SuperscriptBox["n", "2"], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]}], ",", 
    RowBox[{"\[Beta]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", "-", "n"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.806525444422021*^9, 3.8065255006169453`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8065253811267548`*^9, 3.806525381155676*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"i", ",", "j"}], "]"}]], "Input",
 CellChangeTimes->{{3.8065242761394253`*^9, 3.8065242781753464`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"i", "-", "1"}], ",", "num"}], "]"}], ",", 
    RowBox[{"Floor", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"i", "\[Rule]", " ", "2"}], ",", 
    RowBox[{"j", "\[Rule]", " ", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8065242810711613`*^9, 3.8065243302001524`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.806524295356618*^9, 3.8065243322470803`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", 
   RowBox[{"(", 
    RowBox[{"a", " ", "num"}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8065240562567124`*^9, 3.8065240570344443`*^9}}],

Cell[BoxData["0.06666666666666667`"], "Output",
 CellChangeTimes->{{3.8065240533325157`*^9, 3.8065240575673723`*^9}}]
}, Open  ]],

Cell[BoxData["Legended"], "Input",
 CellChangeTimes->{{3.8065228838310924`*^9, 3.8065228949564147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], " ", ":=", 
   RowBox[{"a", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"j", "-", "1"}], ",", "num"}], "]"}], "-", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "num"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "/", "num"}], "]"}], "-", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "/", "num"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.805669561032357*^9, 3.8056695676486287`*^9}, {
   3.8056696494029245`*^9, 3.8056696723884273`*^9}, {3.805669718583824*^9, 
   3.8056697393781595`*^9}, 3.805669838869701*^9, 3.8059999759267817`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r", "[", 
  RowBox[{"1", ",", "15"}], "]"}]], "Input",
 CellChangeTimes->{{3.805669571669897*^9, 3.8056695769896364`*^9}, {
  3.8059982614260635`*^9, 3.8059982692525363`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.8`", ",", "1.4`"}], "}"}]], "Output",
 CellChangeTimes->{{3.805669577685768*^9, 3.8056695866737537`*^9}, 
   3.8056696741087875`*^9, 3.805669740869199*^9, 3.8056698433556967`*^9, {
   3.8059998784341445`*^9, 3.80599988876947*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Upsilon]", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.805671166689271*^9, 3.805671284039829*^9}, {
  3.805671390830882*^9, 3.8056714278278937`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8056712255064325`*^9, 3.8056712290519495`*^9}, 
   3.805671265495475*^9, {3.805671398099431*^9, 3.805671434158975*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "1"}], "}"}], ".", "\[Upsilon]"}]], "Input",
 CellChangeTimes->{{3.805671415371196*^9, 3.8056714573818245`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.805671436502689*^9, 3.805671442415837*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{766, 812},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 168, 3, 221, "Chapter"],
Cell[751, 27, 192, 5, 63, "Text"],
Cell[CellGroupData[{
Cell[968, 36, 101, 1, 86, "Section"],
Cell[CellGroupData[{
Cell[1094, 41, 99, 1, 59, "Subsection"],
Cell[1196, 44, 1336, 26, 392, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2581, 76, 119, 2, 86, "Section"],
Cell[2703, 80, 321, 5, 113, "Text"],
Cell[3027, 87, 13985, 320, 1196, "Input"],
Cell[17015, 409, 1680, 40, 168, "Text"],
Cell[18698, 451, 366, 7, 38, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19101, 463, 167, 2, 86, "Section"],
Cell[19271, 467, 6626, 144, 317, "Input"],
Cell[CellGroupData[{
Cell[25922, 615, 20330, 383, 1713, "Input"],
Cell[46255, 1000, 434, 9, 28, "Print"],
Cell[46692, 1011, 296, 6, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47025, 1022, 235, 5, 37, "Input"],
Cell[47263, 1029, 171, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47471, 1037, 102, 1, 37, "Input"],
Cell[47576, 1040, 95, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47708, 1046, 120, 2, 37, "Input"],
Cell[47831, 1050, 125, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47993, 1058, 156, 3, 37, "Input"],
Cell[48152, 1063, 3588, 75, 310, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51777, 1143, 156, 3, 37, "Input"],
Cell[51936, 1148, 3566, 75, 310, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55539, 1228, 465, 13, 37, "Input"],
Cell[56007, 1243, 14713, 284, 284, "Output"]
}, Open  ]],
Cell[70735, 1530, 131, 2, 37, "Input"],
Cell[CellGroupData[{
Cell[70891, 1536, 131, 2, 37, "Input"],
Cell[71025, 1540, 74, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71136, 1546, 127, 2, 37, "Input"],
Cell[71266, 1550, 98, 1, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71401, 1556, 132, 2, 37, "Input"],
Cell[71536, 1560, 1623, 38, 284, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73196, 1603, 514, 13, 37, "Input"],
Cell[73713, 1618, 2347, 44, 399, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76097, 1667, 1368, 38, 158, "Input"],
Cell[77468, 1707, 143, 2, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77648, 1714, 311, 7, 37, "Input"],
Cell[77962, 1723, 212, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78211, 1731, 201, 4, 37, "Input"],
Cell[78415, 1737, 206, 4, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78658, 1746, 549, 14, 37, "Input"],
Cell[79210, 1762, 1967, 44, 299, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81214, 1811, 180, 4, 37, "Input"],
Cell[81397, 1817, 218, 4, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81652, 1826, 153, 4, 37, "Input"],
Cell[81808, 1832, 1125, 21, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82970, 1858, 406, 11, 37, "Input"],
Cell[83379, 1871, 1507, 57, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84923, 1933, 205, 5, 46, "Input"],
Cell[85131, 1940, 210, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85378, 1948, 268, 7, 46, "Input"],
Cell[85649, 1957, 177, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85863, 1965, 123, 2, 46, "Input"],
Cell[85989, 1969, 92, 1, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86118, 1975, 180, 3, 46, "Input"],
Cell[86301, 1980, 1648, 38, 355, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87986, 2023, 428, 12, 46, "Input"],
Cell[88417, 2037, 7409, 131, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95863, 2173, 213, 5, 46, "Input"],
Cell[96079, 2180, 116, 1, 46, "Output"]
}, Open  ]],
Cell[96210, 2184, 104, 1, 46, "Input"],
Cell[96317, 2187, 196, 4, 46, InheritFromParent],
Cell[96516, 2193, 106, 2, 46, "Output"],
Cell[CellGroupData[{
Cell[96647, 2199, 464, 12, 46, "Input"],
Cell[97114, 2213, 1282, 27, 218, "Output"]
}, Open  ]],
Cell[98411, 2243, 349, 9, 46, "Input"],
Cell[CellGroupData[{
Cell[98785, 2256, 323, 8, 46, "Input"],
Cell[99111, 2266, 1639, 40, 137, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100787, 2311, 150, 3, 46, "Input"],
Cell[100940, 2316, 1868, 47, 226, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102845, 2368, 2868, 69, 317, "Input"],
Cell[105716, 2439, 4012, 76, 578, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109765, 2520, 199, 5, 78, "Input"],
Cell[109967, 2527, 132, 2, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110136, 2534, 226, 6, 78, "Input"],
Cell[110365, 2542, 131, 2, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110533, 2549, 564, 17, 80, "Input"],
Cell[111100, 2568, 3887, 74, 350, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115036, 2648, 115, 1, 107, "Section"],
Cell[115154, 2651, 1443, 42, 1018, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[116634, 2698, 92, 1, 85, "Section"],
Cell[116729, 2701, 238, 5, 78, "Text"],
Cell[116970, 2708, 126, 2, 46, "Input"],
Cell[117099, 2712, 447, 10, 46, "Input"],
Cell[CellGroupData[{
Cell[117571, 2726, 169, 3, 46, "Input"],
Cell[117743, 2731, 204, 5, 46, "Output"]
}, Open  ]],
Cell[117962, 2739, 103, 1, 47, "Text"],
Cell[118068, 2742, 259, 8, 46, "Input"],
Cell[118330, 2752, 91, 1, 47, "Text"],
Cell[118424, 2755, 240, 6, 46, "Input"],
Cell[CellGroupData[{
Cell[118689, 2765, 204, 5, 51, "Input"],
Cell[118896, 2772, 166, 4, 51, "Output"]
}, Open  ]],
Cell[119077, 2779, 94, 1, 46, "Input"],
Cell[119174, 2782, 200, 5, 46, "Input"],
Cell[CellGroupData[{
Cell[119399, 2791, 200, 5, 46, "Input"],
Cell[119602, 2798, 95, 1, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119734, 2804, 173, 3, 46, "Input"],
Cell[119910, 2809, 121, 2, 46, "Output"]
}, Open  ]],
Cell[120046, 2814, 420, 7, 110, "Text"],
Cell[120469, 2823, 1760, 57, 141, "Text"],
Cell[122232, 2882, 920, 28, 227, "Input"],
Cell[123155, 2912, 145, 2, 47, "Text"],
Cell[CellGroupData[{
Cell[123325, 2918, 5107, 130, 602, "Input"],
Cell[128435, 3050, 351, 8, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128823, 3063, 122, 2, 46, "Input"],
Cell[128948, 3067, 151, 3, 46, "Output"]
}, Open  ]],
Cell[129114, 3073, 122, 2, 46, "Input"],
Cell[CellGroupData[{
Cell[129261, 3079, 884, 25, 77, "Input"],
Cell[130148, 3106, 205, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130390, 3115, 94, 1, 46, "Input"],
Cell[130487, 3118, 226, 5, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130750, 3128, 190, 4, 46, "Input"],
Cell[130943, 3134, 457, 12, 86, "Output"]
}, Open  ]],
Cell[131415, 3149, 1440, 39, 293, "Input"],
Cell[CellGroupData[{
Cell[132880, 3192, 418, 11, 46, "Input"],
Cell[133301, 3205, 1254, 38, 382, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134592, 3248, 339, 10, 50, "Input"],
Cell[134934, 3260, 252, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135223, 3272, 655, 19, 50, "Input"],
Cell[135881, 3293, 591, 13, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136509, 3311, 354, 11, 50, "Input"],
Cell[136866, 3324, 201, 3, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137104, 3332, 173, 4, 50, "Input"],
Cell[137280, 3338, 146, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137463, 3347, 357, 9, 48, "Input"],
Cell[137823, 3358, 229, 4, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138089, 3367, 271, 7, 46, "Input"],
Cell[138363, 3376, 1493, 47, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139893, 3428, 695, 15, 71, "Input"],
Cell[140591, 3445, 301, 6, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140929, 3456, 94, 1, 71, "Input"],
Cell[141026, 3459, 597, 12, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141660, 3476, 225, 7, 71, "Input"],
Cell[141888, 3485, 151, 3, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142076, 3493, 393, 12, 71, "Input"],
Cell[142472, 3507, 74, 1, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142583, 3513, 419, 11, 71, "Input"],
Cell[143005, 3526, 378, 7, 71, "Output"]
}, Open  ]],
Cell[143398, 3536, 108, 1, 72, "Text"],
Cell[CellGroupData[{
Cell[143531, 3541, 3758, 101, 660, "Input"],
Cell[147292, 3644, 372, 8, 106, "Message"],
Cell[147667, 3654, 346, 8, 56, "Message"],
Cell[148016, 3664, 374, 8, 106, "Message"],
Cell[148393, 3674, 348, 8, 56, "Message"],
Cell[148744, 3684, 374, 8, 106, "Message"],
Cell[149121, 3694, 389, 8, 56, "Message"],
Cell[149513, 3704, 346, 8, 56, "Message"],
Cell[149862, 3714, 393, 8, 56, "Message"],
Cell[150258, 3724, 460, 8, 71, "Output"]
}, Open  ]],
Cell[150733, 3735, 886, 19, 166, "Input"],
Cell[CellGroupData[{
Cell[151644, 3758, 1268, 32, 166, "Input"],
Cell[152915, 3792, 1204, 48, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154156, 3845, 399, 12, 78, "Input"],
Cell[154558, 3859, 1202, 48, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155797, 3912, 346, 8, 88, "Input"],
Cell[156146, 3922, 1609, 57, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157792, 3984, 2160, 59, 501, "Input"],
Cell[159955, 4045, 158, 2, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160150, 4052, 98, 1, 110, "Input"],
Cell[160251, 4055, 74, 1, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160362, 4061, 418, 8, 110, "Input"],
Cell[160783, 4071, 2380, 51, 908, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163200, 4127, 207, 3, 110, "Input"],
Cell[163410, 4132, 1791, 41, 921, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165238, 4178, 164, 3, 110, "Input"],
Cell[165405, 4183, 1696, 40, 863, "Output"]
}, Open  ]],
Cell[167116, 4226, 648, 17, 187, "Input"],
Cell[CellGroupData[{
Cell[167789, 4247, 947, 21, 110, "Input"],
Cell[168739, 4270, 283, 6, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169059, 4281, 618, 16, 110, "Input"],
Cell[169680, 4299, 277, 6, 110, "Output"]
}, Open  ]],
Cell[169972, 4308, 472, 7, 258, "Input"],
Cell[170447, 4317, 176, 4, 188, "Text"],
Cell[170626, 4323, 180, 4, 188, "Text"],
Cell[170809, 4329, 418, 12, 187, "Input"],
Cell[171230, 4343, 92, 1, 110, "Input"],
Cell[CellGroupData[{
Cell[171347, 4348, 69, 1, 110, "Input"],
Cell[171419, 4351, 276, 6, 187, "Output"]
}, Open  ]],
Cell[171710, 4360, 159, 3, 112, "Text"],
Cell[CellGroupData[{
Cell[171894, 4367, 4018, 114, 1065, "Input"],
Cell[175915, 4483, 1259, 23, 1416, "Output"]
}, Open  ]],
Cell[177189, 4509, 224, 3, 112, "Text"],
Cell[177416, 4514, 345, 11, 110, "Input"],
Cell[CellGroupData[{
Cell[177786, 4529, 155, 3, 110, "Input"],
Cell[177944, 4534, 120, 2, 110, "Output"]
}, Open  ]],
Cell[178079, 4539, 217, 3, 110, "Input"],
Cell[CellGroupData[{
Cell[178321, 4546, 189, 4, 110, "Input"],
Cell[178513, 4552, 141, 3, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178691, 4560, 594, 16, 110, "Input"],
Cell[179288, 4578, 589, 20, 183, "Output"]
}, Open  ]],
Cell[179892, 4601, 94, 1, 110, "Input"],
Cell[179989, 4604, 151, 3, 110, "Input"],
Cell[CellGroupData[{
Cell[180165, 4611, 490, 15, 110, "Input"],
Cell[180658, 4628, 141, 3, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180836, 4636, 194, 5, 110, "Input"],
Cell[181033, 4643, 117, 1, 110, "Output"]
}, Open  ]],
Cell[181165, 4647, 104, 1, 110, "Input"],
Cell[181272, 4650, 926, 27, 258, "Input"],
Cell[CellGroupData[{
Cell[182223, 4681, 199, 4, 110, "Input"],
Cell[182425, 4687, 272, 5, 332, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182734, 4697, 614, 19, 366, "Input"],
Cell[183351, 4718, 402, 10, 332, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183790, 4733, 183, 4, 332, "Input"],
Cell[183976, 4739, 149, 3, 332, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

