(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13000,        380]
NotebookOptionsPosition[     11439,        350]
NotebookOutlinePosition[     11846,        366]
CellTagsIndexPosition[     11803,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Hermitian conjugate of a matrix element of a spherical tensor, for example \
to find the matrix elements of the electric dipole operator between angular \
momentum states. \n\nThe interaction is\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "F"], "=", 
    RowBox[{"(", GridBox[{
       {"0", "d"},
       {
        SuperscriptBox["d", "*"], "0"}
      }], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dd5141ac-ac3d-4c60-864c-e9df791c67d6"],
 ", \n\nwhere  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "~", 
    SuperscriptBox[
     SubscriptBox["T", "q"], 
     RowBox[{"(", "\[Kappa]", ")"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2c068121-a6d0-48af-8409-d069dbb5f13d"],
 " and its Hermitian conjugate is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "*"], "~", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"\[Kappa]", "-", "q"}]]}], 
    SubscriptBox[
     SuperscriptBox["T", 
      RowBox[{"(", "\[Kappa]", ")"}]], 
     RowBox[{"-", "q"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ab5efb47-3472-4c71-b9b9-d9f62f84c102"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Kappa]", "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cf275616-fd94-4c58-ba1b-77cf436b00ae"],
 ". The matrix elements can be found with the Wigner-Eckart theorem, where \
the excited and ground basis states are {F\[CloseCurlyQuote],m\
\[CloseCurlyQuote]} and {F,m} respectively and other quantum numbers have \
been suppressed in the state labels and implicitly accounted for in the \
reduced matrix element:\n\n",
 Cell[BoxData[{
  RowBox[{
   RowBox[{
    TemplateBox[{
      RowBox[{
        RowBox[{"F", "'"}], 
        RowBox[{"m", "'"}]}]},
     "Bra"], 
    SubscriptBox["d", "q"], 
    TemplateBox[{
      RowBox[{"F", " ", "m"}]},
     "Ket"]}], "=", 
   RowBox[{
    FractionBox[
     SubsuperscriptBox["C", "Fm1q", 
      RowBox[{
       RowBox[{"F", "'"}], 
       RowBox[{"m", "'"}]}]], 
     SqrtBox[
      RowBox[{
       RowBox[{"2", 
        RowBox[{"F", "'"}]}], "+", "1"}]]], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"F", "'"}], "||", 
      OverscriptBox["d", "^"], "||", "F"}], 
     "\[RightAngleBracket]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    TemplateBox[{
      RowBox[{"F", " ", "m"}]},
     "Bra"], 
    SuperscriptBox[
     SubscriptBox["d", "q"], "*"], 
    TemplateBox[{
      RowBox[{
        RowBox[{"F", "'"}], " ", 
        RowBox[{"m", "'"}]}]},
     "Ket"]}], "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "-", "q"}]], 
     TemplateBox[{
       RowBox[{"F", " ", "m"}]},
      "Bra"], 
     SubscriptBox["d", 
      RowBox[{"-", "q"}]], 
     TemplateBox[{
       RowBox[{
         RowBox[{"F", "'"}], " ", 
         RowBox[{"m", "'"}]}]},
      "Ket"]}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "-", "q"}]], 
     FractionBox[
      SubsuperscriptBox["C", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "'"}], 
         RowBox[{"m", "'"}], "1"}], "-", "q"}], "Fm"], 
      SqrtBox[
       RowBox[{
        RowBox[{"2", "F"}], "+", "1"}]]], 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"F", "'"}], "||", 
       OverscriptBox["d", "^"], "||", "F"}], "\[RightAngleBracket]"}]}]}]}]}],
  ExpressionUUID->"5c74eae8-be4e-42cb-a945-cbb7ce1c4ad4"]
}], "Text",
 CellChangeTimes->{{3.8699143415018373`*^9, 3.8699143710534363`*^9}, {
  3.8699147535038776`*^9, 3.869914924679575*^9}, {3.869914965962267*^9, 
  3.8699151593553753`*^9}, {3.869916188534979*^9, 3.8699162434464417`*^9}, {
  3.8699187442928586`*^9, 3.8699187682842875`*^9}, {3.869918798359957*^9, 
  3.869918837470209*^9}, {3.8699188692830043`*^9, 3.8699189079988804`*^9}, {
  3.8699189393058147`*^9, 3.8699190422817855`*^9}, {3.869919239406588*^9, 
  3.869919273956053*^9}, {3.869919310969125*^9, 
  3.8699195137843847`*^9}},ExpressionUUID->"86c0f36f-0d39-4903-958a-\
77fa5cc90b64"],

Cell[TextData[{
 "The last line used the fact that the reduced matrix element is real \
(actually, the reduced matrix element can be further reduced to ",
 Cell[BoxData[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"J", "'"}], "||", 
    OverscriptBox["d", "^"], "||", "J"}], "\[RightAngleBracket]"}]],
  ExpressionUUID->"c985d1c6-9edc-4e71-b92f-091e42055140"],
 " times factors involving a 6J symbol. Check that ",
 Cell[BoxData[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"F", "'"}], "||", 
    OverscriptBox["d", "^"], "||", "F"}], "\[RightAngleBracket]"}]],
  ExpressionUUID->"e8b7a4a9-2d30-4df7-92e2-588221620872"],
 "=",
 Cell[BoxData[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"F", "||", 
    OverscriptBox["d", "^"], "||", 
    RowBox[{"F", "'"}]}], "\[RightAngleBracket]"}]],ExpressionUUID->
  "bcc172e3-15f8-4d26-8898-799777b3c7d4"],
 " is true). Verify that the two matrix elements have the same magnitude for \
an F=1,m=1 to F=2,m=2 cycling transition:"
}], "Text",
 CellChangeTimes->{{3.869919535608471*^9, 3.8699196160176787`*^9}, {
  3.869919662061344*^9, 
  3.8699197357016244`*^9}},ExpressionUUID->"73c59cf8-f8a2-4e80-94ea-\
979024df62b5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", "1"}], ";", 
  RowBox[{"mF", "=", "1"}], ";", 
  RowBox[{"JJ", "=", 
   RowBox[{"3", "/", "2"}]}], ";", 
  RowBox[{"FF", "=", "2"}], ";", 
  RowBox[{"mFF", "=", "2"}], ";", 
  RowBox[{"q", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", "\"\<d prefactor\>\"", "\[IndentingNewLine]", 
 FractionBox[
  RowBox[{"ClebschGordan", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"F", ",", "mF"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "q"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"FF", ",", "mFF"}], "}"}]}], "]"}], 
  SqrtBox[
   RowBox[{
    RowBox[{"2", "FF"}], "+", 
    "1"}]]], "\[IndentingNewLine]", "\"\<\!\(\*SuperscriptBox[\(d\), \(*\)]\) \
prefactor\>\"", "\[IndentingNewLine]", 
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"1", "-", "q"}]], 
  FractionBox[
   RowBox[{"ClebschGordan", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"FF", ",", "mFF"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "q"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"F", ",", "mF"}], "}"}]}], "]"}], 
   SqrtBox[
    RowBox[{
     RowBox[{"2", "F"}], "+", "1"}]]]}]}], "Input",
 CellChangeTimes->{{3.8699196241725035`*^9, 3.8699196404743013`*^9}, {
  3.869919784449483*^9, 3.8699199044551315`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"deef4e50-9b68-4fad-85ad-826c5d43d4a9"],

Cell[BoxData["\<\"d prefactor\"\>"], "Output",
 CellChangeTimes->{{3.8699198881250896`*^9, 3.869919904818615*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"8e92e158-a632-46df-a4f7-fad118bcb49b"],

Cell[BoxData[
 FractionBox["1", 
  SqrtBox["5"]]], "Output",
 CellChangeTimes->{{3.8699198881250896`*^9, 3.869919904818615*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"c1ee3227-acd9-4696-8ac2-ab2a8382cfbb"],

Cell[BoxData["\<\"\\!\\(\\*SuperscriptBox[\\(d\\), \\(*\\)]\\) \
prefactor\"\>"], "Output",
 CellChangeTimes->{{3.8699198881250896`*^9, 3.869919904818615*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"1401e709-90dd-40d0-a3ad-3489361f431d"],

Cell[BoxData[
 FractionBox["1", 
  SqrtBox["5"]]], "Output",
 CellChangeTimes->{{3.8699198881250896`*^9, 3.869919904826994*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"a14f948f-deb2-488e-9a00-874d1d607678"]
}, Open  ]],

Cell["\<\
Now check the factors that decouple from the reduced matrix element in the J \
basis:\
\>", "Text",
 CellChangeTimes->{{3.8699199992332954`*^9, 3.8699200390843744`*^9}, {
  3.869920137556571*^9, 
  3.8699201385506153`*^9}},ExpressionUUID->"593099d4-0af1-4eb8-b594-\
7bba5f523ad8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"i", "=", 
    RowBox[{"3", "/", "2"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"e", ".", "g", ".", " ", "Rb87"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<decoupling prefactor before \
\[LeftAngleBracket]J'||\!\(\*OverscriptBox[\(d\), \(^\)]\)||J\
\[RightAngleBracket]\>\"", "\[IndentingNewLine]", 
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"1", "+", "i", "+", "JJ", "+", "F"}]], 
  SqrtBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "F"}], "+", "1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "FF"}], "+", "1"}], ")"}]}]], 
  RowBox[{"SixJSymbol", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"J", ",", "i", ",", "F"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"FF", ",", "1", ",", "JJ"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", "\"\<decoupling prefactor before \
\[LeftAngleBracket]J||\!\(\*OverscriptBox[\(d\), \(^\)]\)||J'\
\[RightAngleBracket]\>\"", "\[IndentingNewLine]", 
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"1", "+", "i", "+", "J", "+", "FF"}]], 
  SqrtBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "F"}], "+", "1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "FF"}], "+", "1"}], ")"}]}]], 
  RowBox[{"SixJSymbol", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"JJ", ",", "i", ",", "FF"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"F", ",", "1", ",", "J"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8699200398338203`*^9, 3.869920059616773*^9}, {
  3.869920143924532*^9, 3.8699203322685776`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ab7be491-e7a1-42c6-b1cf-7ebdd9347a00"],

Cell[BoxData["\<\"decoupling prefactor before \
\[LeftAngleBracket]J'||\\!\\(\\*OverscriptBox[\\(d\\), \\(^\\)]\\)||J\
\[RightAngleBracket]\"\>"], "Output",
 CellChangeTimes->{{3.8699203119950466`*^9, 3.8699203329940124`*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"03aa14f3-3fd7-4c5c-86a1-e9fbb42da359"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   FractionBox["5", "2"]], "2"]], "Output",
 CellChangeTimes->{{3.8699203119950466`*^9, 3.8699203330002794`*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"ab8504f2-de70-4444-9a48-d24d4cb25635"],

Cell[BoxData["\<\"decoupling prefactor before \
\[LeftAngleBracket]J||\\!\\(\\*OverscriptBox[\\(d\\), \\(^\\)]\\)||J'\
\[RightAngleBracket]\"\>"], "Output",
 CellChangeTimes->{{3.8699203119950466`*^9, 3.8699203330002794`*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"4b274323-7c44-4036-9307-dad9df0294e4"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   FractionBox["5", "2"]], "2"]], "Output",
 CellChangeTimes->{{3.8699203119950466`*^9, 3.8699203330002794`*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"49436fa7-601d-400a-b0e6-911d8c559353"]
}, Open  ]]
},
WindowSize->{478.5, 503.5},
WindowMargins->{{Automatic, -3.75}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9081b4b0-4677-405c-af32-97482858b7ca"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4230, 134, 521, "Text",ExpressionUUID->"86c0f36f-0d39-4903-958a-77fa5cc90b64"],
Cell[4791, 156, 1187, 29, 157, "Text",ExpressionUUID->"73c59cf8-f8a2-4e80-94ea-979024df62b5"],
Cell[CellGroupData[{
Cell[6003, 189, 1415, 44, 157, "Input",ExpressionUUID->"deef4e50-9b68-4fad-85ad-826c5d43d4a9"],
Cell[7421, 235, 193, 2, 32, "Output",ExpressionUUID->"8e92e158-a632-46df-a4f7-fad118bcb49b"],
Cell[7617, 239, 207, 4, 52, "Output",ExpressionUUID->"c1ee3227-acd9-4696-8ac2-ab2a8382cfbb"],
Cell[7827, 245, 238, 3, 32, "Output",ExpressionUUID->"1401e709-90dd-40d0-a3ad-3489361f431d"],
Cell[8068, 250, 207, 4, 52, "Output",ExpressionUUID->"a14f948f-deb2-488e-9a00-874d1d607678"]
}, Open  ]],
Cell[8290, 257, 290, 7, 58, "Text",ExpressionUUID->"593099d4-0af1-4eb8-b594-7bba5f523ad8"],
Cell[CellGroupData[{
Cell[8605, 268, 1734, 53, 154, "Input",ExpressionUUID->"ab7be491-e7a1-42c6-b1cf-7ebdd9347a00"],
Cell[10342, 323, 305, 4, 34, "Output",ExpressionUUID->"03aa14f3-3fd7-4c5c-86a1-e9fbb42da359"],
Cell[10650, 329, 231, 5, 63, "Output",ExpressionUUID->"ab8504f2-de70-4444-9a48-d24d4cb25635"],
Cell[10884, 336, 305, 4, 34, "Output",ExpressionUUID->"4b274323-7c44-4036-9307-dad9df0294e4"],
Cell[11192, 342, 231, 5, 63, "Output",ExpressionUUID->"49436fa7-601d-400a-b0e6-911d8c559353"]
}, Open  ]]
}
]
*)

