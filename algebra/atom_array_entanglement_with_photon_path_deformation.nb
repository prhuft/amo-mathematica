(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    945806,      31019]
NotebookOptionsPosition[    896593,      30252]
NotebookOutlinePosition[    897002,      30268]
CellTagsIndexPosition[    896959,      30265]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Atom array entanglement by photon spatial mode deformation", "Section",
 CellChangeTimes->{{3.9207077797090454`*^9, 
  3.9207078140747538`*^9}},ExpressionUUID->"ba1bde64-675f-4fdc-ba2c-\
e1439a6494b2"],

Cell["\<\
See my \[OpenCurlyDoubleQuote]Bell state meas. entanglement swapping\
\[CloseCurlyDoubleQuote] handwritten algebra in my Rhodia dotpad, as well as \
Large array entanglement in Obsidian. The photonic part of the state is a \
4-ket, with labels (o,p) giving the BS2 output port (c or d) and polarization \
(H or V), so we can read off the effect of projective measurements for each \
of those four modes.\
\>", "Text",
 CellChangeTimes->{{3.92070781884976*^9, 3.9207078601743617`*^9}, {
   3.9208391134377975`*^9, 3.9208392380194907`*^9}, {3.9208392839115915`*^9, 
   3.9208392921896825`*^9}, {3.9208395989367905`*^9, 3.920839605551136*^9}, 
   3.9208400302523537`*^9},ExpressionUUID->"29422487-e01c-4f5b-96f8-\
401ca46f4c64"],

Cell[CellGroupData[{

Cell["Just two atoms - map mode 1 to 2 and vice versa", "Subsection",
 CellChangeTimes->{{3.9208982628761587`*^9, 3.920898275686413*^9}, {
  3.9209112700040255`*^9, 
  3.9209112771932592`*^9}},ExpressionUUID->"5a4b9c93-ce9d-4b4e-8634-\
03f724636300"],

Cell[TextData[{
 "Note that in my handwritten notes (the equation below comes from page 7, \
eq. 11), I use primed subscripts for the output of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "0ba9b831-5e06-45b2-b6fd-d3cff7e80475"],
 ". Here, I omit the primes, as c,d unambiguously refer to the c,d ports of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "e8f19347-9739-41cd-924e-a39a1d2de5cb"],
 ". \n\nInterestingly, this scheme has a lower probability of heralding Bell \
states compared to the standard Bell measurement scheme. This may be the \
reason that path deformation gate schemes typically initialize the different \
spins in a particular state rather than superpositions."
}], "Text",
 CellChangeTimes->{{3.920901720564152*^9, 3.920901795554597*^9}, {
  3.9209121207290125`*^9, 
  3.920912250976545*^9}},ExpressionUUID->"3e365bfd-2dc7-4001-ad74-\
26880ef4bed9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Ket", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"], ";"}]}], "Input",
 CellChangeTimes->{{3.9208425451993303`*^9, 3.920842552569414*^9}, {
  3.920842584840373*^9, 3.920842602216781*^9}, {3.9208426416163654`*^9, 
  3.9208426420897818`*^9}, {3.920842773439519*^9, 3.9208427859595356`*^9}, {
  3.9208983126438646`*^9, 3.920898372082747*^9}, {3.920903224708039*^9, 
  3.9209032319227448`*^9}, {3.92090542764618*^9, 3.9209054891300173`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"fdacad6e-79ce-458e-840c-bfde0bcb83eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]out", "=", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"1", ",", "2"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"1", ",", "2"}]]}]]}]}], " ", ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d1"]}]}], " ", 
              ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"2", ",", "1"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d1"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"2", ",", "1"}]]}]]}]}], " ", ")"}]}]}], ")"}]}]}], 
     "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]out", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9208983014527082`*^9, 3.9208983106025877`*^9}, {
  3.9208983737628946`*^9, 3.9208983887232723`*^9}, {3.9208984358232656`*^9, 
  3.920898591923049*^9}, {3.9209016845919504`*^9, 3.920901712014367*^9}, {
  3.920901939789465*^9, 3.9209019407240276`*^9}, {3.920902332629814*^9, 
  3.92090237181341*^9}, {3.920902406188398*^9, 3.920902408983692*^9}, {
  3.9209024399533453`*^9, 3.920902492528591*^9}, {3.9209025790340786`*^9, 
  3.9209026636628184`*^9}, {3.9209030942448826`*^9, 3.920903094352373*^9}, {
  3.9209032376531315`*^9, 3.9209032549953628`*^9}, {3.9209033231446137`*^9, 
  3.9209034397556295`*^9}, {3.920903474613057*^9, 3.920903502542235*^9}, {
  3.9209035527683725`*^9, 3.9209035623948717`*^9}, {3.9209053834207935`*^9, 
  3.9209053856799407`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"7b11d53e-138a-400a-8320-9f18181437e1"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.920902623728285*^9, 3.9209026579341955`*^9}, 
   3.920903094762336*^9, {3.920903239102376*^9, 3.920903255412464*^9}, 
   3.9209033293915825`*^9, 3.920903452252228*^9, 3.9209035040220175`*^9, 
   3.9209035634946175`*^9, {3.9209053915826855`*^9, 3.9209054176898527`*^9}, 
   3.920905448412149*^9, 3.9209054915938644`*^9, 3.9209060016476393`*^9},
 CellLabel->
  "Out[9]//TraditionalForm=",ExpressionUUID->"cf06a657-7707-4ce1-8038-\
3d1fffb392f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Psi]organized", "=", 
                RowBox[{"Collect", "[", 
                 RowBox[{"\[Psi]organized", ",", 
                  RowBox[{
                   SubscriptBox[
                    TemplateBox[{"atom1"},
                    "Ket"], "mode1"], 
                   SubscriptBox[
                    TemplateBox[{"atom2"},
                    "Ket"], "mode2"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920903573694778*^9, 3.920903574752097*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"990fd1e7-28a6-4d7c-9312-e3bbffd97cc4"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903525777152*^9, {3.920903568207063*^9, 3.9209035751443443`*^9}, {
   3.9209053950204105`*^9, 3.9209054199799986`*^9}, 3.9209054933797417`*^9, 
   3.9209060055955195`*^9},
 CellLabel->
  "Out[12]//TraditionalForm=",ExpressionUUID->"bb9323ff-e8c9-4118-b3e2-\
55ddb465a0e2"]
}, Open  ]],

Cell["\<\
Simplify the result by assuming we have some way to set the phases to zero \
(up to an overall phase).\
\>", "Text",
 CellChangeTimes->{{3.9209036135627894`*^9, 
  3.920903676611619*^9}},ExpressionUUID->"896e5c36-a1c9-46f7-a57a-\
04508d74523b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubscriptBox["\[Phi]h", 
    RowBox[{"1", ",", "2"}]], "=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]h", 
     RowBox[{"2", ",", "1"}]], "=", " ", 
    RowBox[{
     SubscriptBox["\[Phi]v", 
      RowBox[{"1", ",", "2"}]], "=", 
     RowBox[{
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]], "=", "0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92090369657924*^9, 3.920903721461937*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"0690dfcc-206d-4e78-91ba-71911753c963"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9209037220716763`*^9, 3.9209054067898936`*^9, 
  3.9209060103270197`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"ee458aa8-eb48-48c3-8127-51b21efb1a06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.920903730952004*^9, 3.9209037400216675`*^9}, {
  3.9209055148603096`*^9, 3.920905536043563*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"facdc40f-a6b7-42b6-9837-50bfb7291059"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"]}], "2"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "2"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c1"], " ", 
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c2"]}], "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "2"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903740481894*^9, {3.920905500046748*^9, 3.9209055365888615`*^9}, 
   3.9209060120884333`*^9},
 CellLabel->
  "Out[14]//TraditionalForm=",ExpressionUUID->"24905025-ee78-4c8a-addd-\
309eb1955ffa"]
}, Open  ]],

Cell["\<\
For two atoms, we will measure at most two photons, but there four output \
modes for each atom, giving 8 choose 2 possible patterns. Let\
\[CloseCurlyQuote]s see which measurement results herald which states. For \
now, let\[CloseCurlyQuote]s exclude the measurements in which two photons are \
detected with the same mode, although a number resolving detector, e.g. a \
qCMOS camera, could permit this. 

Let\[CloseCurlyQuote]s rewrite the operators in terms of the detector pixels, \
numbered 1-8, in order to simplify reading off the measurement results.\
\>", "Text",
 CellChangeTimes->{{3.920905151040154*^9, 
  3.920905206380886*^9}},ExpressionUUID->"93d1a0ec-dff0-4e4a-850c-\
872b93d4e463"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]detector", "=", 
   RowBox[{"\[Psi]organized", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "1"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "2"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "3"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "4"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "5"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "6"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "8"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]detector", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920904827280583*^9, 3.9209049192778716`*^9}, {
  3.9209049716906166`*^9, 3.9209050257403984`*^9}, {3.920905251680399*^9, 
  3.9209052677012835`*^9}, {3.9209052981516542`*^9, 3.9209053301802425`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"c9e9018a-b932-4be3-8db4-07588b8a1cbb"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "1", "2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"]}], "2"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "3", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "5", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "7", "2"], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "2"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "2", "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "2"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "4", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "6", "2"], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "8", "2"], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "2"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9},
 CellLabel->
  "Out[16]//TraditionalForm=",ExpressionUUID->"9be71920-6839-4e0b-901c-\
2ebd54059fbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Binomial", "[", 
   RowBox[{"8", ",", "2"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "number", " ", "of", " ", "possible", " ", "detection", " ", 
     "pairs", " ", "we", " ", "can", " ", "measure"}], ",", " ", 
    RowBox[{
     RowBox[{"ignoring", " ", "two"}], "-", 
     RowBox[{"photons", " ", "in", " ", "the", " ", "same", " ", "mode"}]}]}],
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.920904098066591*^9, 3.9209041105112143`*^9}, {
  3.920904282205758*^9, 3.920904358194461*^9}, {3.9209064433977146`*^9, 
  3.920906475864902*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"5f97363a-b724-40c4-b418-b6f6399c6f11"],

Cell[BoxData["28"], "Output",
 CellChangeTimes->{3.920904110983362*^9, 3.920904341481081*^9, 
  3.9209064815824275`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"3a396bdf-0dbd-4f9a-a2bf-feb00587a8d6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"measureIdx", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"det1", "=", "1"}], ",", 
    RowBox[{"det1", "<", "9"}], ",", 
    RowBox[{"det1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"det2", "=", "1"}], ",", 
       RowBox[{"det2", "<", "9"}], ",", 
       RowBox[{"det2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"det1", "!=", "det2"}], "&&", 
           RowBox[{"det2", ">", "det1"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{"avoids", " ", "redundant", " ", "values"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"measureIdx", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"measureIdx", ",", "\"\<: \>\"", ",", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"a", "\[ConjugateTranspose]"}], "det1"], 
               SubscriptBox[
                RowBox[{"a", "\[ConjugateTranspose]"}], "det2"]}], "//", 
              "TraditionalForm"}]}], "]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9209060591127863`*^9, 3.92090627440967*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"7df1503b-775a-4da1-95ed-78cce3ad250f"],

Cell[TextData[{
 "By inspection, there are no pairs of photons that would herald a state ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "5e967904-026f-4405-bb0c-b20e57679992"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "75b2a1b7-b5b7-463b-986d-c6a75f917539"],
 " or ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ec34afcb-8853-48b3-9974-4a87cbefcecd"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "bc370824-b1f9-4c7d-8b98-a9f3e2d8387c"],
 ", so we can break up \[Psi]out into two parts and analyze the coefficients \
to see which measurements herald which states. For now, we will assume the \
detectors are not number resolving and ignore the states with two photons in \
the same mode."
}], "Text",
 CellChangeTimes->{{3.920909496236785*^9, 3.9209095898884883`*^9}, {
  3.9209097149915366`*^9, 
  3.920909741874401*^9}},ExpressionUUID->"68a4fa9f-9829-4cf5-8093-\
4fc0538ab02f"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}]}], TraditionalForm]],
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9},ExpressionUUID->"58bb82d7-6c7d-493b-8480-\
82d1d4bd6187"]], "Text",
 CellChangeTimes->{{3.920908499708667*^9, 3.920908501992181*^9}, {
  3.920908884008483*^9, 
  3.9209088929508543`*^9}},ExpressionUUID->"4c8cbc99-5a1f-4e64-a72f-\
ce09177c4e47"],

Cell[TextData[{
 "8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"1674b82e-dfc0-48a3-9856-5e3c29e88587"],
 ": ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "23cd0ba7-3fae-43e9-806d-44f25d02c896"],
 ",  ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "061df3d5-dd48-41d1-839e-6edbe4a9838c"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "bfa1d27c-6479-4be5-bfd8-22d6f85f4c73"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "45d5ba89-32dc-4453-a84a-5349bad240f9"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "49b7458e-e023-4ca6-b64a-09b995c44694"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "1b29fc58-bd2d-4558-8c18-a5e0ed157a4c"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "03bce3eb-f03f-4715-9b89-022796a7ad09"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "78851bb7-672f-4bc1-aa80-012c41e5bbb7"],
 " \n\n8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"4e247f1f-e51c-4cdb-84af-9196eabf8d07"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ab7ab146-e1c8-4e9b-993b-94270e7d1665"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "abafd858-ae96-411d-803a-de8e37109527"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{
       RowBox[{" ", "a"}]},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "d3284f9b-b343-4b66-9973-448a5e12189a"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "d0a7d9ee-ca0b-4d7d-843b-ba5d30b0e948"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "931eaf31-7879-40cb-be29-c9932ae65eb6"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "9d649ae5-fc42-40de-a677-cfb81ddcff07"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "03a817e9-dd38-440e-bb12-79a6122b7c1c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "5ec72c7d-f835-4c86-8d40-e97d245b9fd9"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.9209094747263203`*^9}, {3.9209096048768697`*^9, 3.920909630876568*^9}, {
   3.9209096731675744`*^9, 
   3.9209096835364027`*^9}},ExpressionUUID->"9c447253-686b-4c3f-9f34-\
f313b746827c"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "1", "2"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "3", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "5", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "7", "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "2"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "2", "2"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "4", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "6", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "8", "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "2"]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",ExpressionUUID->"227d41a0-\
ccdf-4dbb-86df-3055b98a9a81"],

Cell[TextData[{
 "2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " "}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"bf24c486-6403-4ece-964f-826f8fc838d7"],
 "and 2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", "."}]}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"e93395ef-7d39-4af5-8fb8-be5c8c5c6bde"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.920909487348649*^9}, {3.9209096437272034`*^9, 3.9209097101183753`*^9}, {
   3.920909746659487*^9, 
   3.920909750477916*^9}},ExpressionUUID->"3b934450-60af-4722-b0fc-\
e7d5cdc8582a"],

Cell["\<\
16 patterns for heralding Bell states, each with an |amplitude| 1/4. 4 \
patterns which herald product states, each with |amplitude| 1/2. 8 two-photon \
patterns which we can\[CloseCurlyQuote]t resolve,  with |amplitude| 1/4. \
Normalize the state.\
\>", "Text",
 CellChangeTimes->{{3.920909783315935*^9, 
  3.9209099797394195`*^9}},ExpressionUUID->"0557cc37-1f00-46f0-b7c2-\
e7504ea1b706"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"norm", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"]}], "]"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "include", " ", "only", " ", "the", " ", "events", " ", "with", " ", 
    "photons", " ", "detected", " ", "in", " ", "different", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a Bell state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], "]"}], "/", 
  "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"68aa6622-3632-4376-ae06-2ef5b6c06471"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920910935549213*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"a05624dc-cc25-49fa-8070-1a4c4410f990"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355722184`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"0a12aa38-4467-4d9d-a528-5ae1391c7fa8"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"5c2468d5-cd72-419a-8c25-66340c54c8b0"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"374c60b7-b4be-496d-9e0c-39ef3226b19f"]
}, Open  ]],

Cell["\<\
However, if we normalize to all possible detection events including \
two-photons arriving at the same detector, we find the odds of getting a Bell \
state are actually slightly less than what would be achieved with the \
traditional Bell measurement scheme:\
\>", "Text",
 CellChangeTimes->{{3.9209109734262447`*^9, 
  3.9209111154142923`*^9}},ExpressionUUID->"14a3b6f0-50bf-4f65-8399-\
0a7ba3d27174"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "include", " ", "all", " ", "possible", " ", "detection", " ", "events"}],
     ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "even"}], " ", "those", " ", "with", 
     " ", "two", " ", "photons", " ", "detected", " ", "in", " ", "the", " ", 
     "same", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
  "\"\<Fraction of detection events which herald a Bell state:\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
   "]"}], "/", "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}, {3.9209111247604403`*^9, 
  3.920911231061555*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"1c7f3ea0-1f4a-4499-94e2-019055d35b18"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920911235927408*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"d94751fb-c01c-4140-86a6-eaf65669698c"],

Cell[BoxData[
 FractionBox["2", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"5b78c348-017c-404c-813d-2222c496fba7"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"10e74847-2f5b-4bb3-9cd5-c0bbc3e217e9"],

Cell[BoxData[
 FractionBox["3", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"9fecd32a-9cb8-49eb-8529-dfb677d22b03"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Just two atoms - map mode 1 to 2 but not vice versa", "Subsection",
 CellChangeTimes->{{3.9208982628761587`*^9, 3.920898275686413*^9}, {
  3.9209112700040255`*^9, 3.9209112771932592`*^9}, {3.920911316895923*^9, 
  3.92091131910925*^9}},ExpressionUUID->"74461a26-51b1-44f3-947d-\
27731a78d2cf"],

Cell[TextData[{
 "This choice of mapping is equivalent to truncating the sums in Eq. 11 with \
the condition that we are only mapping i to j > i, which is just nearest \
neighbor coupling. For the case of only two atoms, the sums over j for i=2 \
are zero. This case fares much worse compared to the previous mapping.\n\n\
Note that in my handwritten notes (the equation below comes from page 7, eq. \
11), I use primed subscripts for the output of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "44179251-640d-4de7-b88c-7df919ee0e51"],
 ". Here, I omit the primes, as c,d unambiguously refer to the c,d ports of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "052dbd83-1fcd-4e8d-beab-be8989218f23"],
 "."
}], "Text",
 CellChangeTimes->{{3.920901720564152*^9, 3.920901795554597*^9}, {
  3.920911422565625*^9, 3.920911568508524*^9}, {3.920912062347532*^9, 
  3.9209121131923265`*^9}},ExpressionUUID->"be1f3efc-36c4-4638-bab5-\
f49b0d7a1b01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Ket", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"], ";"}]}], "Input",
 CellChangeTimes->{{3.9208425451993303`*^9, 3.920842552569414*^9}, {
  3.920842584840373*^9, 3.920842602216781*^9}, {3.9208426416163654`*^9, 
  3.9208426420897818`*^9}, {3.920842773439519*^9, 3.9208427859595356`*^9}, {
  3.9208983126438646`*^9, 3.920898372082747*^9}, {3.920903224708039*^9, 
  3.9209032319227448`*^9}, {3.92090542764618*^9, 3.9209054891300173`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0e71092d-419a-45de-934e-fb8169158d33"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]out", "=", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"1", ",", "2"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"1", ",", "2"}]]}]]}]}], " ", ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}], 
           ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox[
             RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             SubscriptBox[
              RowBox[{"v", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}]}], 
        " ", ")"}]}]}], "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]out", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9208983014527082`*^9, 3.9208983106025877`*^9}, {
  3.9208983737628946`*^9, 3.9208983887232723`*^9}, {3.9208984358232656`*^9, 
  3.920898591923049*^9}, {3.9209016845919504`*^9, 3.920901712014367*^9}, {
  3.920901939789465*^9, 3.9209019407240276`*^9}, {3.920902332629814*^9, 
  3.92090237181341*^9}, {3.920902406188398*^9, 3.920902408983692*^9}, {
  3.9209024399533453`*^9, 3.920902492528591*^9}, {3.9209025790340786`*^9, 
  3.9209026636628184`*^9}, {3.9209030942448826`*^9, 3.920903094352373*^9}, {
  3.9209032376531315`*^9, 3.9209032549953628`*^9}, {3.9209033231446137`*^9, 
  3.9209034397556295`*^9}, {3.920903474613057*^9, 3.920903502542235*^9}, {
  3.9209035527683725`*^9, 3.9209035623948717`*^9}, {3.9209053834207935`*^9, 
  3.9209053856799407`*^9}, {3.9209116045216517`*^9, 3.9209116236462708`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"a6c338b6-cd6f-47c3-918d-62854ebf2d1b"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d2", "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d2", "2"]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.920902623728285*^9, 3.9209026579341955`*^9}, 
   3.920903094762336*^9, {3.920903239102376*^9, 3.920903255412464*^9}, 
   3.9209033293915825`*^9, 3.920903452252228*^9, 3.9209035040220175`*^9, 
   3.9209035634946175`*^9, {3.9209053915826855`*^9, 3.9209054176898527`*^9}, 
   3.920905448412149*^9, 3.9209054915938644`*^9, 3.9209060016476393`*^9, 
   3.9209116313760285`*^9},
 CellLabel->
  "Out[50]//TraditionalForm=",ExpressionUUID->"c1dcc0e5-f937-4f2b-9078-\
e17849a703e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Psi]organized", "=", 
                RowBox[{"Collect", "[", 
                 RowBox[{"\[Psi]organized", ",", 
                  RowBox[{
                   SubscriptBox[
                    TemplateBox[{"atom1"},
                    "Ket"], "mode1"], 
                   SubscriptBox[
                    TemplateBox[{"atom2"},
                    "Ket"], "mode2"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920903573694778*^9, 3.920903574752097*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"03788572-f6dc-46ca-a009-98da09215437"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c1"], " ", 
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c2"]}], "4"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903525777152*^9, {3.920903568207063*^9, 3.9209035751443443`*^9}, {
   3.9209053950204105`*^9, 3.9209054199799986`*^9}, 3.9209054933797417`*^9, 
   3.9209060055955195`*^9, 3.920911634238966*^9},
 CellLabel->
  "Out[53]//TraditionalForm=",ExpressionUUID->"db3feb37-dcd0-4ed3-ae6a-\
4e6f8c9cfa39"]
}, Open  ]],

Cell["\<\
Simplify the result by assuming we have some way to set the phases to zero \
(up to an overall phase).\
\>", "Text",
 CellChangeTimes->{{3.9209036135627894`*^9, 
  3.920903676611619*^9}},ExpressionUUID->"e7aa20f3-a582-4fb4-bf11-\
4e7ef6c4d600"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubscriptBox["\[Phi]h", 
    RowBox[{"1", ",", "2"}]], "=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]h", 
     RowBox[{"2", ",", "1"}]], "=", " ", 
    RowBox[{
     SubscriptBox["\[Phi]v", 
      RowBox[{"1", ",", "2"}]], "=", 
     RowBox[{
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]], "=", "0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92090369657924*^9, 3.920903721461937*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"b4e64dde-6ccb-4e34-9369-da601b1fc5b3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9209037220716763`*^9, 3.9209054067898936`*^9, 
  3.9209060103270197`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"ba495579-29fb-43a3-afb5-00d33316e075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.920903730952004*^9, 3.9209037400216675`*^9}, {
  3.9209055148603096`*^9, 3.920905536043563*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"d3c403b5-c16a-43a1-842f-ca9bf51ee1be"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c1"], " ", 
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c2"]}], "4"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903740481894*^9, {3.920905500046748*^9, 3.9209055365888615`*^9}, 
   3.9209060120884333`*^9, 3.9209116419722395`*^9},
 CellLabel->
  "Out[54]//TraditionalForm=",ExpressionUUID->"0be912b1-f449-4f18-84d9-\
661385adf732"]
}, Open  ]],

Cell["\<\
For two atoms, we will measure at most two photons, but there four output \
modes for each atom, giving 8 choose 2 possible patterns. Let\
\[CloseCurlyQuote]s see which measurement results herald which states. For \
now, let\[CloseCurlyQuote]s exclude the measurements in which two photons are \
detected with the same mode, although a number resolving detector, e.g. a \
qCMOS camera, could permit this. 

Let\[CloseCurlyQuote]s rewrite the operators in terms of the detector pixels, \
numbered 1-8, in order to simplify reading off the measurement results.\
\>", "Text",
 CellChangeTimes->{{3.920905151040154*^9, 
  3.920905206380886*^9}},ExpressionUUID->"7a3d8050-2414-4271-855f-\
78f170a6490a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]detector", "=", 
   RowBox[{"\[Psi]organized", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "1"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "2"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "3"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "4"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "5"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "6"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "->", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "8"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]detector", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920904827280583*^9, 3.9209049192778716`*^9}, {
  3.9209049716906166`*^9, 3.9209050257403984`*^9}, {3.920905251680399*^9, 
  3.9209052677012835`*^9}, {3.9209052981516542`*^9, 3.9209053301802425`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"e60cc60e-f8c7-452d-82e2-19c703fafe5d"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "5", "2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"]}], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "7", "2"], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "6", "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"a"},
          "ConjugateTranspose"], ")"}], "8", "2"], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9, 3.9209116540663304`*^9},
 CellLabel->
  "Out[56]//TraditionalForm=",ExpressionUUID->"9f6a901c-09a3-43a4-96cd-\
29bb5a0911f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Binomial", "[", 
   RowBox[{"8", ",", "2"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "the", " ", "number", " ", "of", " ", "possible", " ", "detection", " ", 
     "pairs", " ", "we", " ", "can", " ", "measure"}], ",", " ", 
    RowBox[{
     RowBox[{"ignoring", " ", "two"}], "-", 
     RowBox[{"photons", " ", "in", " ", "the", " ", "same", " ", "mode"}]}]}],
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.920904098066591*^9, 3.9209041105112143`*^9}, {
  3.920904282205758*^9, 3.920904358194461*^9}, {3.9209064433977146`*^9, 
  3.920906475864902*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"c4b6d782-444f-45ec-ae82-b6c7aae69da9"],

Cell[BoxData["28"], "Output",
 CellChangeTimes->{3.920904110983362*^9, 3.920904341481081*^9, 
  3.9209064815824275`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"32d229da-1430-42b2-97d0-ca915bc96cc4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"measureIdx", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"det1", "=", "1"}], ",", 
    RowBox[{"det1", "<", "9"}], ",", 
    RowBox[{"det1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"det2", "=", "1"}], ",", 
       RowBox[{"det2", "<", "9"}], ",", 
       RowBox[{"det2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"det1", "!=", "det2"}], "&&", 
           RowBox[{"det2", ">", "det1"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{"avoids", " ", "redundant", " ", "values"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"measureIdx", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"measureIdx", ",", "\"\<: \>\"", ",", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"a", "\[ConjugateTranspose]"}], "det1"], 
               SubscriptBox[
                RowBox[{"a", "\[ConjugateTranspose]"}], "det2"]}], "//", 
              "TraditionalForm"}]}], "]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9209060591127863`*^9, 3.92090627440967*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"8f801a6b-cab4-44df-9c21-cdbceca4aed9"],

Cell[TextData[{
 "By inspection, there are no pairs of photons that would herald a state ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "27595f53-3386-4d75-9cfa-20312fb2da08"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "b5572b87-d0fd-4368-ae71-b728ff86be71"],
 " or ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "a27b2e1a-1b4d-45da-9021-52347835806e"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "05504909-ce90-4260-a450-aa4418cd7016"],
 ", so we can break up \[Psi]out into two parts and analyze the coefficients \
to see which measurements herald which states. For now, we will assume the \
detectors are not number resolving and ignore the states with two photons in \
the same mode."
}], "Text",
 CellChangeTimes->{{3.920909496236785*^9, 3.9209095898884883`*^9}, {
  3.9209097149915366`*^9, 
  3.920909741874401*^9}},ExpressionUUID->"d1d8315a-6a95-4b06-ad62-\
b3f5f38e8960"],

Cell[TextData[{
 "4 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " "}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"a6dc7381-a4c9-47e7-94a1-03b090173ff7"],
 "and 4 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", "."}]}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"e34e38eb-f955-4bd6-9b1b-dcd32156a423"]
}], "Text",
 CellChangeTimes->{{3.920908499708667*^9, 3.920908501992181*^9}, {
   3.920908884008483*^9, 3.9209088929508543`*^9}, 3.9209117096115294`*^9, 
   3.9209118465981703`*^9, {3.9209118828106565`*^9, 
   3.9209119010353756`*^9}},ExpressionUUID->"1f1cba31-d2f1-4bfb-9fb7-\
c19ef0cb5254"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "5", "2"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"]}], "4"], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "7", "2"], "4"], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "4"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "6", "2"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"]}], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "8", "2"], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "4"]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",
 CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
  3.920911853714732*^9, 
  3.9209118594440703`*^9}},ExpressionUUID->"2f2148e4-7ae5-472a-aa94-\
5e4cc38cffa5"],

Cell[TextData[{
 "2 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"87309745-3d18-46d6-ae69-16eff7ea5b59"],
 ": ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
   3.920911853714732*^9, 3.9209118594440703`*^9}},ExpressionUUID->
  "0f9c248b-62e2-41e4-af53-e6c202427aed"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"]}]],
  CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
   3.920911853714732*^9, 3.9209118594440703`*^9}},ExpressionUUID->
  "fe6e0b02-e3ed-486c-90d9-7aa16993a694"],
 "\n\n2 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"9e2c4e2b-552f-4660-96fb-aa2ab1429323"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"]}], TraditionalForm]],
  CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
   3.920911853714732*^9, 3.9209118594440703`*^9}},ExpressionUUID->
  "c4f6cae9-46c4-4f7a-a658-0eb4c95e7d34"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"]}], TraditionalForm]],
  CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
   3.920911853714732*^9, 3.9209118594440703`*^9}},ExpressionUUID->
  "73afa022-88d6-4e60-a986-c7d6169a9e26"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.9209094747263203`*^9}, {3.9209096048768697`*^9, 3.920909630876568*^9}, {
   3.9209096731675744`*^9, 3.9209096835364027`*^9}, {3.9209117318070316`*^9, 
   3.920911740673229*^9}, {3.9209119374834394`*^9, 
   3.9209120342418976`*^9}},ExpressionUUID->"171aeb0f-f8bf-4bf9-a168-\
e6aa6f59f44b"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"]}], "4"], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"]}], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "4"], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"]}], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"]}], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "4"], "-", 
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",
 CellChangeTimes->{{3.92091172090933*^9, 3.9209117263240275`*^9}, {
  3.920911853714732*^9, 
  3.9209118594440703`*^9}},ExpressionUUID->"067848ad-d8f9-4e2b-98ad-\
e7552d3288af"],

Cell["\<\
16 patterns for heralding Bell states, each with an |amplitude| 1/4. 4 \
patterns which herald product states, each with |amplitude| 1/2. 8 two-photon \
patterns which we can\[CloseCurlyQuote]t resolve,  with |amplitude| 1/4. \
Normalize the state.\
\>", "Text",
 CellChangeTimes->{{3.920909783315935*^9, 
  3.9209099797394195`*^9}},ExpressionUUID->"d8717362-dc76-4d2e-8543-\
710a1d5de05a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"norm", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"]}], "]"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "include", " ", "only", " ", "the", " ", "events", " ", "with", " ", 
    "photons", " ", "detected", " ", "in", " ", "different", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a Bell state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], "]"}], "/", 
  "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"78f4fb49-849d-49d2-9a79-5a5745ecb6f6"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920910935549213*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"24957581-0bdd-4c67-b3a1-8fbb661cc192"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355722184`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"db5e49b8-1376-4612-bbf3-98df9e5a932f"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"3f357d42-32f5-493c-8fc2-d762782d5dfa"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"49cdc155-ee31-479e-a0b4-0029604078df"]
}, Open  ]],

Cell["\<\
However, if we normalize to all possible detection events including \
two-photons arriving at the same detector, we find the odds of getting a Bell \
state are actually slightly less than what would be achieved with the \
traditional Bell measurement scheme:\
\>", "Text",
 CellChangeTimes->{{3.9209109734262447`*^9, 
  3.9209111154142923`*^9}},ExpressionUUID->"2307627d-788d-4eb5-9e45-\
29fe98da7523"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "include", " ", "all", " ", "possible", " ", "detection", " ", "events"}],
     ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "even"}], " ", "those", " ", "with", 
     " ", "two", " ", "photons", " ", "detected", " ", "in", " ", "the", " ", 
     "same", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
  "\"\<Fraction of detection events which herald a Bell state:\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
   "]"}], "/", "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}, {3.9209111247604403`*^9, 
  3.920911231061555*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"d2ad43f7-b950-492f-b991-0626d563a862"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920911235927408*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"4ee9bc86-1dc0-455a-af62-22c91f2fd9ed"],

Cell[BoxData[
 FractionBox["2", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"32650325-5a48-485d-a441-c61333c74ceb"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"5137b8be-60f8-4d9c-8c8a-709398a355d6"],

Cell[BoxData[
 FractionBox["3", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"2db8aa03-379f-4427-939a-141fd50ea173"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Just two atoms - programmatically get measurement outcomes", \
"Subsection",
 CellChangeTimes->{{3.9208982628761587`*^9, 3.920898275686413*^9}, {
   3.9209112700040255`*^9, 3.9209112771932592`*^9}, {3.9211003748650594`*^9, 
   3.92110040043661*^9}, {3.9215172819233246`*^9, 3.9215172920915737`*^9}, {
   3.921517461056675*^9, 3.921517461729881*^9}, {3.92209787834921*^9, 
   3.9220978947811427`*^9}, 
   3.9220993054972754`*^9},ExpressionUUID->"796a3f33-c13b-422a-b4df-\
ddf7327eb9fc"],

Cell[TextData[{
 "Note that in my handwritten notes (the equation below comes from page 7, \
eq. 11), I use primed subscripts for the output of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "72fa82cd-0c18-4390-b56b-204d510e4fa9"],
 ". Here, I omit the primes, as c,d unambiguously refer to the c,d ports of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "3af283b9-55fb-4420-adaf-f8880e72d66b"],
 ". \n\nInterestingly, this scheme has a lower probability of heralding Bell \
states compared to the standard Bell measurement scheme. This may be the \
reason that path deformation gate schemes typically initialize the different \
spins in a particular state rather than superpositions."
}], "Text",
 CellChangeTimes->{{3.920901720564152*^9, 3.920901795554597*^9}, {
  3.9209121207290125`*^9, 
  3.920912250976545*^9}},ExpressionUUID->"06e59ceb-0948-493c-a1c9-\
53158f48f94f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Ket", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"], ";"}]}], "Input",
 CellChangeTimes->{{3.9208425451993303`*^9, 3.920842552569414*^9}, {
  3.920842584840373*^9, 3.920842602216781*^9}, {3.9208426416163654`*^9, 
  3.9208426420897818`*^9}, {3.920842773439519*^9, 3.9208427859595356`*^9}, {
  3.9208983126438646`*^9, 3.920898372082747*^9}, {3.920903224708039*^9, 
  3.9209032319227448`*^9}, {3.92090542764618*^9, 3.9209054891300173`*^9}},
 CellLabel->
  "In[1359]:=",ExpressionUUID->"6d23b60c-70a1-4aba-8d6e-85c11339850d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]out", "=", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"1", ",", "2"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"1", ",", "2"}]]}]]}]}], " ", ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d1"]}]}], " ", 
              ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"2", ",", "1"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d1"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"2", ",", "1"}]]}]]}]}], " ", ")"}]}]}], ")"}]}]}], 
     "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]out", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9208983014527082`*^9, 3.9208983106025877`*^9}, {
  3.9208983737628946`*^9, 3.9208983887232723`*^9}, {3.9208984358232656`*^9, 
  3.920898591923049*^9}, {3.9209016845919504`*^9, 3.920901712014367*^9}, {
  3.920901939789465*^9, 3.9209019407240276`*^9}, {3.920902332629814*^9, 
  3.92090237181341*^9}, {3.920902406188398*^9, 3.920902408983692*^9}, {
  3.9209024399533453`*^9, 3.920902492528591*^9}, {3.9209025790340786`*^9, 
  3.9209026636628184`*^9}, {3.9209030942448826`*^9, 3.920903094352373*^9}, {
  3.9209032376531315`*^9, 3.9209032549953628`*^9}, {3.9209033231446137`*^9, 
  3.9209034397556295`*^9}, {3.920903474613057*^9, 3.920903502542235*^9}, {
  3.9209035527683725`*^9, 3.9209035623948717`*^9}, {3.9209053834207935`*^9, 
  3.9209053856799407`*^9}},
 CellLabel->
  "In[1366]:=",ExpressionUUID->"df02de35-0a1e-47f0-aa0e-65e0f2acb4b6"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.920902623728285*^9, 3.9209026579341955`*^9}, 
   3.920903094762336*^9, {3.920903239102376*^9, 3.920903255412464*^9}, 
   3.9209033293915825`*^9, 3.920903452252228*^9, 3.9209035040220175`*^9, 
   3.9209035634946175`*^9, {3.9209053915826855`*^9, 3.9209054176898527`*^9}, 
   3.920905448412149*^9, 3.9209054915938644`*^9, 3.9209060016476393`*^9, 
   3.921517476862832*^9, 3.9220993117210507`*^9},
 CellLabel->
  "Out[1367]//TraditionalForm=",ExpressionUUID->"7b047a85-9794-4137-87cd-\
f0c4fb00ea56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Psi]organized", "=", 
                RowBox[{"Collect", "[", 
                 RowBox[{"\[Psi]organized", ",", 
                  RowBox[{
                   SubscriptBox[
                    TemplateBox[{"atom1"},
                    "Ket"], "mode1"], 
                   SubscriptBox[
                    TemplateBox[{"atom2"},
                    "Ket"], "mode2"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920903573694778*^9, 3.920903574752097*^9}},
 CellLabel->
  "In[1368]:=",ExpressionUUID->"538848c2-2f5c-4e4a-8d3a-a82576bfbbc0"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c1"], " ", 
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c2"]}], "2"]}], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903525777152*^9, {3.920903568207063*^9, 3.9209035751443443`*^9}, {
   3.9209053950204105`*^9, 3.9209054199799986`*^9}, 3.9209054933797417`*^9, 
   3.9209060055955195`*^9, 3.9215174794238844`*^9, 3.922099313564149*^9},
 CellLabel->
  "Out[1370]//TraditionalForm=",ExpressionUUID->"9f29417c-5d8a-4010-94fe-\
1b94c190a2b3"]
}, Open  ]],

Cell["\<\
Simplify the result by assuming we have some way to set the phases to zero \
(up to an overall phase).\
\>", "Text",
 CellChangeTimes->{{3.9209036135627894`*^9, 
  3.920903676611619*^9}},ExpressionUUID->"27f2d663-6a66-42e0-989c-\
5afa5d2745c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubscriptBox["\[Phi]h", 
    RowBox[{"1", ",", "2"}]], "=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]h", 
     RowBox[{"2", ",", "1"}]], "=", " ", 
    RowBox[{
     SubscriptBox["\[Phi]v", 
      RowBox[{"1", ",", "2"}]], "=", 
     RowBox[{
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]], "=", "0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92090369657924*^9, 3.920903721461937*^9}},
 CellLabel->
  "In[1371]:=",ExpressionUUID->"c554fefb-18d0-4887-84ff-0add0a46e6e0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9209037220716763`*^9, 3.9209054067898936`*^9, 
  3.9209060103270197`*^9, 3.922099316430296*^9},
 CellLabel->
  "Out[1371]=",ExpressionUUID->"b5b9689a-6dd1-4fc5-be23-c29f272881f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Natoms", " ", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nModes", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSubscript", "[", "op_", "]"}], ":=", 
   RowBox[{"StringSplit", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"op", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPolarization", "[", "op_", "]"}], ":=", 
   RowBox[{"StringTake", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "op", "]"}], ",", "\"\<]\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getADagger", "[", "hvDagger_", "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<a\>\"", ",", 
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "hvDagger", "]"}], ",", 
                  "\"\<]\>\""}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "==", "\"\<h\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
          ",", "1", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<v\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
          ",", "2", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<h\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
          ",", "3", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<v\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
          ",", "4"}], "]"}], "+", 
        RowBox[{"4", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
       "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opList", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      SubscriptBox[
       RowBox[{"u", "\[ConjugateTranspose]"}], 
       RowBox[{"ToExpression", "[", 
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<````\>\"", ",", "port", ",", "mode"}], "]"}], "]"}], 
        "]"}]], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", "v"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"port", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mode", ",", 
        RowBox[{"Range", "[", "nModes", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]detector", "=", 
   RowBox[{"\[Psi]organized", "/.", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"op", "->", 
       RowBox[{"getADagger", "[", "op", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"op", ",", "opList"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modeList", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mode1", "!=", "mode2"}], ",", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"atom1"},
           "Ket"], "mode1"], 
         SubscriptBox[
          TemplateBox[{"atom2"},
           "Ket"], "mode2"]}], ",", "Nothing"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mode1", ",", 
        RowBox[{"Range", "[", "Natoms", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mode2", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"mode1", ",", "Natoms"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"atom1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"atom2", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atomicCoefficients", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"\[Psi]detector", ",", 
        RowBox[{"modeList", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Length", "[", "modeList", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aOps", "=", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<a\>\"", ",", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "]"}], 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<a\>\"", ",", 
           RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"4", "*", "Natoms"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "i", ",", 
         RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "each", " ", "row", " ", "corresponds", " ", "to", " ", "a", " ", "given",
      " ", "atomic", " ", "mode"}], ",", " ", 
    RowBox[{
    "where", " ", "the", " ", "list", " ", "entries", " ", "are", " ", "the", 
     " ", "coefficents", " ", "for", " ", "each", " ", "operator", " ", 
     "product"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amplitudeMap", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"atomicCoefficients", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
       "aOps"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "modeList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"states", "=", 
   RowBox[{"Transpose", "@", "amplitudeMap"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uniqueStates", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"states", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", 
     RowBox[{"Norm", "[", 
      RowBox[{"states", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "states", " ", "only", " ", "differ", " ", "by", " ", "an", " ",
     "overall", " ", "prefactor", " ", "they", " ", "are", " ", "not", " ", 
    RowBox[{"unique", ".", " ", "converse"}], " ", "is", " ", "true"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"normed", "=", "Nothing"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"Length", "[", 
      RowBox[{"states", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "states", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"states", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "!=", "zeros"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"normed", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "*)"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"Dot", "[", 
                  RowBox[{"normed", ",", 
                   RowBox[{"uniqueStates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], "&"}], 
               ",", 
               RowBox[{"Length", "[", "uniqueStates", "]"}]}], "]"}], ",", 
             "1"}], "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"uniqueStates", ",", "normed"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<unique heralded states:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{"uniqueStates", ",", "modeList"}], "]"}], "//", "FullSimplify"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"statesAndHeralds", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"states", ",", "aOps"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateMatchesAndHeralds", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "statesAndHeralds", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"stateMatchesAndHeralds", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"uniqueStates", ".", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"statesAndHeralds", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"statesAndHeralds", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nUniqueStates", "=", 
   RowBox[{"Length", "[", "uniqueStates", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heraldPatternsByState", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uniqueStates", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "}"}], "&"}], ",", "nUniqueStates"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heraldPatternsByStateKetNotation", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Dot", "[", 
          RowBox[{
           RowBox[{"uniqueStates", "[", 
            RowBox[{"[", "#", "]"}], "]"}], ",", "modeList"}], "]"}], "//", 
         "FullSimplify"}], ",", 
        RowBox[{"{", "}"}]}], "}"}], "&"}], ",", "nUniqueStates"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateIndices", "=", 
   RowBox[{"Range", "[", "nUniqueStates", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", 
     RowBox[{
      RowBox[{"Length", "[", "statesAndHeralds", "]"}], "+", "1"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateIndex", "=", 
      RowBox[{"stateIndices", ".", 
       RowBox[{"(", 
        RowBox[{"Abs", "[", 
         RowBox[{"uniqueStates", ".", 
          RowBox[{"Normalize", "[", 
           RowBox[{"statesAndHeralds", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"stateIndex", "!=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"heraldPatternsByState", "[", 
           RowBox[{"[", 
            RowBox[{"stateIndex", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"statesAndHeralds", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"heraldPatternsByStateKetNotation", "[", 
           RowBox[{"[", 
            RowBox[{"stateIndex", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"statesAndHeralds", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<heralded states and corresponding detector patterns\>\"",
    "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TableForm", "[", 
    RowBox[{"heraldPatternsByStateKetNotation", ",", 
     RowBox[{"TableDirections", "\[Rule]", "Row"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"heraldPatternsByStateKetNotation", ",", 
   RowBox[{"Frame", "->", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9220957910668836`*^9, 3.922095821433636*^9}, {
  3.922096394915558*^9, 3.9220964166324406`*^9}, {3.922096454100556*^9, 
  3.9220964831320815`*^9}, {3.922096605982031*^9, 3.922096741582203*^9}, {
  3.9220980960070457`*^9, 3.9220982230828867`*^9}, {3.9220982571315355`*^9, 
  3.9220983133820906`*^9}, {3.9220983916974115`*^9, 3.9220985144836273`*^9}, {
  3.9220985532000046`*^9, 3.9220986661144314`*^9}, {3.92209872228168*^9, 
  3.922098733697819*^9}, {3.9220987902368526`*^9, 3.9220987955643835`*^9}, {
  3.9220988894627314`*^9, 3.922098902130704*^9}, {3.922098952155588*^9, 
  3.922098984897436*^9}, {3.922099106863735*^9, 3.9220991083140106`*^9}, {
  3.9220991470143943`*^9, 3.922099147398973*^9}},
 CellLabel->
  "In[1372]:=",ExpressionUUID->"e3380705-cf9f-4909-836b-2e125089f6d8"],

Cell[CellGroupData[{

Cell[BoxData["\<\"unique heralded states:\"\>"], "Print",
 CellChangeTimes->{
  3.9220981865254545`*^9, {3.9220982174842505`*^9, 3.9220982237476983`*^9}, {
   3.9220984754809914`*^9, 3.922098497064235*^9}, 3.9220985619151516`*^9, {
   3.922098602214319*^9, 3.9220986126910563`*^9}, {3.9220986460992727`*^9, 
   3.92209866638715*^9}, 3.9220987342329416`*^9, 3.922098807416748*^9, 
   3.9220989025477767`*^9, {3.9220989620810623`*^9, 3.9220989854106026`*^9}, 
   3.9220991810872574`*^9, 3.9220993176843576`*^9},
 CellLabel->
  "During evaluation of \
In[1372]:=",ExpressionUUID->"fe2a717c-63af-4b74-b950-be79b2f96437"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "1"]}], "-", 
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "2"]}]}], ")"}]}], 
    SqrtBox["2"]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.9220981865254545`*^9, {3.9220982174842505`*^9, 3.9220982237476983`*^9}, {
   3.9220984754809914`*^9, 3.922098497064235*^9}, 3.9220985619151516`*^9, {
   3.922098602214319*^9, 3.9220986126910563`*^9}, {3.9220986460992727`*^9, 
   3.92209866638715*^9}, 3.9220987342329416`*^9, 3.922098807416748*^9, 
   3.9220989025477767`*^9, {3.9220989620810623`*^9, 3.9220989854106026`*^9}, 
   3.9220991810872574`*^9, 3.92209931774657*^9},
 CellLabel->
  "During evaluation of \
In[1372]:=",ExpressionUUID->"18407e81-b41f-415f-871c-3444659b88b9"],

Cell[BoxData["\<\"heralded states and corresponding detector patterns\"\>"], \
"Print",
 CellChangeTimes->{
  3.9220981865254545`*^9, {3.9220982174842505`*^9, 3.9220982237476983`*^9}, {
   3.9220984754809914`*^9, 3.922098497064235*^9}, 3.9220985619151516`*^9, {
   3.922098602214319*^9, 3.9220986126910563`*^9}, {3.9220986460992727`*^9, 
   3.92209866638715*^9}, 3.9220987342329416`*^9, 3.922098807416748*^9, 
   3.9220989025477767`*^9, {3.9220989620810623`*^9, 3.9220989854106026`*^9}, 
   3.9220991810872574`*^9, 3.92209931776366*^9},
 CellLabel->
  "During evaluation of \
In[1372]:=",ExpressionUUID->"a6e3e227-aa45-4eb8-92a5-d65afbdea414"]
}, Open  ]],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"]}], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["a1", "2"], ",", 
       RowBox[{"a1", " ", "a5"}], ",", 
       SuperscriptBox["a3", "2"], ",", 
       RowBox[{"a3", " ", "a7"}], ",", 
       SuperscriptBox["a5", "2"], ",", 
       SuperscriptBox["a7", "2"]}], "}"}]},
    {
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], " ", 
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"]}], "-", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], " ", 
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"]}]}], ")"}]}], 
      SqrtBox["2"]], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a1", " ", "a2"}], ",", 
       RowBox[{"a1", " ", "a6"}], ",", 
       RowBox[{"a2", " ", "a5"}], ",", 
       RowBox[{"a3", " ", "a4"}], ",", 
       RowBox[{"a3", " ", "a8"}], ",", 
       RowBox[{"a4", " ", "a7"}], ",", 
       RowBox[{"a5", " ", "a6"}], ",", 
       RowBox[{"a7", " ", "a8"}]}], "}"}]},
    {
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], 
       SqrtBox["2"]]}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a1", " ", "a4"}], ",", 
       RowBox[{"a1", " ", "a8"}], ",", 
       RowBox[{"a2", " ", "a3"}], ",", 
       RowBox[{"a2", " ", "a7"}], ",", 
       RowBox[{"a3", " ", "a6"}], ",", 
       RowBox[{"a4", " ", "a5"}], ",", 
       RowBox[{"a5", " ", "a8"}], ",", 
       RowBox[{"a6", " ", "a7"}]}], "}"}]},
    {
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "2"]}], 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["a2", "2"], ",", 
       RowBox[{"a2", " ", "a6"}], ",", 
       SuperscriptBox["a4", "2"], ",", 
       RowBox[{"a4", " ", "a8"}], ",", 
       SuperscriptBox["a6", "2"], ",", 
       SuperscriptBox["a8", "2"]}], "}"}]}
   },
   AutoDelete->False,
   GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.922098147581748*^9, 3.9220981865973406`*^9, {3.922098217530548*^9, 
   3.9220982237977686`*^9}, {3.9220984754647655`*^9, 3.922098497030656*^9}, 
   3.922098561963885*^9, {3.922098602280478*^9, 3.9220986127964478`*^9}, {
   3.922098646147173*^9, 3.9220986665474396`*^9}, 3.9220987342803717`*^9, 
   3.9220988074635296`*^9, 3.92209890261383*^9, {3.922098962148327*^9, 
   3.92209898548069*^9}, 3.9220991811321945`*^9, 3.922099317780135*^9},
 CellLabel->
  "Out[1398]=",ExpressionUUID->"41456e99-cf46-4a04-8775-0b12ca084f4f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["testing ", "Section",
 CellChangeTimes->{{3.920707723417277*^9, 3.9207077304080763`*^9}, {
  3.920842835039398*^9, 
  3.920842835369291*^9}},ExpressionUUID->"27b89521-e416-4a44-b265-\
3b8020c27432"],

Cell[CellGroupData[{

Cell["\<\
attempt to get the state up to a prefactor - uses the states with explicit \
kets (too difficult)\
\>", "Subsubsection",
 CellChangeTimes->{{3.921952408554228*^9, 3.921952457319995*^9}, {
  3.9219525486372576`*^9, 3.9219525667196684`*^9}, {3.922099086196821*^9, 
  3.9220990890475173`*^9}},ExpressionUUID->"054d14d8-8100-4e97-aa83-\
8b6f76a26375"],

Cell["\<\
-- this is really tough using the form the validStates list which includes \
the kets explicitly.\
\>", "Text",
 CellChangeTimes->{{3.921952459244253*^9, 
  3.921952472236169*^9}},ExpressionUUID->"f45dc3c2-92bb-44f4-a87f-\
74aa9f92effb"],

Cell["\<\
I may still want to get the states without prefactors for the sake of \
grouping, but how can I correctly factor out the part with the kets?\
\>", "Text",
 CellChangeTimes->{{3.9215326245893717`*^9, 3.9215326337240314`*^9}, {
  3.9215326951383734`*^9, 
  3.92153274195618*^9}},ExpressionUUID->"8998201f-8ee9-4eee-a720-\
a167e356c09e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getStateWithoutPrefactors", "[", 
  RowBox[{"validStates", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215314434557943`*^9, 3.9215314435884123`*^9}, {
  3.921531965272497*^9, 3.9215319768784857`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"562bd3fd-16f1-4df0-a05a-b623f1cec7c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.921531968154346*^9, 3.9215319773264375`*^9}},
 CellLabel->
  "Out[558]=",ExpressionUUID->"cd64fe7b-09dc-494a-a45c-524db1c8e9f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "1"]}], "-", 
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "2"]}]}], ")"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"x_", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"___", 
        SubscriptBox[
         TemplateBox[{"___"},
          "Ket"], "___"]}], "+", "___"}], ")"}]}], "->", "x"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.92195115625362*^9, 3.921951224872484*^9}, {
  3.921951261837378*^9, 3.9219512822559185`*^9}},
 CellLabel->
  "In[688]:=",ExpressionUUID->"ea8aadc3-f636-439e-8ddd-8abaad73e6c9"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox["\[ImaginaryI]", "4"], "}"}]], "Output",
 CellChangeTimes->{{3.921951190819186*^9, 3.921951225286273*^9}, {
  3.921951262371809*^9, 3.9219512831879487`*^9}},
 CellLabel->
  "Out[688]=",ExpressionUUID->"c056c3b9-04eb-4623-8f50-49f1ab04afc6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}], ",", 
     RowBox[{"4", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "5"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x_Number", " ", "___", 
      SubscriptBox[
       TemplateBox[{"_"},
        "Ket"], "_"], 
      FractionBox["1", "x_Integer"]}], "|", " ", 
     RowBox[{"___", 
      SubscriptBox[
       TemplateBox[{"_"},
        "Ket"], "_"]}]}], "->", "x"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921951300704291*^9, 3.921951388388414*^9}, {
  3.92195174578823*^9, 3.9219519236701555`*^9}, {3.92195196205402*^9, 
  3.9219519679864264`*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"845a21e8-f92b-4aca-8967-879001bf731c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", " ", "c"}], ",", 
     RowBox[{"b", " ", "b"}], ",", 
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], " ", "b"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x_Rational", " ", "___"}], "|", "x_Complex"}], "->", "x"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9219519732054896`*^9, 3.921952071703706*^9}, {
  3.9219521091398473`*^9, 3.921952114136363*^9}, {3.9219521544026337`*^9, 
  3.9219521590855885`*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"9ffe797c-2ab8-4fdb-b461-db6e7e8a3eb5"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.921951320271327*^9, 3.921951389187151*^9}, {
   3.92195174805246*^9, 3.9219517792035284`*^9}, {3.9219518205211554`*^9, 
   3.92195192421896*^9}, 3.921951968602388*^9, {3.9219520152206326`*^9, 
   3.921952072902497*^9}, {3.9219521106217318`*^9, 3.9219521145687094`*^9}, 
   3.921952159519247*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"108246b0-5743-4e59-8107-836f16f03d75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "[", 
  FractionBox["\[ImaginaryI]", "2"], "]"}]], "Input",
 CellChangeTimes->{{3.9219521466046457`*^9, 3.921952149469813*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"bea5723d-6cd9-4df7-a77a-caff34e71cbe"],

Cell[BoxData["Complex"], "Output",
 CellChangeTimes->{3.9219521498024316`*^9},
 CellLabel->
  "Out[731]=",ExpressionUUID->"466c3eaa-f0c7-4daf-a164-f5496b944feb"]
}, Open  ]],

Cell[BoxData["Inte"], "Input",
 CellChangeTimes->{{3.9219520767878537`*^9, 
  3.9219520823370132`*^9}},ExpressionUUID->"5aa980e3-a9f4-497e-b02d-\
da780356dd7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}], ",", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"]}], " ", ",", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], " ", "}"}], ",", 
   RowBox[{"Product", "[", 
    RowBox[{
     TemplateBox[{"_"},
      "Ket"], ",", "___"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921951446521107*^9, 3.9219515241557684`*^9}},
 CellLabel->
  "In[701]:=",ExpressionUUID->"81b7ea50-1cc5-4983-b090-18bbfa1b603a"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.9219514729704976`*^9, {3.9219515067528563`*^9, 3.9219515246052237`*^9}},
 CellLabel->
  "Out[701]=",ExpressionUUID->"1b94b0f0-0f49-4280-946a-ae0cd85e6e2c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "try", " ", "to", " ", "find", " ", "the", " ", "ket", " ", "part", " ", 
     "of", " ", "the", " ", "states"}], ",", " ", 
    RowBox[{
    "so", " ", "we", " ", "can", " ", "group", " ", "the", " ", "op", " ", 
     "products", " ", "into", " ", "lists", " ", "for", " ", "a", " ", 
     "particular", " ", "state", " ", "they", " ", "herald"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exampleList", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "2"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SubscriptBox[
             TemplateBox[{"0"},
              "Ket"], "2"]}], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SubscriptBox[
             TemplateBox[{"0"},
              "Ket"], "2"]}], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "2"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "+", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"Q"},
             "Ket"], "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "replace", " ", "with", " ", "the", " ", "validStates", " ", "later"}], 
     ",", " ", 
     RowBox[{
     "so", " ", "we", " ", "can", " ", "grab", " ", "the", " ", "ops", " ", 
      "as", " ", "we", " ", "go"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statePatterns", "=", 
     RowBox[{"{", 
      RowBox[{"exampleList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", 
      RowBox[{
       RowBox[{"Length", "[", "exampleList", "]"}], "+", "1"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"state", "=", 
       RowBox[{"exampleList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"Length", "[", "states", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"state", ",", 
           RowBox[{"_states", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9219503126060553`*^9, 3.9219504002196236`*^9}, {
  3.921950455705933*^9, 3.921950501504757*^9}, {3.9219505318040752`*^9, 
  3.9219505415705643`*^9}, {3.9219508091038885`*^9, 3.921950895169928*^9}, {
  3.9219509485034027`*^9, 3.921951026386757*^9}, {3.921951124271801*^9, 
  3.921951148188301*^9}},ExpressionUUID->"e2bea2b0-a51c-46ef-b55d-\
993779013fec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{"_", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219509041866455`*^9, 3.921950937753872*^9}},
 CellLabel->
  "In[677]:=",ExpressionUUID->"17312149-1fef-4363-b418-cdbe1e4a0679"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9219509384027987`*^9},
 CellLabel->
  "Out[677]=",ExpressionUUID->"f3fcbe38-364e-4bdb-9b74-212c1f05389f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"2"},
       "Ket"], "1"], 
     SubscriptBox[
      TemplateBox[{"3"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"5"},
       "Ket"], "3"], 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "4"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "u"], 
     SubscriptBox[
      TemplateBox[{"2"},
       "Ket"], "g"]}]}], ",", "1", ",", "1", ",", 
   RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
   RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
   RowBox[{"f", "[", "10", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.921950199187061*^9, 
  3.9219502153219995`*^9}},ExpressionUUID->"8480a91e-5a29-4230-8a7f-\
5e980a8ab996"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{"0.5", 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{"0.25", 
       SubscriptBox[
        TemplateBox[{"5"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "_"}]}], "]"}]], "Input",
 CellLabel->
  "In[581]:=",ExpressionUUID->"8e9f252c-c9bd-4d9b-817c-ccd185f2c41f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{"0.5`", " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{"0.25`", " ", 
    SubscriptBox[
     TemplateBox[{"5"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9215330253204346`*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"f6e8e541-8d3e-46fe-bef4-94a78477b985"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "__"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921533039884797*^9, 3.9215331025919104`*^9}, {
  3.921948046938168*^9, 3.9219480491704807`*^9}, {3.9219481071969814`*^9, 
  3.9219482829404435`*^9}, {3.9219486110539217`*^9, 3.9219487690039515`*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"0d65dfb6-4a2e-46b5-a57f-d9a9fc3bbf90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"2"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215330411210513`*^9, 3.921533103337509*^9}, {
  3.9219481084732685`*^9, 3.921948157372478*^9}, {3.9219481894846196`*^9, 
  3.9219482834241734`*^9}, {3.921948618454466*^9, 3.9219487702134056`*^9}},
 CellLabel->
  "Out[630]=",ExpressionUUID->"679431da-6736-464e-9d0d-461a8d7bbf2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{3.9219488723747377`*^9},
 CellLabel->
  "In[676]:=",ExpressionUUID->"97744d6b-f3ee-4ea6-b36d-3084841e316e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"2"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9219488728127527`*^9, 3.921950565003311*^9},
 CellLabel->
  "Out[676]=",ExpressionUUID->"0d1204eb-7986-4cbb-897f-ceb8938b76c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"5"},
         "Ket"], "3"], 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "4"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", "+", 
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921948915190155*^9, 3.921948927439372*^9}, {
  3.9219492059204245`*^9, 3.921949214805207*^9}, {3.9219496305868626`*^9, 
  3.921949643003837*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"35351b94-5e63-401b-9741-7cd5f5c14f12"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.921949228177019*^9, 3.9219496434700503`*^9},
 CellLabel->
  "Out[659]=",ExpressionUUID->"f24b8286-49f7-4cb6-b079-0898a478920d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"___", 
     SubscriptBox[
      TemplateBox[{"___"},
       "Ket"], "___"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.92194969808915*^9, 3.9219497552714124`*^9}, {
  3.92194987412086*^9, 3.921949887521564*^9}, {3.921950089303444*^9, 
  3.9219500925550847`*^9}},
 CellLabel->
  "In[671]:=",ExpressionUUID->"746c61c1-636b-4719-a782-185a5ae62015"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9219497114711514`*^9, 3.9219497408716683`*^9}, 
   3.9219498221033645`*^9, {3.9219498672366085`*^9, 3.921949888038537*^9}, 
   3.921950094405446*^9},
 CellLabel->
  "Out[671]=",ExpressionUUID->"d9aae294-4461-4442-aa74-2f3063124f3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"___", 
       SubscriptBox[
        TemplateBox[{"___"},
         "Ket"], "___"]}], "+", "___"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219501083889217`*^9, 3.921950121270262*^9}},
 CellLabel->
  "In[675]:=",ExpressionUUID->"6403bc70-696a-4098-83c6-26f0fc81a204"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "u"], " ", 
      SubscriptBox[
       TemplateBox[{"2"},
        "Ket"], "g"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"2"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"5"},
        "Ket"], "3"]}]}], ")"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219501033051834`*^9, 3.9219501219198*^9}},
 CellLabel->
  "Out[675]=",ExpressionUUID->"c0eb9b02-f5b1-4bc7-86b3-c898c8d58fc4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"___", 
       SubscriptBox[
        TemplateBox[{"___"},
         "Ket"], "___"]}], "+", "___"}], ")"}]}]}], "]"}]], "Input",Expression\
UUID->"5767a2ac-1014-45be-a48a-44a7dc03befd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"___", 
     SubscriptBox[
      TemplateBox[{"___"},
       "Ket"], "___"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219499180231247`*^9, 3.9219499336892967`*^9}},
 CellLabel->
  "In[670]:=",ExpressionUUID->"6c25e3db-7a68-4467-959c-e10f9e9fe871"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.921949922669856*^9, 3.921949934503233*^9}},
 CellLabel->
  "Out[670]=",ExpressionUUID->"cfe58887-4581-4206-bf62-e8ab919e7449"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"_", 
    SubscriptBox[
     TemplateBox[{"_"},
      "Ket"], "_"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921949239470619*^9, 3.921949362671127*^9}, {
  3.92194956091175*^9, 
  3.9219496052207923`*^9}},ExpressionUUID->"ebc660c9-6a58-45fd-8b95-\
cd214cc8bd93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"3"},
     "Ket"], "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219492758535233`*^9, 3.921949363153698*^9}, {
  3.921949564320405*^9, 3.9219495997376046`*^9}},
 CellLabel->
  "Out[658]=",ExpressionUUID->"1757da17-0863-4898-8042-0f8d11fb086a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    SubscriptBox[
     TemplateBox[{"_"},
      "Ket"], "_"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219488870267954`*^9, 3.921948905487571*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"7d2e549e-dca2-4615-bd2d-d255558b1181"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"3"},
     "Ket"], "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219488897710342`*^9, 3.9219489058537683`*^9}},
 CellLabel->
  "Out[634]=",ExpressionUUID->"2e2100ee-7909-4207-aaa2-ff4891ea3baa"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.921948253755091*^9, 
  3.9219501651372023`*^9},ExpressionUUID->"0eac660c-ef02-4fdd-a3d7-\
904bf67e756a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"validStates", ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "_"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921532151455443*^9, 3.921532182661536*^9}, {
  3.921532271422226*^9, 3.921532337643084*^9}, {3.921532397957655*^9, 
  3.9215324012394896`*^9}, {3.921532974471082*^9, 3.921532999987961*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"159e02b7-363b-4ddd-9868-066fa33af947"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9215329786209*^9, 3.9215330005207644`*^9}},
 CellLabel->
  "Out[580]=",ExpressionUUID->"a20eccda-52ff-4199-b776-5434171c2f75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"validStates", ",", 
   RowBox[{"Sum", "[", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"], ",", "_"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921532766587878*^9, 3.921532813371369*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"f5f652df-6671-4f22-b561-732156184b02"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9215328025381985`*^9, 3.9215328138721504`*^9}},
 CellLabel->
  "Out[577]=",ExpressionUUID->"36c14575-510c-4dfc-8179-8bf391b927ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"validStates", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "0", "]"}], "]"}], "==", "Ket"}]], "Input",
 CellChangeTimes->{{3.9215323509568157`*^9, 3.92153244302277*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"156a2de9-f020-4460-b705-62b368eedefc"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9215321556383533`*^9, 3.9215321830549088`*^9}, {
  3.921532328770241*^9, 3.9215323547882414`*^9}, {3.9215324109879656`*^9, 
  3.9215324440881925`*^9}},
 CellLabel->
  "Out[573]=",ExpressionUUID->"60b4a3a0-c817-4f65-b818-4df1baaf3824"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"validStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",ExpressionUUID->"434c7fa0-30a9-\
4a2f-b932-8e0daa0ec8ae"],

Cell[BoxData[
 RowBox[{"validStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",ExpressionUUID->"ba2648f6-8ba7-\
464b-9954-faa0b9d69067"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "aOps", "]"}]], "Input",
 CellChangeTimes->{{3.9215311480561523`*^9, 3.9215311514728146`*^9}, {
  3.921615165340904*^9, 3.9216151661393375`*^9}},
 CellLabel->
  "In[587]:=",ExpressionUUID->"bcd1bdb3-a5e4-4a1b-b8c4-a92a091db542"],

Cell[BoxData["36"], "Output",
 CellChangeTimes->{3.921615166608702*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"db3988c6-d753-472a-b31c-ea4f3b5ce8bc"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9216151598249073`*^9, 
  3.921615162587039*^9}},ExpressionUUID->"09c3178d-5778-4a19-8b32-\
5c16afafbe7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "!=", "0"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921531082039147*^9, 3.921531110723776*^9}},
 CellLabel->
  "In[523]:=",ExpressionUUID->"6fbf90aa-0a68-4672-bd8b-567fc2c899b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921531104573149*^9, 3.9215311112066183`*^9}},
 CellLabel->
  "Out[523]=",ExpressionUUID->"4ad81e1c-ad8c-4304-9b27-6983ff7dcb5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"getStateWithoutPrefactors", "[", "#", "]"}], "&"}], ",", 
   "statesHeralded"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215303709393635`*^9, 3.9215303858791323`*^9}, {
  3.9215308403556595`*^9, 3.9215308599068966`*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"f2048f2a-dc39-44d6-ae72-3a78c9b1cc8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "-", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "-", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921530841790413*^9, 3.921530860705645*^9}},
 CellLabel->
  "Out[521]=",ExpressionUUID->"9a87dec5-27a8-43d6-8660-51394c602408"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["heralding patterns", "Subsubsection",
 CellChangeTimes->{{3.9219524926360035`*^9, 
  3.9219524985047894`*^9}},ExpressionUUID->"f107a1b5-5005-49eb-a1dc-\
4e1691bcf81c"],

Cell[TextData[{
 "By inspection, there are no pairs of photons that would herald a state ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "97617a54-2067-4f38-8606-d233aaee9425"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ed00a7d3-6a75-420c-8e73-b0cff12e5aaa"],
 " or ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "13b5e3ce-c7e9-4a26-91e4-c91c1299c39e"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "396369ac-cd69-42cb-a329-e968e3fda639"],
 ", so we can break up \[Psi]out into two parts and analyze the coefficients \
to see which measurements herald which states. For now, we will assume the \
detectors are not number resolving and ignore the states with two photons in \
the same mode."
}], "Text",
 CellChangeTimes->{{3.920909496236785*^9, 3.9209095898884883`*^9}, {
  3.9209097149915366`*^9, 3.920909741874401*^9}, {3.9211019130215664`*^9, 
  3.9211020211751757`*^9}, {3.921250392028551*^9, 
  3.921250392934794*^9}},ExpressionUUID->"c3ea9baa-9bb1-4e0a-ab74-\
c199853905ae"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}]}], TraditionalForm]],
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9},ExpressionUUID->"fc355bdf-7348-4c82-89e9-\
e92763de840d"]], "Text",
 CellChangeTimes->{{3.920908499708667*^9, 3.920908501992181*^9}, {
  3.920908884008483*^9, 
  3.9209088929508543`*^9}},ExpressionUUID->"a8bea38e-5406-4ad3-8150-\
c9b82d31a6fc"],

Cell[TextData[{
 "8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"27d1078b-ea70-4036-93c5-75575224d451"],
 ": ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "8776ff02-c710-425b-a5d2-36d321bcbcf0"],
 ",  ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "cb4c475a-81ba-4cd7-8097-4559994bf2b8"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "952571aa-ca3f-4670-bae8-2e15e5a0f9a4"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "d812e7d3-575c-44fa-9a05-34f7c9c33a6e"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "a25d2e28-6f63-4953-934e-c5f90ec6816d"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "90351a70-572d-49cb-8476-6990ba4f2584"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "1e8a4083-a717-4e39-baba-197fb2a6ca2a"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "1714e938-2bfb-4b83-be30-13495d89fd34"],
 " \n\n8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"640f28ae-5ce2-479e-84fb-c0ebca0e921c"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "5f614a6b-cb85-4bde-a150-59399ecc0504"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "5b00042d-08c0-4629-bddc-edb0da29fcd0"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{
       RowBox[{" ", "a"}]},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "39bb2f73-b05c-4aa2-b325-a3781e3418e1"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "341fdfe9-d7ab-42dc-811e-e88d5f8bee76"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "0974f7f0-f179-4f5b-87fa-e774a5636e26"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "47b4f840-6284-4665-b8c0-2dbf08e7eb2c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "65e105c8-0839-4b2d-8dfc-1d5e15c31cd1"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "d3ae3f50-f7d8-4939-9050-786cac4b4c83"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.9209094747263203`*^9}, {3.9209096048768697`*^9, 3.920909630876568*^9}, {
   3.9209096731675744`*^9, 
   3.9209096835364027`*^9}},ExpressionUUID->"d82b43cf-0f9c-4694-aac5-\
507e5c8b4bdc"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "1", "2"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "3", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "5", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "7", "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "2"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "2", "2"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "4", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "6", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "8", "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "2"]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",ExpressionUUID->"29f5795f-\
dbe5-4986-8be8-3fca903f6e44"],

Cell[TextData[{
 "2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " "}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"79a6bbaf-d2e8-4c77-bc4f-52e18a56a188"],
 "and 2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", "."}]}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"2a14ba65-d1a0-485a-908c-7a043d2bb5eb"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.920909487348649*^9}, {3.9209096437272034`*^9, 3.9209097101183753`*^9}, {
   3.920909746659487*^9, 
   3.920909750477916*^9}},ExpressionUUID->"c21357f7-7dc2-45b9-8dba-\
03c84ebf255d"],

Cell["\<\
16 patterns for heralding Bell states, each with an |amplitude| 1/4. 4 \
patterns which herald product states, each with |amplitude| 1/2. 8 two-photon \
patterns which we can\[CloseCurlyQuote]t resolve,  with |amplitude| 1/4. \
Normalize the state.\
\>", "Text",
 CellChangeTimes->{{3.920909783315935*^9, 
  3.9209099797394195`*^9}},ExpressionUUID->"133c08af-b490-4252-9d2e-\
a900aa8a33c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"norm", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"]}], "]"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "include", " ", "only", " ", "the", " ", "events", " ", "with", " ", 
    "photons", " ", "detected", " ", "in", " ", "different", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a Bell state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], "]"}], "/", 
  "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"15ef4c28-cfb5-45b6-af92-219e0755edb6"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920910935549213*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"f45c399b-eab7-4bb3-b0fd-640661f723c6"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355722184`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"c7fb7d71-710f-4661-8469-f65513c5e6ca"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"0f6bf3fe-0437-4693-b692-c945b3c84cb2"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"0c082d88-4bc6-4efe-9e6d-2fec0f74da28"]
}, Open  ]],

Cell["\<\
However, if we normalize to all possible detection events including \
two-photons arriving at the same detector, we find the odds of getting a Bell \
state are actually slightly less than what would be achieved with the \
traditional Bell measurement scheme:\
\>", "Text",
 CellChangeTimes->{{3.9209109734262447`*^9, 
  3.9209111154142923`*^9}},ExpressionUUID->"14485818-c671-433c-ba66-\
4655ac977f8a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "include", " ", "all", " ", "possible", " ", "detection", " ", "events"}],
     ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "even"}], " ", "those", " ", "with", 
     " ", "two", " ", "photons", " ", "detected", " ", "in", " ", "the", " ", 
     "same", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
  "\"\<Fraction of detection events which herald a Bell state:\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
   "]"}], "/", "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}, {3.9209111247604403`*^9, 
  3.920911231061555*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"01682fe4-fe7c-4f02-9eb9-4764cf0d062c"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920911235927408*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"52887c83-28e2-4d31-9795-362db7c2e0a2"],

Cell[BoxData[
 FractionBox["2", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"de696cd3-7dd6-4a8a-8803-f6f3c36a320e"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"ce52e5e7-a7ad-4053-9a5d-609ed4666673"],

Cell[BoxData[
 FractionBox["3", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"434f4d0e-5963-4600-8194-6515ca89c0a7"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["misc", "Subsubsection",
 CellChangeTimes->{{3.922099073315446*^9, 
  3.922099073731289*^9}},ExpressionUUID->"2a3d44d2-d295-4ea1-a4b3-\
4e27d857c4fd"],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], 
    SubscriptBox[
     TemplateBox[{
       RowBox[{
         SubscriptBox["0", "1"], ",", 
         SubscriptBox["0", "2"]}]},
      "Ket"], "2"]}], ")"}], "2"]], "Input",
 CellChangeTimes->{{3.9207068017172184`*^9, 3.920706852576332*^9}, 
   3.920707282941431*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"ada376d2-dc9a-42fd-80f3-e0f87766311e"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1", "2"], " ", 
  SubsuperscriptBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["0", "1"], ",", 
       SubscriptBox["0", "2"]}]},
    "Ket"], "2", "2"]}]], "Output",
 CellChangeTimes->{{3.9207068133170404`*^9, 3.920706853084527*^9}, 
   3.9207072837141347`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"6a9a8b00-68d8-4982-9a33-5619b5f0d817"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Product", "[", 
  RowBox[{
   RowBox[{"f", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"ae9ec4c8-a105-4a14-8fc6-5dd232832525"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "1", "]"}], " ", 
  RowBox[{"f", "[", "2", "]"}], " ", 
  RowBox[{"f", "[", "3", "]"}]}]], "Output",
 CellChangeTimes->{3.9207079736800957`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"c6a42074-3ac3-48f9-9d68-35bebe8e56ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{
      RowBox[{
        SubscriptBox["0", "Hc"], ",", 
        SubscriptBox["0", "Vc"], ",", 
        SubscriptBox["0", "Hd"], ",", 
        SubscriptBox["0", "Vd"]}]},
     "Bra"], "i"], 
   SubscriptBox[
    TemplateBox[{
      RowBox[{
        SubscriptBox["0", "Hc"], ",", 
        SubscriptBox["0", "Vc"], ",", 
        SubscriptBox["0", "Hd"], ",", 
        SubscriptBox["0", "Vd"]}]},
     "Ket"], "i"]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9208419398434997`*^9, 3.9208419626855617`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"664312cd-5c4f-472c-8558-228b061b6f7f"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["0", "Hc"], ",", 
       SubscriptBox["0", "Vc"], ",", 
       SubscriptBox["0", "Hd"], ",", 
       SubscriptBox["0", "Vd"]}]},
    "Bra"], "i"], " ", 
  SubscriptBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["0", "Hc"], ",", 
       SubscriptBox["0", "Vc"], ",", 
       SubscriptBox["0", "Hd"], ",", 
       SubscriptBox["0", "Vd"]}]},
    "Ket"], "i"]}]], "Output",
 CellChangeTimes->{{3.9208419594225774`*^9, 3.920841963059393*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"6de82bed-ce52-4e71-adb4-4dc7de1d934a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   TemplateBox[{"0"},
    "Ket"], "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"0"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"0"},
    "Bra"], "=", 
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[ConjugateTranspose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], "=", 
   RowBox[{"(", GridBox[{
      {"0"},
      {"1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  TemplateBox[{"0"},
   "Bra"], ".", 
  TemplateBox[{"1"},
   "Ket"]}]}], "Input",
 CellChangeTimes->{{3.9208419667397656`*^9, 3.9208419679603157`*^9}, {
  3.920842084201112*^9, 3.920842090613371*^9}, {3.920842132439074*^9, 
  3.920842241088516*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"8b1c4027-7e4a-4ed8-839c-5d9acfc05e33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.920842241527319*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"d947e275-c828-4151-80ff-e3153a3a5862"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                 SubscriptBox[
                  TemplateBox[{"atom1"},
                   "Ket"], "mode1"], 
                 SubscriptBox[
                  TemplateBox[{"atom2"},
                   "Ket"], "mode2"]}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{"\[Psi]organized", ",", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.920841237300927*^9, 3.920841334637461*^9}, {
  3.9208414039910746`*^9, 3.920841423988835*^9}, {3.920841466868558*^9, 
  3.9208416633478584`*^9}, {3.9208416989449434`*^9, 3.9208417132039685`*^9}, {
  3.9208422704238577`*^9, 3.9208422737998853`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"1b67f3bf-a730-437d-82ba-57bd6c5bf2ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.9208428050295887`*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"bcbf4adb-a201-4400-b0b2-96603997f0ee"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805032312*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"be3ba821-6d82-4030-9ed0-a55a43281af8"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805038905*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"39dd96ec-0b59-44b3-8664-7a12e8624471"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805038905*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"27321107-1629-44fc-9857-1db37b364b88"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805048952*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"57d92ecd-1709-4755-9fb4-ec71a4c9583f"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805048952*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"390a9210-5e71-47ac-b49f-c49eceb1f7cc"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805058838*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"c1661334-ebf1-4d1a-a093-c98dcd2afa05"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], " ", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"]}]], "Print",
 CellChangeTimes->{3.920841664041675*^9, 3.9208417137884507`*^9, 
  3.9208423093846273`*^9, 3.920842805058838*^9},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"71f680b4-8243-4e9d-8aa6-82a3228f231b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Just two atoms - programmatically get measurement outcomes - notation too \
unweildy\
\>", "Subsection",
 CellChangeTimes->{{3.9208982628761587`*^9, 3.920898275686413*^9}, {
  3.9209112700040255`*^9, 3.9209112771932592`*^9}, {3.9211003748650594`*^9, 
  3.92110040043661*^9}, {3.9215172819233246`*^9, 
  3.9215172920915737`*^9}},ExpressionUUID->"193087ec-8546-43bb-b7a8-\
29dc61c0111c"],

Cell[TextData[{
 "Note that in my handwritten notes (the equation below comes from page 7, \
eq. 11), I use primed subscripts for the output of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "d3805c09-6b28-4a08-a57d-32a8ff560e9b"],
 ". Here, I omit the primes, as c,d unambiguously refer to the c,d ports of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "657c1d82-cce8-46a4-a6a6-76e7191e235a"],
 ". \n\nInterestingly, this scheme has a lower probability of heralding Bell \
states compared to the standard Bell measurement scheme. This may be the \
reason that path deformation gate schemes typically initialize the different \
spins in a particular state rather than superpositions."
}], "Text",
 CellChangeTimes->{{3.920901720564152*^9, 3.920901795554597*^9}, {
  3.9209121207290125`*^9, 
  3.920912250976545*^9}},ExpressionUUID->"35b3848d-b5cf-4f6a-8f80-\
7c2a9518dc4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Ket", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"], ";"}]}], "Input",
 CellChangeTimes->{{3.9208425451993303`*^9, 3.920842552569414*^9}, {
  3.920842584840373*^9, 3.920842602216781*^9}, {3.9208426416163654`*^9, 
  3.9208426420897818`*^9}, {3.920842773439519*^9, 3.9208427859595356`*^9}, {
  3.9208983126438646`*^9, 3.920898372082747*^9}, {3.920903224708039*^9, 
  3.9209032319227448`*^9}, {3.92090542764618*^9, 3.9209054891300173`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"95f874b1-1700-452f-8a92-afc733d1f2cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]out", "=", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"1", ",", "2"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"1", ",", "2"}]]}]]}]}], " ", ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d1"]}]}], " ", 
              ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"2", ",", "1"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d1"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"2", ",", "1"}]]}]]}]}], " ", ")"}]}]}], ")"}]}]}], 
     "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]out", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9208983014527082`*^9, 3.9208983106025877`*^9}, {
  3.9208983737628946`*^9, 3.9208983887232723`*^9}, {3.9208984358232656`*^9, 
  3.920898591923049*^9}, {3.9209016845919504`*^9, 3.920901712014367*^9}, {
  3.920901939789465*^9, 3.9209019407240276`*^9}, {3.920902332629814*^9, 
  3.92090237181341*^9}, {3.920902406188398*^9, 3.920902408983692*^9}, {
  3.9209024399533453`*^9, 3.920902492528591*^9}, {3.9209025790340786`*^9, 
  3.9209026636628184`*^9}, {3.9209030942448826`*^9, 3.920903094352373*^9}, {
  3.9209032376531315`*^9, 3.9209032549953628`*^9}, {3.9209033231446137`*^9, 
  3.9209034397556295`*^9}, {3.920903474613057*^9, 3.920903502542235*^9}, {
  3.9209035527683725`*^9, 3.9209035623948717`*^9}, {3.9209053834207935`*^9, 
  3.9209053856799407`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e1f20290-245b-4aa6-a0a9-5072edd9c3dd"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]h", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]h", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["\[Phi]v", 
       RowBox[{"1", ",", "2"}]]}]], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["\[Phi]v", 
        RowBox[{"2", ",", "1"}]]}]}]], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.920902623728285*^9, 3.9209026579341955`*^9}, 
   3.920903094762336*^9, {3.920903239102376*^9, 3.920903255412464*^9}, 
   3.9209033293915825`*^9, 3.920903452252228*^9, 3.9209035040220175`*^9, 
   3.9209035634946175`*^9, {3.9209053915826855`*^9, 3.9209054176898527`*^9}, 
   3.920905448412149*^9, 3.9209054915938644`*^9, 3.9209060016476393`*^9},
 CellLabel->
  "Out[9]//TraditionalForm=",ExpressionUUID->"765c2990-48b5-4500-895d-\
946be51eec91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Psi]organized", "=", 
                RowBox[{"Collect", "[", 
                 RowBox[{"\[Psi]organized", ",", 
                  RowBox[{
                   SubscriptBox[
                    TemplateBox[{"atom1"},
                    "Ket"], "mode1"], 
                   SubscriptBox[
                    TemplateBox[{"atom2"},
                    "Ket"], "mode2"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920903573694778*^9, 3.920903574752097*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"48ec06e5-c9a2-4d9f-b832-5c5d1d648c26"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"2", ",", "1"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]h", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]h", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"2", ",", "1"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d1", "2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["\[Phi]v", 
          RowBox[{"1", ",", "2"}]]}]], " ", 
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"1", ",", "2"}]]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          SubscriptBox["\[Phi]v", 
           RowBox[{"2", ",", "1"}]]}]}]], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"]}], ")"}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903525777152*^9, {3.920903568207063*^9, 3.9209035751443443`*^9}, {
   3.9209053950204105`*^9, 3.9209054199799986`*^9}, 3.9209054933797417`*^9, 
   3.9209060055955195`*^9},
 CellLabel->
  "Out[12]//TraditionalForm=",ExpressionUUID->"102c4316-7d36-4a05-a308-\
76feb59834dd"]
}, Open  ]],

Cell["\<\
Simplify the result by assuming we have some way to set the phases to zero \
(up to an overall phase).\
\>", "Text",
 CellChangeTimes->{{3.9209036135627894`*^9, 
  3.920903676611619*^9}},ExpressionUUID->"ffcde52b-6c71-4ee6-8093-\
cc29d75502bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubscriptBox["\[Phi]h", 
    RowBox[{"1", ",", "2"}]], "=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]h", 
     RowBox[{"2", ",", "1"}]], "=", " ", 
    RowBox[{
     SubscriptBox["\[Phi]v", 
      RowBox[{"1", ",", "2"}]], "=", 
     RowBox[{
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]], "=", "0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92090369657924*^9, 3.920903721461937*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7edf914d-e556-476a-a18c-013027442fc1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9209037220716763`*^9, 3.9209054067898936`*^9, 
  3.9209060103270197`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"e7b3ea48-dd13-48d1-b76d-322bfa44fe34"]
}, Open  ]],

Cell["\<\
Todo: find a way to programatically replace the h and v ops with a\
\[CloseCurlyQuote]s. 

Let\[CloseCurlyQuote]s rewrite the operators in terms of the detector pixels, \
numbered 1-8, in order to simplify reading off the measurement results.\
\>", "Text",
 CellChangeTimes->{{3.920905151040154*^9, 3.920905206380886*^9}, {
  3.9211018250911164`*^9, 
  3.9211018611355257`*^9}},ExpressionUUID->"eefd9884-62c5-467f-aa13-\
e192d6185a8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nModes", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSubscript", "[", "op_", "]"}], ":=", 
   RowBox[{"StringSplit", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"op", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPolarization", "[", "op_", "]"}], ":=", 
   RowBox[{"StringTake", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "op", "]"}], ",", "\"\<]\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getADagger", "[", "hvDagger_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{
      RowBox[{"a", "\[ConjugateTranspose]"}], ",", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "hvDagger", "]"}], ",", 
                 "\"\<]\>\""}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}], "==", "\"\<h\>\""}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
         ",", "1", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
            "\"\<v\>\""}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
         ",", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
            "\"\<h\>\""}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
         ",", "3", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
            "\"\<v\>\""}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
         ",", "4"}], "]"}], "+", 
       RowBox[{"4", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{
            RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}]}], 
     "]"}], "//", "TraditionalForm"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9212713976116905`*^9, 3.9212713987281322`*^9}, {
  3.921271641378909*^9, 3.9212716613062143`*^9}, {3.9212717869767833`*^9, 
  3.9212717884614677`*^9}, {3.9212720442436876`*^9, 3.921272181363143*^9}, {
  3.9212722125911903`*^9, 3.921272219238958*^9}, {3.9212722746396704`*^9, 
  3.9212723074921513`*^9}, {3.9212723709015265`*^9, 3.9212723712225895`*^9}, {
  3.9212724871415586`*^9, 3.921272537731552*^9}, {3.921272574105748*^9, 
  3.921272576041379*^9}, {3.9212727134642515`*^9, 3.9212727177353354`*^9}, {
  3.921272790971791*^9, 3.921272860974622*^9}, {3.9212729239097424`*^9, 
  3.9212729288691273`*^9}, {3.9212730364212275`*^9, 3.9212730553763285`*^9}, {
  3.92127310059873*^9, 3.9212731216821413`*^9}, {3.921273605864589*^9, 
  3.9212736059075794`*^9}, {3.921273700444727*^9, 3.9212737140450087`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"eab61bca-4122-4e0e-b615-d0a953a2a662"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "]"}]}], "Input",
 CellChangeTimes->{{3.921271668322682*^9, 3.9212717039972754`*^9}, {
  3.921272127547654*^9, 3.921272157467417*^9}, {3.921272194454615*^9, 
  3.9212721945436883`*^9}, {3.9212722855108447`*^9, 3.9212722855618944`*^9}, {
  3.9212723246403165`*^9, 3.9212723312144327`*^9}, {3.9212728243953686`*^9, 
  3.9212728244213243`*^9}, {3.921272948773532*^9, 3.921272948826912*^9}, {
  3.9212731269210405`*^9, 3.9212731356061215`*^9}, {3.921273615285166*^9, 
  3.9212736720105524`*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"669aba74-5910-482c-a666-ef8c9414164d"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "1"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9},
 CellLabel->
  "Out[265]//TraditionalForm=",ExpressionUUID->"8f671697-4275-44ac-b72b-\
f02b135984f3"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "2"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.9212737158355255`*^9},
 CellLabel->
  "Out[266]//TraditionalForm=",ExpressionUUID->"7d00959b-fff8-4e36-a765-\
f7c55e74afe1"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "3"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.9212737158439283`*^9},
 CellLabel->
  "Out[267]//TraditionalForm=",ExpressionUUID->"2aff5c29-c353-4e50-9968-\
a8e665d0f706"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "4"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.9212737158611865`*^9},
 CellLabel->
  "Out[268]//TraditionalForm=",ExpressionUUID->"b03c24fc-453a-4d32-a6aa-\
31c6724dc06b"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "5"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715869643*^9},
 CellLabel->
  "Out[269]//TraditionalForm=",ExpressionUUID->"87542101-cf93-4bef-b8c1-\
39b89d2add2b"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "6"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715869643*^9},
 CellLabel->
  "Out[270]//TraditionalForm=",ExpressionUUID->"1bdb6cce-ec9a-4a44-bb3b-\
7b81183368fb"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "7"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715877937*^9},
 CellLabel->
  "Out[271]//TraditionalForm=",ExpressionUUID->"0cb90de9-22a3-4ba7-8fa9-\
0908aac5336a"],

Cell[BoxData[
 FormBox[
  SubscriptBox[
   TemplateBox[{"a"},
    "ConjugateTranspose"], "8"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.9212737158861465`*^9},
 CellLabel->
  "Out[272]//TraditionalForm=",ExpressionUUID->"cc956468-9a0a-4f39-bd85-\
dbfa27884a57"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.92127331755737*^9, 3.9212733344618735`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"800cb7c3-ef8b-4bc5-bfdc-29004baa7642"],

Cell[BoxData[
 RowBox[{"\"\<c\>\"", "\"\<d\>\""}]], "Input",
 CellChangeTimes->{{3.921273336723338*^9, 3.9212733523427477`*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"03dea4c3-7113-40f2-b115-7a4444090477"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\"\<c\>\"", " ", "\"\<d\>\""}]], "Input",
 CellChangeTimes->{{3.921273363397543*^9, 3.9212733662081537`*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"cebd212a-2fc9-4417-979f-9dd210eed8d6"],

Cell[BoxData[
 RowBox[{"\<\"c\"\>", " ", "\<\"d\"\>"}]], "Output",
 CellChangeTimes->{3.921273366750473*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"248297c5-805c-4239-b447-bc85c8afbcfd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\"\<cd\>\""], "Input",
 CellChangeTimes->{{3.921273367868755*^9, 3.9212733691550317`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"201b88f2-22e3-4f6b-99a0-fdcdc70bd47b"],

Cell[BoxData["\<\"cd\"\>"], "Output",
 CellChangeTimes->{3.9212733695115385`*^9},
 CellLabel->
  "Out[241]=",ExpressionUUID->"dbcdf54c-a2b2-4569-879a-a5d379458a1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringForm", "[", 
  RowBox[{"\"\<````\>\"", ",", "i", ",", "j"}], "]"}]], "Input",
 CellChangeTimes->{{3.921273380003124*^9, 3.921273394036353*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"97428c8f-c0e9-4a0d-9d26-1601fb1374b4"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"i\\\"}]\\)\\!\\(\\*RowBox[{\\\"j\
\\\"}]\\)\"\>",
  StringForm["````", $CellContext`i, $CellContext`j],
  Editable->False]], "Output",
 CellChangeTimes->{3.9212733947348824`*^9},
 CellLabel->
  "Out[242]=",ExpressionUUID->"610f6e5d-9269-4685-9fba-d34bfcfbf345"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nModes", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opList", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox[
      RowBox[{"u", "\[ConjugateTranspose]"}], 
      RowBox[{"ToExpression", "[", 
       RowBox[{"ToString", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<````\>\"", ",", "port", ",", "mode"}], "]"}], "]"}], 
       "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "v"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"port", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mode", ",", 
       RowBox[{"Range", "[", "nModes", "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.921273238885843*^9, 3.9212733023003025`*^9}, {
  3.921273404155086*^9, 3.921273416979802*^9}, {3.9212734665428247`*^9, 
  3.9212735177298045`*^9}, {3.9212737318459377`*^9, 3.9212737407166014`*^9}, {
  3.9212738307539062`*^9, 3.9212738713445377`*^9}, {3.921273932100751*^9, 
  3.9212739394690847`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"ad956fd0-7360-46af-ad5a-140495d4d2dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "c1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "c2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "d1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "d2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "c1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "c2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "d1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "d2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9212735107852836`*^9, 3.9212735180818124`*^9}, 
   3.9212737410450287`*^9, {3.921273831427519*^9, 3.9212738719973764`*^9}, {
   3.9212739337375765`*^9, 3.9212739398410826`*^9}},
 CellLabel->
  "Out[292]=",ExpressionUUID->"0c465a21-ad91-442c-90fa-cd3da9ec44f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrueQ", "[", 
  RowBox[{
   RowBox[{"opList", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "==", 
   SubscriptBox[
    RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.921273775979144*^9, 3.9212738104098763`*^9}, {
  3.921273841879959*^9, 3.9212738522860875`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"6980351a-ca7c-4ac6-84dd-e072616ba2b4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9212737978211684`*^9, 3.9212738745730414`*^9}, {
  3.9212739351491704`*^9, 3.921273940964737*^9}},
 CellLabel->
  "Out[293]=",ExpressionUUID->"4dac9569-60af-413b-9b14-51fc5b987cf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"getADagger", ",", "opList"}], "]"}]], "Input",
 CellChangeTimes->{{3.921273536304743*^9, 3.9212735515761194`*^9}, {
  3.921273918432233*^9, 3.9212739189601183`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"dacea9c9-c779-4409-9b5e-75040cecd945"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "1"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "5"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "3"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "6"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "4"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "8"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{
  3.921273552205573*^9, 3.9212737511022625`*^9, {3.9212739194011965`*^9, 
   3.921273942054698*^9}},
 CellLabel->
  "Out[294]=",ExpressionUUID->"51f66591-32bd-48ce-94f4-71bc32ba0398"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Psi]detector", "=", 
     RowBox[{"\[Psi]organized", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "1"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "2"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "3"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "4"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "5"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "6"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "8"]}]}], "}"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Psi]detector", "=", 
    RowBox[{"\[Psi]organized", "/.", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"op", "->", 
        RowBox[{"getADagger", "[", "op", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"op", ",", "opList"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Psi]detector", "//", "TraditionalForm"}]}]}]], "Input",
 CellChangeTimes->{{3.920904827280583*^9, 3.9209049192778716`*^9}, {
  3.9209049716906166`*^9, 3.9209050257403984`*^9}, {3.920905251680399*^9, 
  3.9209052677012835`*^9}, {3.9209052981516542`*^9, 3.9209053301802425`*^9}, {
  3.921273979784286*^9, 3.9212740568486385`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"c2549459-07a9-42cf-9390-066c14d4c116"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "1"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "2"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "2"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9212740480700493`*^9, 3.9212740577030435`*^9}},
 CellLabel->
  "Out[297]=",ExpressionUUID->"d3babc71-7bde-4abb-8fa2-a953b0000578"]
}, Open  ]],

Cell["Get the \[OpenCurlyDoubleQuote]coefficients\[CloseCurlyDoubleQuote] of \
the atomic states", "Text",
 CellChangeTimes->{{3.921100465325042*^9, 
  3.921100490338769*^9}},ExpressionUUID->"26e8a332-1e1f-42ed-a5de-\
41251d7f5d09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Natoms", " ", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modeList", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mode1", "!=", "mode2"}], ",", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"atom1"},
           "Ket"], "mode1"], 
         SubscriptBox[
          TemplateBox[{"atom2"},
           "Ket"], "mode2"]}], ",", "Nothing"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mode1", ",", 
        RowBox[{"Range", "[", "Natoms", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mode2", ",", 
        RowBox[{"Range", "[", "Natoms", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"atom1", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"atom2", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"modeList", "=", 
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"modeList", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], ","}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9211005022238684`*^9, 3.921100688255419*^9}, {
  3.9211010455141983`*^9, 3.9211010520718203`*^9}, {3.921101087141514*^9, 
  3.9211011340822496`*^9}, {3.9211013959071693`*^9, 3.9211014440495043`*^9}, {
  3.9211015773956876`*^9, 3.9211015907011347`*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"38e5df3c-a12e-4272-8ef7-e31a89c82b5c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.921101402792974*^9, {3.9211015799399033`*^9, 3.921101591138384*^9}, 
   3.921274148096491*^9},
 CellLabel->
  "Out[300]=",ExpressionUUID->"5dfc2f75-0106-465c-82ff-3f1f205fe006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"atomicCoefficients", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"\[Psi]detector", ",", 
        RowBox[{"modeList", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Length", "[", "modeList", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"atomicCoefficients", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9211016467865405`*^9, 3.9211016789736776`*^9}, {
  3.9211017187233105`*^9, 3.921101781356139*^9}, {3.9212741924220285`*^9, 
  3.921274193226133*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"ed12f9bb-ed25-4fd7-82b6-4f29e408ff12"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "1"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "2"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"]}], ",", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "1"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ",", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "4"], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], " ", 
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"],
        TraditionalForm],
       TraditionalForm,
       Editable->True]}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        TagBox[
         FormBox[
          SubscriptBox[
           TemplateBox[{"a"},
            "ConjugateTranspose"], "2"],
          TraditionalForm],
         TraditionalForm,
         Editable->True], "2"], "4"]}], "-", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "-", 
     FractionBox[
      SuperscriptBox[
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], "2"], "4"], "+", 
     FractionBox[
      RowBox[{
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"],
         TraditionalForm],
        TraditionalForm,
        Editable->True], " ", 
       TagBox[
        FormBox[
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"],
         TraditionalForm],
        TraditionalForm,
        Editable->True]}], "2"]}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9211016727828827`*^9, 3.9211016793482447`*^9}, 
   3.9211017817904043`*^9, 3.9212741510058155`*^9, 3.9212741957451763`*^9},
 CellLabel->
  "Out[304]//TraditionalForm=",ExpressionUUID->"115bc7f7-89e6-465c-aedb-\
9340db4d6a3f"]
}, Open  ]],

Cell["\<\
Form a table of the subscripts of the a op pairs and the coefficient and sign \
of each for each atom state coefficient, then compare the subscript pairs \
between all atomic coefficients to find matches so we can reconstruct the \
possible states we can herald. (basically, automate what\[CloseCurlyQuote]s \
below.)\
\>", "Text",
 CellChangeTimes->{
  3.921250397960596*^9},ExpressionUUID->"c33fbcea-b064-48ff-94cb-\
fc6f7aa5141a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MonomialList", "[", 
  RowBox[{"atomicCoefficients", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[307]:=",ExpressionUUID->"f873ce24-f1f0-4762-829d-ae2accc0a7d7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], "2"], "4"]}], ",", 
   FractionBox[
    RowBox[{
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], " ", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"],
       TraditionalForm],
      TraditionalForm,
      Editable->True]}], "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], "2"], "4"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], " ", 
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], "2"], "4"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], "2"], "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.921514869614708*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"eb37ba73-1931-4047-bc41-74e1da9ab9dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"atomicCoefficients", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215156259975996`*^9, 3.921515638741175*^9}, {
  3.9215161069612813`*^9, 3.9215161128536797`*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"e812169d-b292-4fee-a3d1-cec795299780"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    SuperscriptBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"], "4"]}], "-", 
  FractionBox[
   SuperscriptBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], "4"], "+", 
  FractionBox[
   RowBox[{
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], " ", 
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "2"], "-", 
  FractionBox[
   SuperscriptBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], "4"], "-", 
  FractionBox[
   RowBox[{
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], " ", 
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "2"], "-", 
  FractionBox[
   SuperscriptBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], "4"]}]], "Output",
 CellChangeTimes->{
  3.921515544320362*^9, {3.921515629413067*^9, 3.921515640258205*^9}, {
   3.9215161089945307`*^9, 3.921516113324114*^9}},
 CellLabel->
  "Out[342]=",ExpressionUUID->"476245e4-ec7c-4332-a0bf-ce269d6055a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{"atomicCoefficients", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{
     SubscriptBox[
      RowBox[{"a", "\[ConjugateTranspose]"}], "i"], 
     SubscriptBox[
      RowBox[{"a", "\[ConjugateTranspose]"}], "j"]}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"i", "->", "1"}], ",", 
    RowBox[{"j", "->", "5"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.921515505309975*^9, 3.921515523913128*^9}, {
  3.921515556215554*^9, 3.9215155733092346`*^9}, {3.9215156486259675`*^9, 
  3.921515651964598*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"884add1b-c438-4185-8770-f508bf168a1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      TagBox[
       FormBox[
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"],
        TraditionalForm],
       TraditionalForm,
       Editable->True], "2"], "4"]}], "-", 
   FractionBox[
    SuperscriptBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"], "4"], "+", 
   FractionBox[
    RowBox[{
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], " ", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"],
       TraditionalForm],
      TraditionalForm,
      Editable->True]}], "2"], "-", 
   FractionBox[
    SuperscriptBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"], "4"], "-", 
   FractionBox[
    RowBox[{
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], " ", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"],
       TraditionalForm],
      TraditionalForm,
      Editable->True]}], "2"], "-", 
   FractionBox[
    SuperscriptBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"], "4"]}], "}"}]], "Output",
 CellChangeTimes->{{3.92151549921377*^9, 3.921515525417531*^9}, {
   3.9215155582944613`*^9, 3.9215155741907177`*^9}, 3.9215156524005876`*^9},
 CellLabel->
  "Out[325]=",ExpressionUUID->"ca89e004-9de7-47ea-98d2-5be05e46f379"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], "2"], "==", 
  RowBox[{
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}]}]], "Input",
 CellChangeTimes->{{3.921516084413707*^9, 3.921516095560417*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"06b05388-bfcf-41aa-8f35-7286ae77b6e5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9215160960610685`*^9},
 CellLabel->
  "Out[340]=",ExpressionUUID->"57d1859e-94d7-4a8a-9d9e-355d56b3d867"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      SuperscriptBox["#", "2"]}], "]"}], "&"}], ",", 
   RowBox[{
    RowBox[{"Variables", "[", 
     RowBox[{"atomicCoefficients", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], 
    TagBox[
     FormBox["",
      TraditionalForm],
     TraditionalForm,
     Editable->True]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.921515668841592*^9, {3.9215157012770505`*^9, 3.9215157036629667`*^9}, {
   3.921515884694931*^9, 3.921516032423938*^9}, {3.9215160707268977`*^9, 
   3.9215160708915215`*^9}},
 CellLabel->
  "In[343]:=",ExpressionUUID->"ff5f7949-0fd3-4855-a6d6-d4fe63d7ef0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921515683858842*^9, 3.921515704158635*^9}, {
   3.9215158990407314`*^9, 3.9215159224249964`*^9}, {3.9215159629743648`*^9, 
   3.9215160329234076`*^9}, 3.921516071924082*^9, 3.9215161163746195`*^9},
 CellLabel->
  "Out[343]=",ExpressionUUID->"06b09f62-8478-455e-85f3-474f338204db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "x", " ", "y"}], "+", "x", "+", "y"}], ",", 
   RowBox[{"x", " ", "y"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921515781724655*^9, 3.921515784790674*^9}, {
  3.9215158341588917`*^9, 3.9215158442246027`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"e94b33ef-33bb-4452-a84a-19f5bc36c972"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.921515844842166*^9},
 CellLabel->
  "Out[329]=",ExpressionUUID->"e305f8e2-ce58-4aa0-af09-da1855740bdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Variables", "[", 
  RowBox[{"atomicCoefficients", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[345]:=",ExpressionUUID->"5ab3263b-cdfe-4732-b015-2ca022c49cd4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "1"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "3"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "5"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{3.921516279990547*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"879ec2bf-19f9-477e-a253-5f735e533383"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{
    RowBox[{"Variables", "[", 
     RowBox[{"atomicCoefficients", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], 
    TagBox[
     FormBox["",
      TraditionalForm],
     TraditionalForm,
     Editable->True]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215162963587923`*^9, 
  3.921516312845865*^9}},ExpressionUUID->"f0048fbd-672b-4293-9928-\
ac527980ac7b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"]}], ",", 
   FractionBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921516290063952*^9, 3.9215163087906065`*^9}},
 CellLabel->
  "Out[349]=",ExpressionUUID->"e26a76ad-46b7-497e-9786-ab936b49a7a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], ",", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], ",", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], ",", 
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"],
       TraditionalForm],
      TraditionalForm,
      Editable->True]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.9215162643735185`*^9, {3.921516306714356*^9, 3.9215163068452473`*^9}, {
   3.9215163762908535`*^9, 3.9215163819743695`*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"adc70d77-48ed-48d3-a98a-b1f64039e3b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.921516265741476*^9, 3.9215163073760605`*^9}, {
  3.9215163776247344`*^9, 3.9215163832123013`*^9}},
 CellLabel->
  "Out[353]=",ExpressionUUID->"d3c7b4e1-38ce-4649-80db-42e3c74d998b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"Map", "[", 
    RowBox[{"TraditionalForm", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "1"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "3"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "5"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9215163470837917`*^9, 3.9215164367339106`*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"05a976b1-146c-4103-9076-1c7ffb4bae5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"]}], ",", 
   FractionBox[
    TagBox[
     FormBox[
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"],
      TraditionalForm],
     TraditionalForm,
     Editable->True], "2"], ",", 
   RowBox[{"-", 
    FractionBox[
     TagBox[
      FormBox[
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"],
       TraditionalForm],
      TraditionalForm,
      Editable->True], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215164222066865`*^9, 3.9215164371581497`*^9}},
 CellLabel->
  "Out[356]=",ExpressionUUID->"be45c175-8574-421d-a0be-38307b5803c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"opVars", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"a", "\[ConjugateTranspose]"}], "i"], 
     SubscriptBox[
      RowBox[{"a", "\[ConjugateTranspose]"}], "j"]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}], 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"Map", "[", 
    RowBox[{"TraditionalForm", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "1"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "3"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "5"], ",", 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], "}"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9215167988539286`*^9, 3.9215168595565834`*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"2d8c9107-90ef-459a-b85b-e583b7e5542b"],

Cell[BoxData[
 TemplateBox[{
  "Table", "nliter", 
   "\"Non-list iterator \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"i\\\", \\\",\\\", \\\"1\\\", \\\",\\\", RowBox[{\\\"4\\\", \\\" \
\\\", \\\"Natoms\\\"}]}], \\\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", RowBox[{\
\\\"i\\\", \\\",\\\", \\\"1\\\", \\\",\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"Natoms\\\"}]}], \\\"}\\\"}]}]\\) at position \\!\\(\\*RowBox[{\\\"2\\\"}]\
\\) does not evaluate to a real numeric value.\"", 2, 368, 45, 
   34525772395380345542, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9215168821229744`*^9},
 CellLabel->
  "During evaluation of \
In[368]:=",ExpressionUUID->"bd1f99e3-4f94-42f1-8202-4476334ef012"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"ConjugateTranspose", "[", "a", "]"}], "i"], " ", 
    SubscriptBox[
     RowBox[{"ConjugateTranspose", "[", "a", "]"}], "j"]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"4", " ", "Natoms"}]}], "}"}], " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"4", " ", "Natoms"}]}], "}"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.9215168822035*^9},
 CellLabel->
  "Out[368]=",ExpressionUUID->"c8f34380-2b2d-4c39-8d90-15b431201ce4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opVars", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "i"], 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "j"]}], "//", 
      "TraditionalForm"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "i", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9215168926237993`*^9, 3.921516936092896*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"e93dea84-3205-4dbc-a518-ca192761bf22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "1", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "2", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "3", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "3"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "4", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "5", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "5"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "6", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "6"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "7", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     RowBox[{
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "7"], " ", 
      SubscriptBox[
       TemplateBox[{"a"},
        "ConjugateTranspose"], "8"]}],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubsuperscriptBox[
      RowBox[{"(", 
       TemplateBox[{"a"},
        "ConjugateTranspose"], ")"}], "8", "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215168822300105`*^9, 3.921516936506918*^9}},
 CellLabel->
  "Out[374]=",ExpressionUUID->"deb9ff63-69e7-4e63-bb00-c09700d1fe32"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"opVars", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "i"], 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "j"]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"4", "*", "Natoms"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "i", ",", 
        RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9215169851239877`*^9, 3.921517000891748*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"82acf61c-dcff-438f-8959-da749b22f9e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"Map", "[", 
    RowBox[{"TraditionalForm", ",", "opVars"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921516958032694*^9, 3.921516959875744*^9}, {
  3.9215170043328657`*^9, 3.9215170107793307`*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"385c280f-cbf6-4d1b-9145-203cdab3a969"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.9215169602900505`*^9, 3.921517011474728*^9},
 CellLabel->
  "Out[378]=",ExpressionUUID->"37415b72-65a0-4970-8084-39a52b3a5e56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"atomicCoefficients", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox[
       RowBox[{"a", "\[ConjugateTranspose]"}], "1"], 
      SubscriptBox[
       RowBox[{"a", "\[ConjugateTranspose]"}], "1"]}], ")"}], "//", 
    "TraditionalForm"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215170321739388`*^9, 3.9215170799141316`*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"5f4d47fa-9e62-473c-aecd-9eee5bb87601"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9215170654073334`*^9, 3.9215170802791214`*^9}},
 CellLabel->
  "Out[382]=",ExpressionUUID->"b3e68d44-a108-4f4c-a74f-4aa95b6ef97c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Product", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215165014907265`*^9, 3.921516536509223*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"82e1ffd1-63c9-4e04-8ec7-85088b6a8309"],

Cell[BoxData[
 TemplateBox[{
  "Product", "itraw", 
   "\"Raw object \\!\\(\\*RowBox[{\\\"1\\\"}]\\) cannot be used as an \
iterator.\"", 2, 365, 43, 34525772395380345542, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9215165369067087`*^9},
 CellLabel->
  "During evaluation of \
In[365]:=",ExpressionUUID->"d9fba332-2a1b-4636-8710-a5bc29887fa9"],

Cell[BoxData[
 TemplateBox[{
  "Product", "vloc", 
   "\"The variable \\!\\(\\*RowBox[{\\\"1\\\"}]\\) cannot be localized so \
that it can be assigned to numerical values.\"", 2, 365, 44, 
   34525772395380345542, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.921516536956326*^9},
 CellLabel->
  "During evaluation of \
In[365]:=",ExpressionUUID->"8819ca62-9159-480b-9ad9-d4f9e88a10e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FlattenOuter", "[", 
  RowBox[{"Times", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215167202075167`*^9, 
  3.92151676247363*^9}},ExpressionUUID->"94d8e6b0-2791-4a72-ad6d-\
22dd339e8036"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6", ",", "9", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8", ",", "12", ",", "16"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.921516723740019*^9},
 CellLabel->
  "Out[367]=",ExpressionUUID->"18f43c1f-1b3c-4c30-b245-b9b9a43818d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}]], "Input",
 CellChangeTimes->{3.9215166756573524`*^9},
 CellLabel->
  "In[366]:=",ExpressionUUID->"0f10cecd-8417-4355-ae10-f87939dab213"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "4", ",", "9", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.921516676089758*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"f2dff92d-a3d6-49b4-ae94-f46acf3da916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921515761110555*^9, 3.9215157614409914`*^9}, 
   3.9215162780096965`*^9},ExpressionUUID->"3c86929a-8a79-415e-af99-\
027dc4538593"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "1"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "3"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "5"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{3.921515761844223*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"e9296bbe-158a-4eec-ad58-745982f67811"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "i"], 
       SubscriptBox[
        RowBox[{"a", "\[ConjugateTranspose]"}], "j"]}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"4", "*", "Natoms"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", 
     RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921250459550417*^9, 3.9212504616003284`*^9}, {
  3.921250521543375*^9, 3.921250522069909*^9}, {3.921508231782755*^9, 
  3.9215082600991087`*^9}, {3.921514302157346*^9, 3.9215143090657*^9}, {
  3.9215148519917536`*^9, 3.921514984398899*^9}, {3.921515014714718*^9, 
  3.921515026207841*^9}, {3.9215150712917256`*^9, 3.921515071674635*^9}, {
  3.921515362873934*^9, 3.9215154372409983`*^9}, {3.921515488559702*^9, 
  3.92151549027555*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"9784a9c2-56db-428a-9a92-abbfa79a98c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          TagBox[
           FormBox[
            SubscriptBox[
             TemplateBox[{"a"},
              "ConjugateTranspose"], "1"],
            TraditionalForm],
           TraditionalForm,
           Editable->True], "2"], "4"]}], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "1"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "5"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "3"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], " ", 
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True]}], "2"], "-", 
       FractionBox[
        SuperscriptBox[
         TagBox[
          FormBox[
           SubscriptBox[
            TemplateBox[{"a"},
             "ConjugateTranspose"], "7"],
           TraditionalForm],
          TraditionalForm,
          Editable->True], "2"], "4"]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921515418123742*^9, 3.9215154379905653`*^9}, 
   3.9215154914237504`*^9},
 CellLabel->
  "Out[316]=",ExpressionUUID->"ab6099e7-1817-4415-b0a1-b87c9f31312b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "5", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"Except", "[", "0", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215151112428236`*^9, 3.9215151282241697`*^9}, {
  3.9215152023923845`*^9, 3.921515230671771*^9}, {3.921515351625643*^9, 
  3.9215153554578233`*^9}},
 CellLabel->
  "In[313]:=",ExpressionUUID->"5dfa06f7-549f-4049-b41f-60bffddb9bd3"],

Cell[BoxData[
 RowBox[{"{", "5", "}"}]], "Output",
 CellChangeTimes->{{3.9215152091065097`*^9, 3.9215152313078127`*^9}, 
   3.921515355891821*^9},
 CellLabel->
  "Out[313]=",ExpressionUUID->"3fc0519e-8271-4f35-8319-fb93915eb8d4"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.921514378592404*^9, 3.9215143848410015`*^9}, {
  3.9215144940591455`*^9, 3.9215145018782434`*^9}, {3.9215145545547743`*^9, 
  3.9215145909381013`*^9}, {3.921514844915944*^9, 
  3.9215148453143086`*^9}},ExpressionUUID->"7f31760b-ebef-4935-af64-\
808ceaa7dc05"],

Cell[TextData[{
 "By inspection, there are no pairs of photons that would herald a state ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "1ff9d43b-595e-42dc-abe5-0ae1306c5c38"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "11c43963-7895-4642-aad1-937ccfe4a846"],
 " or ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "fd9b2e43-c7fd-496e-a965-4031fe5a56a4"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "08782da1-45dc-499c-b456-c0e7e5a032fe"],
 ", so we can break up \[Psi]out into two parts and analyze the coefficients \
to see which measurements herald which states. For now, we will assume the \
detectors are not number resolving and ignore the states with two photons in \
the same mode."
}], "Text",
 CellChangeTimes->{{3.920909496236785*^9, 3.9209095898884883`*^9}, {
  3.9209097149915366`*^9, 3.920909741874401*^9}, {3.9211019130215664`*^9, 
  3.9211020211751757`*^9}, {3.921250392028551*^9, 
  3.921250392934794*^9}},ExpressionUUID->"93bc6892-64e1-4b24-806f-\
03bb40bc4e25"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}]}], TraditionalForm]],
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9},ExpressionUUID->"f636a1c0-99bf-4fb3-8cc4-\
a2abe680dc38"]], "Text",
 CellChangeTimes->{{3.920908499708667*^9, 3.920908501992181*^9}, {
  3.920908884008483*^9, 
  3.9209088929508543`*^9}},ExpressionUUID->"7d5f4521-086e-436a-8e03-\
cf745980cc1b"],

Cell[TextData[{
 "8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"534a8ab5-5e1f-4d16-baf8-ff26d3788ec9"],
 ": ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "61e5c839-4370-493f-82d6-04bbde56d102"],
 ",  ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "24199335-6823-411b-a7ed-daf4cf70c3aa"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "000c9f86-451c-43bd-b765-472724fe6c2e"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "79f0bddb-340a-4ed5-a49f-4c51e09f87aa"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "acd2c971-7f59-40e7-aaee-b6f172e019ce"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "792d2bd8-aa13-45c8-99f1-a65f527ec373"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "49c1e81b-032b-4125-9727-49bf8f534941"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "63a71717-6c19-44e8-8e9f-9d762f443bc0"],
 " \n\n8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"df68b6ae-74d3-46c5-b836-18f3a7921f89"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "f9ac070a-a2e2-4440-999a-73c1a294b05c"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "00e697e0-242f-40b2-81a8-a06d5ed687e4"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{
       RowBox[{" ", "a"}]},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "fb338ce1-b557-4100-a172-9ea1f755eaeb"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "da7400d8-00ea-46c3-8045-25fc4c74dbce"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "0e8c205a-148f-471c-9769-dad39f48d15e"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "8152645d-5605-4b62-8b5b-ebfc1c19380d"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "dd18faa4-4cdc-49f7-9cf2-8233948317e5"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "41ae76da-7628-415a-ba8e-d60b6e7329a7"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.9209094747263203`*^9}, {3.9209096048768697`*^9, 3.920909630876568*^9}, {
   3.9209096731675744`*^9, 
   3.9209096835364027`*^9}},ExpressionUUID->"35b21fe6-90a3-43bd-89be-\
9cf12e436387"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "1", "2"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "3", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "5", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "7", "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "2"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "2", "2"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "4", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "6", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "8", "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "2"]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",ExpressionUUID->"dad91494-\
fe8c-4806-83f5-f20924a2435f"],

Cell[TextData[{
 "2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " "}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"1aaad9ab-c69e-4034-b677-4aeec66e8e9b"],
 "and 2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", "."}]}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"7ff5f596-97e9-4fe0-bebc-076efd1b2cd1"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.920909487348649*^9}, {3.9209096437272034`*^9, 3.9209097101183753`*^9}, {
   3.920909746659487*^9, 
   3.920909750477916*^9}},ExpressionUUID->"0b1be21c-cfff-4364-b85d-\
26f66ae61d52"],

Cell["\<\
16 patterns for heralding Bell states, each with an |amplitude| 1/4. 4 \
patterns which herald product states, each with |amplitude| 1/2. 8 two-photon \
patterns which we can\[CloseCurlyQuote]t resolve,  with |amplitude| 1/4. \
Normalize the state.\
\>", "Text",
 CellChangeTimes->{{3.920909783315935*^9, 
  3.9209099797394195`*^9}},ExpressionUUID->"92c3b245-4719-4589-9a9f-\
728534f1aa19"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"norm", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"]}], "]"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "include", " ", "only", " ", "the", " ", "events", " ", "with", " ", 
    "photons", " ", "detected", " ", "in", " ", "different", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a Bell state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], "]"}], "/", 
  "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"3a4dc14e-72be-4169-9ab7-9438047721a1"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920910935549213*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"9de9aac6-beae-4723-acdc-8fd6d14a5f1d"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355722184`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"3795cea8-2617-4dba-b635-b31d63b2cace"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"c6aba67e-3386-4eed-a597-2a3948ba33f1"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"0b3b5349-3821-4ffc-b493-b9ecd20e80d5"]
}, Open  ]],

Cell["\<\
However, if we normalize to all possible detection events including \
two-photons arriving at the same detector, we find the odds of getting a Bell \
state are actually slightly less than what would be achieved with the \
traditional Bell measurement scheme:\
\>", "Text",
 CellChangeTimes->{{3.9209109734262447`*^9, 
  3.9209111154142923`*^9}},ExpressionUUID->"3b3358ff-c711-45d9-960d-\
0e4f39f7ef67"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "include", " ", "all", " ", "possible", " ", "detection", " ", "events"}],
     ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "even"}], " ", "those", " ", "with", 
     " ", "two", " ", "photons", " ", "detected", " ", "in", " ", "the", " ", 
     "same", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
  "\"\<Fraction of detection events which herald a Bell state:\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
   "]"}], "/", "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}, {3.9209111247604403`*^9, 
  3.920911231061555*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"0d66911a-0bd4-4fd2-9a0d-6f2059cbc638"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920911235927408*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"25a9ad02-444c-4e8d-b172-7d791b17ba42"],

Cell[BoxData[
 FractionBox["2", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"91fcbb0a-5f29-4fa9-86c8-2c1ef2bd6c98"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"8ef7d732-8020-46fe-974d-77ea81ee2895"],

Cell[BoxData[
 FractionBox["3", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"6b49c163-ad4a-4616-8fa2-d14778bfb603"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Just two atoms - programmatically get measurement outcomes - notation  change \
(the verbose version of the simplified code above)\
\>", "Subsection",
 CellChangeTimes->{{3.9208982628761587`*^9, 3.920898275686413*^9}, {
  3.9209112700040255`*^9, 3.9209112771932592`*^9}, {3.9211003748650594`*^9, 
  3.92110040043661*^9}, {3.9215172819233246`*^9, 3.9215172920915737`*^9}, {
  3.921517461056675*^9, 3.921517461729881*^9}, {3.9220992871644664`*^9, 
  3.922099300497089*^9}},ExpressionUUID->"e61a11c5-2701-419a-b2fb-\
41b744005df9"],

Cell[TextData[{
 "Note that in my handwritten notes (the equation below comes from page 7, \
eq. 11), I use primed subscripts for the output of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "98ed8125-73ae-4ad1-a171-973aee1af747"],
 ". Here, I omit the primes, as c,d unambiguously refer to the c,d ports of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["BS", "2"], TraditionalForm]],ExpressionUUID->
  "300bf95b-b407-45d3-a076-9c98a3c588e8"],
 ". \n\nInterestingly, this scheme has a lower probability of heralding Bell \
states compared to the standard Bell measurement scheme. This may be the \
reason that path deformation gate schemes typically initialize the different \
spins in a particular state rather than superpositions."
}], "Text",
 CellChangeTimes->{{3.920901720564152*^9, 3.920901795554597*^9}, {
  3.9209121207290125`*^9, 
  3.920912250976545*^9}},ExpressionUUID->"25586c9a-c79c-4bae-b0c5-\
c6b8b202bf7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "Ket", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "ci"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["h", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["v", "di"], "\[ConjugateTranspose]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"0"},
    "Ket"], "2"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "1"], ";", 
  SubscriptBox[
   TemplateBox[{"1"},
    "Ket"], "2"], ";"}]}], "Input",
 CellChangeTimes->{{3.9208425451993303`*^9, 3.920842552569414*^9}, {
  3.920842584840373*^9, 3.920842602216781*^9}, {3.9208426416163654`*^9, 
  3.9208426420897818`*^9}, {3.920842773439519*^9, 3.9208427859595356`*^9}, {
  3.9208983126438646`*^9, 3.920898372082747*^9}, {3.920903224708039*^9, 
  3.9209032319227448`*^9}, {3.92090542764618*^9, 3.9209054891300173`*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"6e5dd0a2-eb54-45ef-a198-5625c967de37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]out", "=", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"1", ",", "2"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "1"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d2"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"1", ",", "2"}]]}]]}]}], " ", ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "d1"]}]}], " ", 
              ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]h", 
                RowBox[{"2", ",", "1"}]]}]]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"h", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}]}]}],
            ")"}]}], "+", 
         RowBox[{
          SubscriptBox[
           TemplateBox[{"1"},
            "Ket"], "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox[
               RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "-", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c2"]}]}], ")"}], "-", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox[
                RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                SubscriptBox[
                 RowBox[{"v", "\[ConjugateTranspose]"}], "d1"]}]}], ")"}], 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               SubscriptBox["\[Phi]v", 
                RowBox[{"2", ",", "1"}]]}]]}]}], " ", ")"}]}]}], ")"}]}]}], 
     "]"}], "//", "Expand"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]out", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.9208983014527082`*^9, 3.9208983106025877`*^9}, {
  3.9208983737628946`*^9, 3.9208983887232723`*^9}, {3.9208984358232656`*^9, 
  3.920898591923049*^9}, {3.9209016845919504`*^9, 3.920901712014367*^9}, {
  3.920901939789465*^9, 3.9209019407240276`*^9}, {3.920902332629814*^9, 
  3.92090237181341*^9}, {3.920902406188398*^9, 3.920902408983692*^9}, {
  3.9209024399533453`*^9, 3.920902492528591*^9}, {3.9209025790340786`*^9, 
  3.9209026636628184`*^9}, {3.9209030942448826`*^9, 3.920903094352373*^9}, {
  3.9209032376531315`*^9, 3.9209032549953628`*^9}, {3.9209033231446137`*^9, 
  3.9209034397556295`*^9}, {3.920903474613057*^9, 3.920903502542235*^9}, {
  3.9209035527683725`*^9, 3.9209035623948717`*^9}, {3.9209053834207935`*^9, 
  3.9209053856799407`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"f38e86be-f385-4d49-83a1-cf1745bdb239"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c1", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"h"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    SubscriptBox[
     TemplateBox[{"h"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "c2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    SubsuperscriptBox[
     RowBox[{"(", 
      TemplateBox[{"v"},
       "ConjugateTranspose"], ")"}], "d2", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "c2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d1"], " ", 
    SubscriptBox[
     TemplateBox[{"v"},
      "ConjugateTranspose"], "d2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.920902623728285*^9, 3.9209026579341955`*^9}, 
   3.920903094762336*^9, {3.920903239102376*^9, 3.920903255412464*^9}, 
   3.9209033293915825`*^9, 3.920903452252228*^9, 3.9209035040220175`*^9, 
   3.9209035634946175`*^9, {3.9209053915826855`*^9, 3.9209054176898527`*^9}, 
   3.920905448412149*^9, 3.9209054915938644`*^9, 3.9209060016476393`*^9, 
   3.921517476862832*^9},
 CellLabel->
  "Out[398]//TraditionalForm=",ExpressionUUID->"3065fefe-d707-4315-a04e-\
90b098255217"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]organized", "=", "\[Psi]out"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"atom1", "=", "0"}], ",", 
    RowBox[{"atom1", "<", "2"}], ",", 
    RowBox[{"atom1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom2", "=", "0"}], ",", 
       RowBox[{"atom2", "<", "2"}], ",", 
       RowBox[{"atom2", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"mode1", "=", "1"}], ",", 
          RowBox[{"mode1", "<", "3"}], ",", 
          RowBox[{"mode1", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"mode2", "=", "1"}], ",", 
             RowBox[{"mode2", "<", "3"}], ",", 
             RowBox[{"mode2", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"mode1", "!=", "mode2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"\[Psi]organized", "=", 
                RowBox[{"Collect", "[", 
                 RowBox[{"\[Psi]organized", ",", 
                  RowBox[{
                   SubscriptBox[
                    TemplateBox[{"atom1"},
                    "Ket"], "mode1"], 
                   SubscriptBox[
                    TemplateBox[{"atom2"},
                    "Ket"], "mode2"]}]}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]organized", "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.920903573694778*^9, 3.920903574752097*^9}},
 CellLabel->
  "In[399]:=",ExpressionUUID->"b79ac29f-8c0d-4a90-93ba-5311b7e926b2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c1"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "c2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "c2"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d1"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d1"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"h"},
         "ConjugateTranspose"], "d2"], " ", 
       SubscriptBox[
        TemplateBox[{"v"},
         "ConjugateTranspose"], "d2"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "c2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"h"},
          "ConjugateTranspose"], "d2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"h"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c1"], " ", 
         SubscriptBox[
          TemplateBox[{"v"},
           "ConjugateTranspose"], "c2"]}], "2"]}], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "c2", "2"], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d1"], " ", 
        SubscriptBox[
         TemplateBox[{"v"},
          "ConjugateTranspose"], "d2"]}], "2"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d1", "2"], "4"], "+", 
      FractionBox[
       SubsuperscriptBox[
        RowBox[{"(", 
         TemplateBox[{"v"},
          "ConjugateTranspose"], ")"}], "d2", "2"], "4"]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.920903525777152*^9, {3.920903568207063*^9, 3.9209035751443443`*^9}, {
   3.9209053950204105`*^9, 3.9209054199799986`*^9}, 3.9209054933797417`*^9, 
   3.9209060055955195`*^9, 3.9215174794238844`*^9},
 CellLabel->
  "Out[401]//TraditionalForm=",ExpressionUUID->"cc763afb-a676-426c-914c-\
1e6fc169377f"]
}, Open  ]],

Cell["\<\
Simplify the result by assuming we have some way to set the phases to zero \
(up to an overall phase).\
\>", "Text",
 CellChangeTimes->{{3.9209036135627894`*^9, 
  3.920903676611619*^9}},ExpressionUUID->"cc501e67-ac4b-41dc-a6b5-\
02a7e6aef78e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubscriptBox["\[Phi]h", 
    RowBox[{"1", ",", "2"}]], "=", " ", 
   RowBox[{
    SubscriptBox["\[Phi]h", 
     RowBox[{"2", ",", "1"}]], "=", " ", 
    RowBox[{
     SubscriptBox["\[Phi]v", 
      RowBox[{"1", ",", "2"}]], "=", 
     RowBox[{
      SubscriptBox["\[Phi]v", 
       RowBox[{"2", ",", "1"}]], "=", "0"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92090369657924*^9, 3.920903721461937*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d12f9960-daef-4514-86c5-df10dcaf0acd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9209037220716763`*^9, 3.9209054067898936`*^9, 
  3.9209060103270197`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"0a3d1360-cc4e-43ae-8354-5ae1dc95fd35"]
}, Open  ]],

Cell["\<\
Todo: find a way to programatically replace the h and v ops with a\
\[CloseCurlyQuote]s. 

Let\[CloseCurlyQuote]s rewrite the operators in terms of the detector pixels, \
numbered 1-8, in order to simplify reading off the measurement results.\
\>", "Text",
 CellChangeTimes->{{3.920905151040154*^9, 3.920905206380886*^9}, {
  3.9211018250911164`*^9, 
  3.9211018611355257`*^9}},ExpressionUUID->"d3dba80c-8748-4176-a5a0-\
08d0b884d0be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nModes", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getSubscript", "[", "op_", "]"}], ":=", 
   RowBox[{"StringSplit", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"op", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPolarization", "[", "op_", "]"}], ":=", 
   RowBox[{"StringTake", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "op", "]"}], ",", "\"\<]\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getADagger", "[", "hvDagger_", "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<a\>\"", ",", 
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", "hvDagger", "]"}], ",", 
                  "\"\<]\>\""}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "==", "\"\<h\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
          ",", "1", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<v\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<c\>\""}], ")"}]}], 
          ",", "2", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<h\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
          ",", "3", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"getPolarization", "[", "hvDagger", "]"}], "==", 
             "\"\<v\>\""}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<d\>\""}], ")"}]}], 
          ",", "4"}], "]"}], "+", 
        RowBox[{"4", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"ToExpression", "[", 
            RowBox[{
             RowBox[{"getSubscript", "[", "hvDagger", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}]}], 
       "]"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9212713976116905`*^9, 3.9212713987281322`*^9}, {
  3.921271641378909*^9, 3.9212716613062143`*^9}, {3.9212717869767833`*^9, 
  3.9212717884614677`*^9}, {3.9212720442436876`*^9, 3.921272181363143*^9}, {
  3.9212722125911903`*^9, 3.921272219238958*^9}, {3.9212722746396704`*^9, 
  3.9212723074921513`*^9}, {3.9212723709015265`*^9, 3.9212723712225895`*^9}, {
  3.9212724871415586`*^9, 3.921272537731552*^9}, {3.921272574105748*^9, 
  3.921272576041379*^9}, {3.9212727134642515`*^9, 3.9212727177353354`*^9}, {
  3.921272790971791*^9, 3.921272860974622*^9}, {3.9212729239097424`*^9, 
  3.9212729288691273`*^9}, {3.9212730364212275`*^9, 3.9212730553763285`*^9}, {
  3.92127310059873*^9, 3.9212731216821413`*^9}, {3.921273605864589*^9, 
  3.9212736059075794`*^9}, {3.921273700444727*^9, 3.9212737140450087`*^9}, {
  3.921517550524207*^9, 3.921517673273349*^9}},
 CellLabel->
  "In[405]:=",ExpressionUUID->"1e7b700c-eea0-4a8f-a087-7588cc07117d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getADagger", "[", 
  SubscriptBox[
   RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "]"}]}], "Input",
 CellChangeTimes->{{3.921271668322682*^9, 3.9212717039972754`*^9}, {
  3.921272127547654*^9, 3.921272157467417*^9}, {3.921272194454615*^9, 
  3.9212721945436883`*^9}, {3.9212722855108447`*^9, 3.9212722855618944`*^9}, {
  3.9212723246403165`*^9, 3.9212723312144327`*^9}, {3.9212728243953686`*^9, 
  3.9212728244213243`*^9}, {3.921272948773532*^9, 3.921272948826912*^9}, {
  3.9212731269210405`*^9, 3.9212731356061215`*^9}, {3.921273615285166*^9, 
  3.9212736720105524`*^9}},
 CellLabel->
  "In[409]:=",ExpressionUUID->"8847451f-10df-4986-99ca-16346de7c458"],

Cell[BoxData["a1"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.921517677164987*^9},
 CellLabel->
  "Out[409]=",ExpressionUUID->"58118228-6389-4ab8-9fa1-0e24521ba445"],

Cell[BoxData["a2"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.921517677172784*^9},
 CellLabel->
  "Out[410]=",ExpressionUUID->"aa746e28-6d5d-4027-a8bf-13f818b8dcbc"],

Cell[BoxData["a3"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.921517677172784*^9},
 CellLabel->
  "Out[411]=",ExpressionUUID->"e50a3b81-280d-4e9e-a0b7-e40e165db3db"],

Cell[BoxData["a4"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.92151767718999*^9},
 CellLabel->
  "Out[412]=",ExpressionUUID->"e4ba0bef-fe6e-49a3-97d7-0a7775883c82"],

Cell[BoxData["a5"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.9215176772071505`*^9},
 CellLabel->
  "Out[413]=",ExpressionUUID->"38e13d80-0f19-464d-ad66-f8c9a2e67755"],

Cell[BoxData["a6"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.9215176772071505`*^9},
 CellLabel->
  "Out[414]=",ExpressionUUID->"b2ab640f-0f8d-4ee3-8df6-07336220b704"],

Cell[BoxData["a7"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.921517677223789*^9},
 CellLabel->
  "Out[415]=",ExpressionUUID->"4e61a404-1bca-4278-b582-3c0dca4f0315"],

Cell[BoxData["a8"], "Output",
 CellChangeTimes->{{3.921272518927423*^9, 3.92127253949555*^9}, 
   3.9212727220360346`*^9, {3.9212728248952417`*^9, 3.9212728650838385`*^9}, {
   3.9212729306048336`*^9, 3.921272949336166*^9}, 3.921273059907093*^9, {
   3.9212731123665648`*^9, 3.9212731363320537`*^9}, {3.9212736187823763`*^9, 
   3.921273628291992*^9}, 3.9212736759215827`*^9, 3.921273715818369*^9, 
   3.921517677223789*^9},
 CellLabel->
  "Out[416]=",ExpressionUUID->"84b41e54-0fdd-4d28-8eb2-ac4213f7690e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nModes", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opList", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     SubscriptBox[
      RowBox[{"u", "\[ConjugateTranspose]"}], 
      RowBox[{"ToExpression", "[", 
       RowBox[{"ToString", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<````\>\"", ",", "port", ",", "mode"}], "]"}], "]"}], 
       "]"}]], ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "v"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"port", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mode", ",", 
       RowBox[{"Range", "[", "nModes", "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.921273238885843*^9, 3.9212733023003025`*^9}, {
  3.921273404155086*^9, 3.921273416979802*^9}, {3.9212734665428247`*^9, 
  3.9212735177298045`*^9}, {3.9212737318459377`*^9, 3.9212737407166014`*^9}, {
  3.9212738307539062`*^9, 3.9212738713445377`*^9}, {3.921273932100751*^9, 
  3.9212739394690847`*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"4335d170-7a0c-4740-a44a-3832106e4467"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "c1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "c2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "d1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "h", "]"}], "d2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "c1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "c2"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "d1"], ",", 
   SubscriptBox[
    RowBox[{"ConjugateTranspose", "[", "v", "]"}], "d2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9212735107852836`*^9, 3.9212735180818124`*^9}, 
   3.9212737410450287`*^9, {3.921273831427519*^9, 3.9212738719973764`*^9}, {
   3.9212739337375765`*^9, 3.9212739398410826`*^9}, 3.921517713939608*^9},
 CellLabel->
  "Out[418]=",ExpressionUUID->"5d3fdc43-57fd-4241-a620-7d1899cf0651"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrueQ", "[", 
  RowBox[{
   RowBox[{"opList", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "==", 
   SubscriptBox[
    RowBox[{"h", "\[ConjugateTranspose]"}], "c1"]}], "]"}]], "Input",
 CellChangeTimes->{{3.921273775979144*^9, 3.9212738104098763`*^9}, {
  3.921273841879959*^9, 3.9212738522860875`*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"02ac4ff2-07a0-44d2-93c1-da9a42d86bd6"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9212737978211684`*^9, 3.9212738745730414`*^9}, {
  3.9212739351491704`*^9, 3.921273940964737*^9}},
 CellLabel->
  "Out[293]=",ExpressionUUID->"78dd8061-f8d0-49dd-9bb1-cb022ded1dca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"getADagger", ",", "opList"}], "]"}]], "Input",
 CellChangeTimes->{{3.921273536304743*^9, 3.9212735515761194`*^9}, {
  3.921273918432233*^9, 3.9212739189601183`*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"02ddf7db-880e-45b0-a341-eb145d81685a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "1"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "5"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "3"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "7"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "2"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "6"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "4"],
     TraditionalForm],
    TraditionalForm,
    Editable->True], ",", 
   TagBox[
    FormBox[
     SubscriptBox[
      TemplateBox[{"a"},
       "ConjugateTranspose"], "8"],
     TraditionalForm],
    TraditionalForm,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{
  3.921273552205573*^9, 3.9212737511022625`*^9, {3.9212739194011965`*^9, 
   3.921273942054698*^9}},
 CellLabel->
  "Out[294]=",ExpressionUUID->"797aa666-39f5-463f-8dfd-15e363ed8e65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Psi]detector", "=", 
     RowBox[{"\[Psi]organized", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "c1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "1"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "c1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "2"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "d1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "3"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "d1"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "4"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "c2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "5"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "c2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "6"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"h", "\[ConjugateTranspose]"}], "d2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "7"]}], ",", 
        RowBox[{
         SubscriptBox[
          RowBox[{"v", "\[ConjugateTranspose]"}], "d2"], "->", 
         SubscriptBox[
          RowBox[{"a", "\[ConjugateTranspose]"}], "8"]}]}], "}"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Psi]detector", "=", 
   RowBox[{"\[Psi]organized", "/.", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"op", "->", 
       RowBox[{"getADagger", "[", "op", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"op", ",", "opList"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.920904827280583*^9, 3.9209049192778716`*^9}, {
  3.9209049716906166`*^9, 3.9209050257403984`*^9}, {3.920905251680399*^9, 
  3.9209052677012835`*^9}, {3.9209052981516542`*^9, 3.9209053301802425`*^9}, {
  3.921273979784286*^9, 3.9212740568486385`*^9}, {3.9215177385401907`*^9, 
  3.921517738656889*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"7baa1b82-0100-4dd5-8c4d-41eb190d49a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["a1", "2"], "4"], "+", 
     FractionBox[
      SuperscriptBox["a3", "2"], "4"], "+", 
     FractionBox[
      RowBox[{"a1", " ", "a5"}], "2"], "+", 
     FractionBox[
      SuperscriptBox["a5", "2"], "4"], "-", 
     FractionBox[
      RowBox[{"a3", " ", "a7"}], "2"], "+", 
     FractionBox[
      SuperscriptBox["a7", "2"], "4"]}], ")"}], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a2"}], "4"], "+", 
     FractionBox[
      RowBox[{"a2", " ", "a3"}], "4"], "-", 
     FractionBox[
      RowBox[{"a1", " ", "a4"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a4"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a2", " ", "a5"}], "4"], "-", 
     FractionBox[
      RowBox[{"a4", " ", "a5"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a6"}], "4"], "-", 
     FractionBox[
      RowBox[{"a3", " ", "a6"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a5", " ", "a6"}], "4"], "-", 
     FractionBox[
      RowBox[{"a2", " ", "a7"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a4", " ", "a7"}], "4"], "+", 
     FractionBox[
      RowBox[{"a6", " ", "a7"}], "4"], "-", 
     FractionBox[
      RowBox[{"a1", " ", "a8"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a8"}], "4"], "-", 
     FractionBox[
      RowBox[{"a5", " ", "a8"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a7", " ", "a8"}], "4"]}], ")"}], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "2"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "a1", " ", "a2"}], 
     "+", 
     FractionBox[
      RowBox[{"a2", " ", "a3"}], "4"], "-", 
     FractionBox[
      RowBox[{"a1", " ", "a4"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a4"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a2", " ", "a5"}], "4"], "-", 
     FractionBox[
      RowBox[{"a4", " ", "a5"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a6"}], "4"], "-", 
     FractionBox[
      RowBox[{"a3", " ", "a6"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a5", " ", "a6"}], "4"], "-", 
     FractionBox[
      RowBox[{"a2", " ", "a7"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a4", " ", "a7"}], "4"], "+", 
     FractionBox[
      RowBox[{"a6", " ", "a7"}], "4"], "-", 
     FractionBox[
      RowBox[{"a1", " ", "a8"}], "4"], "-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a8"}], "4"], "-", 
     FractionBox[
      RowBox[{"a5", " ", "a8"}], "4"], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "a7", " ", "a8"}], "4"]}], ")"}], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["a2", "2"], "4"], "+", 
     FractionBox[
      SuperscriptBox["a4", "2"], "4"], "-", 
     FractionBox[
      RowBox[{"a2", " ", "a6"}], "2"], "+", 
     FractionBox[
      SuperscriptBox["a6", "2"], "4"], "+", 
     FractionBox[
      RowBox[{"a4", " ", "a8"}], "2"], "+", 
     FractionBox[
      SuperscriptBox["a8", "2"], "4"]}], ")"}], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "2"]}]}]], "Output",
 CellChangeTimes->{{3.9212740480700493`*^9, 3.9212740577030435`*^9}, {
  3.9215177222898216`*^9, 3.9215177390235605`*^9}},
 CellLabel->
  "Out[421]=",ExpressionUUID->"d63022fc-4cd3-4782-befd-4cbd9cc68b40"]
}, Open  ]],

Cell["Get the \[OpenCurlyDoubleQuote]coefficients\[CloseCurlyDoubleQuote] of \
the atomic states", "Text",
 CellChangeTimes->{{3.921100465325042*^9, 
  3.921100490338769*^9}},ExpressionUUID->"b035c6e2-fd7c-4f31-9e94-\
96756e3e7378"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Natoms", " ", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"modeList", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mode1", "!=", "mode2"}], ",", 
       RowBox[{
        SubscriptBox[
         TemplateBox[{"atom1"},
          "Ket"], "mode1"], 
        SubscriptBox[
         TemplateBox[{"atom2"},
          "Ket"], "mode2"]}], ",", "Nothing"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mode1", ",", 
       RowBox[{"Range", "[", "Natoms", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mode2", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"mode1", ",", "Natoms"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"atom1", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"atom2", ",", "0", ",", "1"}], "}"}]}], "]"}], 
   " "}]}]}], "Input",
 CellChangeTimes->{{3.9215194172879086`*^9, 3.9215194330561595`*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"8f5c4af7-2bd6-4f86-8901-106ed1ada38d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.921519433905837*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"4bb15b7b-9e76-4099-bc55-58d9bf60850b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"atomicCoefficients", "=", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"\[Psi]detector", ",", 
       RowBox[{"modeList", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
    RowBox[{"Length", "[", "modeList", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9211016467865405`*^9, 3.9211016789736776`*^9}, {
  3.9211017187233105`*^9, 3.921101781356139*^9}, {3.9212741924220285`*^9, 
  3.921274193226133*^9}, {3.921517768973614*^9, 3.9215177717724953`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"4c9c5495-1205-4a45-81db-cde69291f15f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["a1", "2"], "4"], "+", 
    FractionBox[
     SuperscriptBox["a3", "2"], "4"], "+", 
    FractionBox[
     RowBox[{"a1", " ", "a5"}], "2"], "+", 
    FractionBox[
     SuperscriptBox["a5", "2"], "4"], "-", 
    FractionBox[
     RowBox[{"a3", " ", "a7"}], "2"], "+", 
    FractionBox[
     SuperscriptBox["a7", "2"], "4"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "a1", " ", "a2"}], 
    "+", 
    FractionBox[
     RowBox[{"a2", " ", "a3"}], "4"], "-", 
    FractionBox[
     RowBox[{"a1", " ", "a4"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a4"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a2", " ", "a5"}], "4"], "-", 
    FractionBox[
     RowBox[{"a4", " ", "a5"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a6"}], "4"], "-", 
    FractionBox[
     RowBox[{"a3", " ", "a6"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a5", " ", "a6"}], "4"], "-", 
    FractionBox[
     RowBox[{"a2", " ", "a7"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a4", " ", "a7"}], "4"], "+", 
    FractionBox[
     RowBox[{"a6", " ", "a7"}], "4"], "-", 
    FractionBox[
     RowBox[{"a1", " ", "a8"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a8"}], "4"], "-", 
    FractionBox[
     RowBox[{"a5", " ", "a8"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a7", " ", "a8"}], "4"]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a2"}], "4"], "+", 
    FractionBox[
     RowBox[{"a2", " ", "a3"}], "4"], "-", 
    FractionBox[
     RowBox[{"a1", " ", "a4"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a4"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a2", " ", "a5"}], "4"], "-", 
    FractionBox[
     RowBox[{"a4", " ", "a5"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a1", " ", "a6"}], "4"], "-", 
    FractionBox[
     RowBox[{"a3", " ", "a6"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a5", " ", "a6"}], "4"], "-", 
    FractionBox[
     RowBox[{"a2", " ", "a7"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a4", " ", "a7"}], "4"], "+", 
    FractionBox[
     RowBox[{"a6", " ", "a7"}], "4"], "-", 
    FractionBox[
     RowBox[{"a1", " ", "a8"}], "4"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a3", " ", "a8"}], "4"], "-", 
    FractionBox[
     RowBox[{"a5", " ", "a8"}], "4"], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a7", " ", "a8"}], "4"]}], ",", 
   RowBox[{
    FractionBox[
     SuperscriptBox["a2", "2"], "4"], "+", 
    FractionBox[
     SuperscriptBox["a4", "2"], "4"], "-", 
    FractionBox[
     RowBox[{"a2", " ", "a6"}], "2"], "+", 
    FractionBox[
     SuperscriptBox["a6", "2"], "4"], "+", 
    FractionBox[
     RowBox[{"a4", " ", "a8"}], "2"], "+", 
    FractionBox[
     SuperscriptBox["a8", "2"], "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9215177720725155`*^9, 3.921519458390152*^9, 
  3.9215195297717857`*^9},
 CellLabel->
  "Out[455]=",ExpressionUUID->"4b44c965-179b-4859-97ac-4da4a02bd0f9"]
}, Open  ]],

Cell["\<\
Form a table of the subscripts of the a op pairs and the coefficient and sign \
of each for each atom state coefficient, then compare the subscript pairs \
between all atomic coefficients to find matches so we can reconstruct the \
possible states we can herald. (basically, automate what\[CloseCurlyQuote]s \
below.)\
\>", "Text",
 CellChangeTimes->{
  3.921250397960596*^9},ExpressionUUID->"fe46663e-9346-4432-b914-\
c2cd00610a00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"atomicCoefficients", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215156259975996`*^9, 3.921515638741175*^9}, {
  3.9215161069612813`*^9, 3.9215161128536797`*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"ae6251bd-8ecd-4a7a-8725-1fa4c8143176"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["a1", "2"], "4"], "+", 
  FractionBox[
   SuperscriptBox["a3", "2"], "4"], "+", 
  FractionBox[
   RowBox[{"a1", " ", "a5"}], "2"], "+", 
  FractionBox[
   SuperscriptBox["a5", "2"], "4"], "-", 
  FractionBox[
   RowBox[{"a3", " ", "a7"}], "2"], "+", 
  FractionBox[
   SuperscriptBox["a7", "2"], "4"]}]], "Output",
 CellChangeTimes->{
  3.921515544320362*^9, {3.921515629413067*^9, 3.921515640258205*^9}, {
   3.9215161089945307`*^9, 3.921516113324114*^9}, 3.9215177944078207`*^9},
 CellLabel->
  "Out[428]=",ExpressionUUID->"321c89da-3d3b-49cb-a8a3-042578c2c5d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aOps", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<a\>\"", ",", 
       RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9215178093564415`*^9, 3.921517898287722*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"08f8adf8-92f1-4be1-b14d-1f4c2bc55d5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5", ",", "a6", ",", "a7", ",",
    "a8"}], "}"}]], "Output",
 CellChangeTimes->{{3.921517868922173*^9, 3.9215178755623817`*^9}, 
   3.9215179065840483`*^9},
 CellLabel->
  "Out[431]=",ExpressionUUID->"233e57ba-50ee-4430-a792-69a4e13d6790"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aOps", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<a\>\"", ",", 
         RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "]"}], 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<a\>\"", ",", 
         RowBox[{"ToString", "[", "j", "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "i", ",", 
       RowBox[{"4", "*", "Natoms"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.921517985506997*^9, 3.921518016841712*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"eadcdf08-4683-46f2-a378-4bb9c0e11628"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["a1", "2"], ",", 
   RowBox[{"a1", " ", "a2"}], ",", 
   RowBox[{"a1", " ", "a3"}], ",", 
   RowBox[{"a1", " ", "a4"}], ",", 
   RowBox[{"a1", " ", "a5"}], ",", 
   RowBox[{"a1", " ", "a6"}], ",", 
   RowBox[{"a1", " ", "a7"}], ",", 
   RowBox[{"a1", " ", "a8"}], ",", 
   SuperscriptBox["a2", "2"], ",", 
   RowBox[{"a2", " ", "a3"}], ",", 
   RowBox[{"a2", " ", "a4"}], ",", 
   RowBox[{"a2", " ", "a5"}], ",", 
   RowBox[{"a2", " ", "a6"}], ",", 
   RowBox[{"a2", " ", "a7"}], ",", 
   RowBox[{"a2", " ", "a8"}], ",", 
   SuperscriptBox["a3", "2"], ",", 
   RowBox[{"a3", " ", "a4"}], ",", 
   RowBox[{"a3", " ", "a5"}], ",", 
   RowBox[{"a3", " ", "a6"}], ",", 
   RowBox[{"a3", " ", "a7"}], ",", 
   RowBox[{"a3", " ", "a8"}], ",", 
   SuperscriptBox["a4", "2"], ",", 
   RowBox[{"a4", " ", "a5"}], ",", 
   RowBox[{"a4", " ", "a6"}], ",", 
   RowBox[{"a4", " ", "a7"}], ",", 
   RowBox[{"a4", " ", "a8"}], ",", 
   SuperscriptBox["a5", "2"], ",", 
   RowBox[{"a5", " ", "a6"}], ",", 
   RowBox[{"a5", " ", "a7"}], ",", 
   RowBox[{"a5", " ", "a8"}], ",", 
   SuperscriptBox["a6", "2"], ",", 
   RowBox[{"a6", " ", "a7"}], ",", 
   RowBox[{"a6", " ", "a8"}], ",", 
   SuperscriptBox["a7", "2"], ",", 
   RowBox[{"a7", " ", "a8"}], ",", 
   SuperscriptBox["a8", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215180084137173`*^9, 3.921518018022787*^9}},
 CellLabel->
  "Out[433]=",ExpressionUUID->"7e5bf8a0-3ae8-45c8-bd35-00311395db43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"atomicCoefficients", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"atomicCoefficients", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
   "aOps"}], "]"}]}], "Input",
 CellChangeTimes->{{3.921516958032694*^9, 3.921516959875744*^9}, {
  3.9215170043328657`*^9, 3.9215170107793307`*^9}, {3.9215181073569803`*^9, 
  3.9215181231412377`*^9}, {3.921518167913024*^9, 
  3.9215181904737496`*^9}},ExpressionUUID->"f986f0ee-4ea4-4348-a157-\
f307e7af466d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["a1", "2"], "4"], "+", 
  FractionBox[
   SuperscriptBox["a3", "2"], "4"], "+", 
  FractionBox[
   RowBox[{"a1", " ", "a5"}], "2"], "+", 
  FractionBox[
   SuperscriptBox["a5", "2"], "4"], "-", 
  FractionBox[
   RowBox[{"a3", " ", "a7"}], "2"], "+", 
  FractionBox[
   SuperscriptBox["a7", "2"], "4"]}]], "Output",
 CellChangeTimes->{
  3.9215169602900505`*^9, 3.921517011474728*^9, 3.9215180716393332`*^9, {
   3.9215181115565424`*^9, 3.9215181172560644`*^9}, 3.921518169056094*^9},
 CellLabel->
  "Out[437]=",ExpressionUUID->"7329a68d-e6fc-4e32-ac00-fb2cb4214b53"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", "2"]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", 
   FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", 
   FractionBox["1", "4"], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.9215169602900505`*^9, 3.921517011474728*^9, 3.9215180716393332`*^9, {
   3.9215181115565424`*^9, 3.9215181172560644`*^9}, 3.921518169056094*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"1c50ec99-5698-44cf-9831-ed90c749eeee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "each", " ", "row", " ", "corresponds", " ", "to", " ", "a", " ", "given",
      " ", "atomic", " ", "mode"}], ",", " ", 
    RowBox[{
    "where", " ", "the", " ", "list", " ", "entries", " ", "are", " ", "the", 
     " ", "coefficents", " ", "for", " ", "each", " ", "operator", " ", 
     "product"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"amplitudeMap", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{"atomicCoefficients", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
       "aOps"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "modeList", "]"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.921518458158375*^9, 3.92151849033946*^9}, {
  3.921518554029725*^9, 3.921518718089182*^9}, {3.9215188836056643`*^9, 
  3.9215189388559713`*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"9c8700b2-95ad-4e43-8076-9005cc443960"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215186507399855`*^9, 3.921518659672702*^9}, {
   3.9215187023726254`*^9, 3.9215187184721565`*^9}, 3.9215189482582245`*^9, 
   3.9215195492404284`*^9},
 CellLabel->
  "Out[456]=",ExpressionUUID->"ffbf5442-1f91-4ae7-a175-790a8bd555ab"]
}, Open  ]],

Cell["\<\
Find a way to show which states are heralded by which measurements\
\>", "Text",
 CellChangeTimes->{{3.921519080959688*^9, 3.9215191032732954`*^9}, {
  3.92151914848941*^9, 
  3.9215191536954565`*^9}},ExpressionUUID->"5ecb4185-da56-4a89-b36f-\
9379dd5a4d26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Transpose", "@", "amplitudeMap"}], ")"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215192412682076`*^9, 3.921519311855627*^9}},
 CellLabel->
  "In[449]:=",ExpressionUUID->"976742e7-779a-4908-ab42-b2a5ed4144ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.9215192473444815`*^9, 3.9215193124411397`*^9}},
 CellLabel->
  "Out[449]=",ExpressionUUID->"dcbf2366-d020-461a-ae68-56b3488c31ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["modeList"], "Input",
 CellChangeTimes->{{3.9215192906911488`*^9, 3.9215192921220713`*^9}},
 CellLabel->
  "In[458]:=",ExpressionUUID->"5990b94c-b100-4250-be89-53987af06c38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], ",", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.921519292489699*^9, 3.921519579072486*^9},
 CellLabel->
  "Out[458]=",ExpressionUUID->"1a4e9d01-064c-44fa-9bb4-0238418104e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Array", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Transpose", "@", "amplitudeMap"}], ")"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], ".", "modeList"}], ")"}], "//", 
      "FullSimplify"}], ")"}], "&"}], ",", 
   RowBox[{"Length", "[", "opList", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921519581276292*^9, 3.9215196824902534`*^9}, {
  3.9215234187335043`*^9, 3.9215234417830725`*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"1bc36d87-b68c-4e46-b1a8-a0fa656c5d02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "2"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215195853895736`*^9, 3.9215196644051886`*^9}, {
  3.9215234303318605`*^9, 3.921523442317378*^9}},
 CellLabel->
  "Out[469]=",ExpressionUUID->"4bfa34a4-bd5b-4a2d-8681-f8f64066abfa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"getStateWithoutPrefactors", "[", "state_", "]"}], ":=", 
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"FactorList", "[", "state", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "0", "]"}], "]"}], "==", "Ket"}], "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", " ", 
   RowBox[{
   "this", " ", "method", " ", "runs", " ", "into", " ", "problems", " ", 
    "quickly", " ", "and", " ", "is", " ", "not", " ", "a", " ", "good", " ", 
    RowBox[{"approach", ".", " ", "I"}], " ", "probably", " ", 
    RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "get", " ", 
    "states", " ", "this", " ", "way"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.921529642722188*^9, 3.9215297478098574`*^9}, {
  3.9215309158381453`*^9, 3.921530919856082*^9}, {3.9215320617215695`*^9, 
  3.9215321247777433`*^9}, {3.921532234838718*^9, 3.9215322354951167`*^9}, {
  3.921532651739789*^9, 
  3.9215326870887003`*^9}},ExpressionUUID->"a8d78d5f-fb0c-45b4-bec1-\
6b5c3be233a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getStateWithoutPrefactors", "[", 
  RowBox[{
   FractionBox["1", "4"], " ", "a", " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "2"]}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9215297241894345`*^9, 3.921529752756524*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"f93138bb-bcc8-4f1a-8f29-e6146751dcd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "2"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"]}], "-", 
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "2"]}]}]], "Output",
 CellChangeTimes->{{3.921529737022952*^9, 3.921529753405573*^9}},
 CellLabel->
  "Out[517]=",ExpressionUUID->"8484e606-37a8-4938-b701-34a7b20883b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"FactorList", "[", 
         RowBox[{
          FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SubscriptBox[
               TemplateBox[{"0"},
                "Ket"], "2"]}], " ", 
             SubscriptBox[
              TemplateBox[{"1"},
               "Ket"], "1"]}], "+", 
            RowBox[{
             SubscriptBox[
              TemplateBox[{"0"},
               "Ket"], "1"], " ", 
             SubscriptBox[
              TemplateBox[{"1"},
               "Ket"], "2"]}]}], ")"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "0", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215292981123123`*^9, 3.92152937147619*^9}},
 CellLabel->
  "In[506]:=",ExpressionUUID->"e22bb895-d612-40ce-a081-0c25d3b8fcd4"],

Cell[BoxData["Ket"], "Output",
 CellChangeTimes->{
  3.921523885637304*^9, {3.9215286951579137`*^9, 3.921528711856315*^9}, {
   3.9215288998573647`*^9, 3.9215289063941717`*^9}, 3.921529068922943*^9, {
   3.921529102757196*^9, 3.921529167323147*^9}, {3.9215293009723797`*^9, 
   3.9215293720101595`*^9}},
 CellLabel->
  "Out[506]=",ExpressionUUID->"011bcaf5-5b58-4c2f-9367-d96c565469dc"]
}, Open  ]],

Cell[TextData[{
 "We want to get a list of states that can be heralded, and the patterns \
which herald them. In the list below, each element corresponds to a possible \
measurement ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], 
    SubscriptBox["a", "j"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "98d55130-da1e-4fef-a543-0e2d45c807a3"],
 " (which means that a one photon each is detected at sensor pixels i and j, \
and that no photons were detected at any other pixels), and the element \
itself is the state that would be heralded. I want to use this list to \
generate a list of measurement pairs for each possible state that can be \
heralded, which is sort of the inverse of this."
}], "Text",
 CellChangeTimes->{{3.9215298616563597`*^9, 3.9215298780398207`*^9}, {
  3.921529998856352*^9, 3.921530039173712*^9}, {3.9215300935239882`*^9, 
  3.921530290327591*^9}},ExpressionUUID->"cb3b16c0-4c70-4337-beb1-\
00f03224cc08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"statesHeralded", "=", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Transpose", "@", "amplitudeMap"}], ")"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], ".", "modeList"}], ")"}], "//", 
       "FullSimplify"}], ")"}], "&"}], ",", 
    RowBox[{"Length", "[", "aOps", "]"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "includes", " ", "some", " ", "0", " ", "elements", " ", 
     "which", " ", "correspond", " ", "to", " ", "detection", " ", "events", 
     " ", "which", " ", "will", " ", "never", " ", "occur", " ", "in", " ", 
     "the", " ", "absence", " ", "of", " ", "noise"}], ";", " ", 
    RowBox[{"leave", " ", "these", " ", "in", " ", "for", " ", "clarity"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{
  3.9215298403269854`*^9, {3.9215308296545095`*^9, 3.9215308349223175`*^9}, {
   3.9215311843264875`*^9, 3.921531186323037*^9}, {3.9215318542633686`*^9, 
   3.9215318888542566`*^9}},ExpressionUUID->"31b54a1c-d95e-46f2-bb48-\
a420f6a007a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "2"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "2"], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"]}], "}"}]], "Output",
 CellChangeTimes->{3.921529844573406*^9, 3.921530836588791*^9, 
  3.9215311871288385`*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"69dca628-3f8a-434e-b9c7-3b9118280828"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Length", "[", "aOps", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "statesHeralded", "]"}]}], "Input",
 CellChangeTimes->{{3.9215312194894147`*^9, 3.9215312353760633`*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"a32cdea5-34de-4be7-996b-795ef46f090f"],

Cell[BoxData["36"], "Output",
 CellChangeTimes->{3.921531236005418*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"3b7d5feb-e218-4437-bbc3-d05471ae1da6"],

Cell[BoxData["36"], "Output",
 CellChangeTimes->{3.921531236021843*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"c3084533-d70c-42a2-8ab0-bdb9f0b7c677"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"statesHeraldedAndMeasurements", "=", 
  RowBox[{"Transpose", "@@", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"statesHeralded", ",", "aOps"}], "}"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9215310300937276`*^9, 3.9215310788390594`*^9}, {
  3.9215311201771646`*^9, 3.92153117066372*^9}, {3.9215312059293027`*^9, 
  3.9215312109230127`*^9}, {3.9215312433039627`*^9, 3.921531361469121*^9}, {
  3.9215318487051725`*^9, 
  3.921531850788268*^9}},ExpressionUUID->"b6809d16-a3ad-4d12-8baa-\
b7282a09af9f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a1", " ", "a2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a1", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a1", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], "2"], ",", 
     RowBox[{"a1", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a1", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a1", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a1", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a2", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a2", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a2", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a2", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "2"]}], ",", 
     RowBox[{"a2", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a2", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a2", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a3", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a3", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a3", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a3", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"]}], ",", 
     RowBox[{"a3", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a3", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a4", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a4", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a4", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a4", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}], "2"], ",", 
     RowBox[{"a4", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a5", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a5", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a5", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "-", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a5", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a6", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "2"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a6", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a6", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a7", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox[
           TemplateBox[{"0"},
            "Ket"], "2"]}], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "1"], " ", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "2"]}]}], ")"}]}], ",", 
     RowBox[{"a7", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}], "4"], ",", 
     SuperscriptBox["a8", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215311710891185`*^9, 3.921531211422144*^9}, 
   3.921531246005712*^9, 3.921531298249748*^9, {3.9215313304898934`*^9, 
   3.9215313622419176`*^9}},
 CellLabel->
  "Out[538]=",ExpressionUUID->"1c3973b2-c051-4289-bde4-338ff98eaf7f"]
}, Open  ]],

Cell["\<\
Using the list above of tuples of states and the measurements that herald \
them, make a list of unique states and the measurements which herald them. \
This is like a set operation where the elements sharing a common first entry \
are combined. \
\>", "Text",
 CellChangeTimes->{{3.9215315659231935`*^9, 
  3.9215316995013123`*^9}},ExpressionUUID->"c0ad6000-1f01-4e05-8f27-\
0ce1d91be034"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "get", " ", "the", " ", "heraldable", " ", "states", " ", "up", " ", "to", 
    " ", "a", " ", "prefactor"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"validStates", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"statesHeralded", ",", 
     RowBox[{"Except", "[", "0", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9215317028058815`*^9, 3.9215317315234485`*^9}, {
  3.9215317806052666`*^9, 3.921531836188305*^9}, {3.9215319060724316`*^9, 
  3.921531954057443*^9}, {3.921952374569031*^9, 3.921952374618498*^9}},
 CellLabel->
  "In[556]:=",ExpressionUUID->"ddae2b1e-a3a7-470f-bd3e-4294b7ee17c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "2"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "2"], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], "4"], ",", 
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"]}], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}], "4"]}], "}"}]], "Output",
 CellChangeTimes->{{3.921531818865468*^9, 3.9215318365617704`*^9}, {
  3.921531921658289*^9, 3.9215319546212587`*^9}},
 CellLabel->
  "Out[556]=",ExpressionUUID->"1154266d-0302-4021-9074-fa4939f34a52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
attempt to get the state up to a prefactor - use the amplitudes only\
\>", "Subsubsection",
 CellChangeTimes->{{3.9219525947366433`*^9, 
  3.921952609618249*^9}},ExpressionUUID->"dd2ace86-8039-472d-b458-\
8ef55dac2822"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"states", "=", 
  RowBox[{"Transpose", "@", "amplitudeMap"}]}]], "Input",
 CellChangeTimes->{{3.921952613221079*^9, 3.9219526412689533`*^9}, {
  3.9219530966545753`*^9, 3.9219530992896395`*^9}},
 CellLabel->
  "In[742]:=",ExpressionUUID->"5f4b443e-74f7-4067-8be8-e2b7ea250e14"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[ImaginaryI]", "4"], ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921952614893913*^9, 3.921952641635049*^9}, {
   3.92195275750599*^9, 3.9219527670204377`*^9}, 3.9219531011652584`*^9},
 CellLabel->
  "Out[742]=",ExpressionUUID->"4ad643f5-a854-4e1e-ae2f-1264d9de4501"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uniqueStates", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"states", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", 
      RowBox[{"Norm", "[", 
       RowBox[{"states", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "if", " ", "states", " ", "only", " ", "differ", " ", "by", " ", "an", " ",
     "overall", " ", "prefactor", " ", "they", " ", "are", " ", "not", " ", 
    RowBox[{"unique", ".", " ", "converse"}], " ", "is", " ", "true"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normed", "=", "Nothing"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"Length", "[", 
      RowBox[{"states", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "states", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"states", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "!=", "zeros"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"normed", "=", 
        RowBox[{"Normalize", "[", 
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"states", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/", 
         RowBox[{"Norm", "[", 
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "*)"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Array", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"Dot", "[", 
                  RowBox[{"normed", ",", 
                   RowBox[{"uniqueStates", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "]"}], "&"}], 
               ",", 
               RowBox[{"Length", "[", "uniqueStates", "]"}]}], "]"}], ",", 
             "1"}], "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"uniqueStates", ",", "normed"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "uniqueStates", "]"}]}], "Input",
 CellChangeTimes->{{3.9219530768700676`*^9, 3.9219532641766796`*^9}, {
   3.92195329883566*^9, 3.921953342585497*^9}, {3.9219533868555775`*^9, 
   3.921953490335347*^9}, {3.9219535339776435`*^9, 3.9219536154349747`*^9}, {
   3.9219537092026434`*^9, 3.9219537242351437`*^9}, {3.921953759235939*^9, 
   3.9219538517516804`*^9}, {3.9219538916522417`*^9, 
   3.9219539019537096`*^9}, {3.9219540454521475`*^9, 
   3.9219541486198006`*^9}, {3.92195425165344*^9, 3.9219542517345057`*^9}, {
   3.9219543066676025`*^9, 3.9219543072194815`*^9}, {3.92195447273467*^9, 
   3.9219544843514824`*^9}, {3.9219545535179887`*^9, 
   3.9219546219510264`*^9}, {3.9219546709678936`*^9, 3.921954754886285*^9}, {
   3.9219548786677747`*^9, 3.9219549063517585`*^9}, 3.921954996917588*^9, {
   3.9219550322511296`*^9, 3.921955040337685*^9}, {3.9220018168770456`*^9, 
   3.922001827744753*^9}, {3.922001920575903*^9, 3.922001937527815*^9}, {
   3.9220019951785965`*^9, 3.9220020364105444`*^9}, {3.9220020841121655`*^9, 
   3.9220020993950543`*^9}, {3.9220022929104185`*^9, 
   3.9220023172939873`*^9}, {3.922002688077423*^9, 3.922002688627124*^9}, {
   3.9220027386941786`*^9, 3.922002745126827*^9}, {3.9220959284836483`*^9, 
   3.9220959958820944`*^9}, {3.9220960391488657`*^9, 3.922096055181926*^9}},
 CellLabel->
  "In[911]:=",ExpressionUUID->"a86a706c-744b-4515-b16e-609316dc666b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]]}], ",", 
     FractionBox["\[ImaginaryI]", 
      SqrtBox["2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.922002792843667*^9, 3.922095999348858*^9, 
  3.922096057863656*^9},
 CellLabel->
  "During evaluation of \
In[911]:=",ExpressionUUID->"b7755c31-f4f5-4f42-a2c2-f38bf66cc68f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uniqueStates", ".", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9220962772823124`*^9, 3.922096285149578*^9}},
 CellLabel->
  "In[916]:=",ExpressionUUID->"d3c8aa73-f3b2-4b69-b4b9-0b235c18f1be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.9220962858986993`*^9},
 CellLabel->
  "Out[916]=",ExpressionUUID->"70c6be31-2ed6-4da6-819f-fabdaed6b127"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uniqueStates", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      SqrtBox["2"]]}], ",", 
    FractionBox["\[ImaginaryI]", 
     SqrtBox["2"]], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9220962982656665`*^9, 3.922096300149072*^9}},
 CellLabel->
  "In[917]:=",ExpressionUUID->"50786d56-ef86-4600-a8c6-0708fd9ff3d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.92209630116529*^9},
 CellLabel->
  "Out[917]=",ExpressionUUID->"f25f5c71-cb60-4dde-be9b-5f06600554a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uniqueStates", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"-", 
     FractionBox["1", 
      SqrtBox["2"]]}], ",", 
    RowBox[{"-", 
     FractionBox["1", 
      SqrtBox["2"]]}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{3.9220963236492476`*^9},
 CellLabel->
  "In[918]:=",ExpressionUUID->"bfacb578-8b8a-4b7f-b010-4c7a274ef98c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.922096324166607*^9},
 CellLabel->
  "Out[918]=",ExpressionUUID->"f3da609c-81ea-4755-9dc7-b184b3f860e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uniqueStates", ".", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9220963298322506`*^9, 3.922096331348769*^9}},
 CellLabel->
  "In[919]:=",ExpressionUUID->"b8f15443-ee7f-43e5-a93c-2edf375c2728"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.9220963322990904`*^9},
 CellLabel->
  "Out[919]=",ExpressionUUID->"56d24719-a9dd-4958-9601-e6c1fecadbba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "now", " ", "that", " ", "we", " ", "have", " ", "the", " ", "unique", 
     " ", "states"}], ",", " ", 
    RowBox[{"we", " ", "need", " ", "to"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"states", "[", 
       RowBox[{"[", "#1", "]"}], "]"}], ".", 
      RowBox[{"uniqueStates", "[", 
       RowBox[{"[", "#2", "]"}], "]"}]}], "]"}], ",", "{"}]}]}]], "Input",
 CellChangeTimes->{{3.9220030714602137`*^9, 3.9220031318436155`*^9}, {
  3.9220032395111837`*^9, 3.922003314063122*^9}, {3.9220039650003195`*^9, 
  3.922004005499303*^9}},ExpressionUUID->"c3bb9368-813a-4d5c-bd69-\
1e94e417066b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9220963776709595`*^9, 
  3.9220963880151052`*^9}},ExpressionUUID->"df09738b-e1b5-447b-a689-\
3faa4b4a3b07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"statesAndHeralds", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"{", 
    RowBox[{"states", ",", "aOps"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9220957006828337`*^9, 3.9220957898443184`*^9}},
 CellLabel->
  "In[903]:=",ExpressionUUID->"7b43667c-2844-4d0e-ae7c-a4e841f96244"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "4"]}], "}"}], ",", 
     SuperscriptBox["a2", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", "4"], ",", 
       FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", 
        FractionBox["1", "2"]}]}], "}"}], ",", 
     RowBox[{"a2", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a3", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "4"]}], "}"}], ",", 
     SuperscriptBox["a4", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "2"]}], "}"}], ",", 
     RowBox[{"a4", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a5", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", 
       RowBox[{"-", 
        FractionBox["1", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "4"]}], "}"}], ",", 
     SuperscriptBox["a6", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", "4"], ",", 
       FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
     RowBox[{"a6", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a6", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "4"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a7", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["\[ImaginaryI]", "4"], ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "4"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"a7", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       FractionBox["1", "4"]}], "}"}], ",", 
     SuperscriptBox["a8", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9220957869152713`*^9, 3.922095790266354*^9}},
 CellLabel->
  "Out[903]=",ExpressionUUID->"6382360e-9401-4316-b6b9-8eaa02395125"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stateMatchesAndHeralds", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{
     RowBox[{"Length", "[", "statesAndHeralds", "]"}], "+", "1"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"stateMatchesAndHeralds", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"uniqueStates", ".", 
          RowBox[{"Normalize", "[", 
           RowBox[{
            RowBox[{"statesAndHeralds", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"statesAndHeralds", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9220957910668836`*^9, 3.922095821433636*^9}, {
  3.922096394915558*^9, 3.9220964166324406`*^9}, {3.922096454100556*^9, 
  3.9220964831320815`*^9}, {3.922096605982031*^9, 3.922096741582203*^9}},
 CellLabel->
  "In[927]:=",ExpressionUUID->"ee6b26f6-cbe2-4407-a6a2-058ff6ec4a93"],

Cell[CellGroupData[{

Cell[BoxData["stateMatchesAndHeralds"], "Input",
 CellChangeTimes->{{3.922096684615202*^9, 3.9220966854663024`*^9}},
 CellLabel->
  "In[930]:=",ExpressionUUID->"862b53ab-99e3-46ed-99a2-2eec801ff3ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a1", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a1", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     SuperscriptBox["a2", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"a2", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a2", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a3", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a3", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     SuperscriptBox["a4", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a4", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"a4", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a5", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a5", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     SuperscriptBox["a6", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"a6", " ", "a7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a6", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     SuperscriptBox["a7", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"a7", " ", "a8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     SuperscriptBox["a8", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9220966858501577`*^9, 3.922096702414626*^9}, 
   3.9220967498153877`*^9},
 CellLabel->
  "Out[930]=",ExpressionUUID->"18fc4a48-0a4b-4e34-92a3-08e30fa63433"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nUniqueStates", "=", 
   RowBox[{"Length", "[", "uniqueStates", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heraldPatternsByState", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uniqueStates", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "}"}], "&"}], ",", "nUniqueStates"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stateIndices", "=", 
   RowBox[{"Range", "[", "nUniqueStates", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", 
     RowBox[{
      RowBox[{"Length", "[", "statesAndHeralds", "]"}], "+", "1"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateIndex", "=", 
      RowBox[{"stateIndices", ".", 
       RowBox[{"(", 
        RowBox[{"Abs", "[", 
         RowBox[{"uniqueStates", ".", 
          RowBox[{"Normalize", "[", 
           RowBox[{"statesAndHeralds", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"stateIndex", "!=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"heraldPatternsByState", "[", 
          RowBox[{"[", 
           RowBox[{"stateIndex", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"statesAndHeralds", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9220969584167576`*^9, 3.922097134516262*^9}, {
  3.9220972377241206`*^9, 3.922097330331168*^9}, {3.9220977303311043`*^9, 
  3.922097748631302*^9}, {3.9220977797811594`*^9, 3.922097790616227*^9}},
 CellLabel->
  "In[962]:=",ExpressionUUID->"4a91ac10-5ad3-40fd-a0bb-a170e79169f9"],

Cell[CellGroupData[{

Cell[BoxData["heraldPatternsByState"], "Input",
 CellChangeTimes->{{3.922097718869706*^9, 3.9220977198828936`*^9}},
 CellLabel->
  "In[966]:=",ExpressionUUID->"45f93d51-7bf7-4d2c-8c8a-baf2ffa93167"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["a1", "2"], ",", 
       RowBox[{"a1", " ", "a5"}], ",", 
       SuperscriptBox["a3", "2"], ",", 
       RowBox[{"a3", " ", "a7"}], ",", 
       SuperscriptBox["a5", "2"], ",", 
       SuperscriptBox["a7", "2"]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]]}], ",", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a1", " ", "a2"}], ",", 
       RowBox[{"a1", " ", "a6"}], ",", 
       RowBox[{"a2", " ", "a5"}], ",", 
       RowBox[{"a3", " ", "a4"}], ",", 
       RowBox[{"a3", " ", "a8"}], ",", 
       RowBox[{"a4", " ", "a7"}], ",", 
       RowBox[{"a5", " ", "a6"}], ",", 
       RowBox[{"a7", " ", "a8"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], ",", 
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a1", " ", "a4"}], ",", 
       RowBox[{"a1", " ", "a8"}], ",", 
       RowBox[{"a2", " ", "a3"}], ",", 
       RowBox[{"a2", " ", "a7"}], ",", 
       RowBox[{"a3", " ", "a6"}], ",", 
       RowBox[{"a4", " ", "a5"}], ",", 
       RowBox[{"a5", " ", "a8"}], ",", 
       RowBox[{"a6", " ", "a7"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["a2", "2"], ",", 
       RowBox[{"a2", " ", "a6"}], ",", 
       SuperscriptBox["a4", "2"], ",", 
       RowBox[{"a4", " ", "a8"}], ",", 
       SuperscriptBox["a6", "2"], ",", 
       SuperscriptBox["a8", "2"]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9220977202165117`*^9, 3.9220977520307355`*^9}, 
   3.9220977942816095`*^9},
 CellLabel->
  "Out[966]=",ExpressionUUID->"c252acb8-228f-4457-b70c-5d8fe084bfdb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
attempt to get the state up to a prefactor - uses the states with explicit \
kets (too tough)\
\>", "Subsubsection",
 CellChangeTimes->{{3.921952408554228*^9, 3.921952457319995*^9}, {
  3.9219525486372576`*^9, 
  3.9219525667196684`*^9}},ExpressionUUID->"20fc6b2d-d577-4b9e-8b0c-\
c1fc65849c15"],

Cell["\<\
-- this is really tough using the form the validStates list which includes \
the kets explicitly.\
\>", "Text",
 CellChangeTimes->{{3.921952459244253*^9, 
  3.921952472236169*^9}},ExpressionUUID->"cb1f53ed-1cc1-404c-8335-\
b8fa00976e3a"],

Cell["\<\
I may still want to get the states without prefactors for the sake of \
grouping, but how can I correctly factor out the part with the kets?\
\>", "Text",
 CellChangeTimes->{{3.9215326245893717`*^9, 3.9215326337240314`*^9}, {
  3.9215326951383734`*^9, 
  3.92153274195618*^9}},ExpressionUUID->"f7333b32-9e14-460c-8139-\
05046096cdd2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getStateWithoutPrefactors", "[", 
  RowBox[{"validStates", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215314434557943`*^9, 3.9215314435884123`*^9}, {
  3.921531965272497*^9, 3.9215319768784857`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"1df282b7-834b-445d-aaec-a1c8b1d7a492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.921531968154346*^9, 3.9215319773264375`*^9}},
 CellLabel->
  "Out[558]=",ExpressionUUID->"7f445c33-407d-4885-920a-e39aac1852fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "2"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "1"]}], "-", 
       RowBox[{
        SubscriptBox[
         TemplateBox[{"0"},
          "Ket"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"1"},
          "Ket"], "2"]}]}], ")"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"x_", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"___", 
        SubscriptBox[
         TemplateBox[{"___"},
          "Ket"], "___"]}], "+", "___"}], ")"}]}], "->", "x"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.92195115625362*^9, 3.921951224872484*^9}, {
  3.921951261837378*^9, 3.9219512822559185`*^9}},
 CellLabel->
  "In[688]:=",ExpressionUUID->"04eb16c7-fb48-4679-86ee-2b8815dde837"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox["\[ImaginaryI]", "4"], "}"}]], "Output",
 CellChangeTimes->{{3.921951190819186*^9, 3.921951225286273*^9}, {
  3.921951262371809*^9, 3.9219512831879487`*^9}},
 CellLabel->
  "Out[688]=",ExpressionUUID->"f3510bcd-4911-4179-97b2-76a5129dceca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}], ",", 
     RowBox[{"4", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "5"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x_Number", " ", "___", 
      SubscriptBox[
       TemplateBox[{"_"},
        "Ket"], "_"], 
      FractionBox["1", "x_Integer"]}], "|", " ", 
     RowBox[{"___", 
      SubscriptBox[
       TemplateBox[{"_"},
        "Ket"], "_"]}]}], "->", "x"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921951300704291*^9, 3.921951388388414*^9}, {
  3.92195174578823*^9, 3.9219519236701555`*^9}, {3.92195196205402*^9, 
  3.9219519679864264`*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"590bcf45-0a6d-4847-a8cf-d0d39195814b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", " ", "c"}], ",", 
     RowBox[{"b", " ", "b"}], ",", 
     RowBox[{
      FractionBox["\[ImaginaryI]", "2"], " ", "b"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"x_Rational", " ", "___"}], "|", "x_Complex"}], "->", "x"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9219519732054896`*^9, 3.921952071703706*^9}, {
  3.9219521091398473`*^9, 3.921952114136363*^9}, {3.9219521544026337`*^9, 
  3.9219521590855885`*^9}},
 CellLabel->
  "In[732]:=",ExpressionUUID->"cad0c05b-0d2b-4ba5-bf51-5b4c7f8cd1c7"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.921951320271327*^9, 3.921951389187151*^9}, {
   3.92195174805246*^9, 3.9219517792035284`*^9}, {3.9219518205211554`*^9, 
   3.92195192421896*^9}, 3.921951968602388*^9, {3.9219520152206326`*^9, 
   3.921952072902497*^9}, {3.9219521106217318`*^9, 3.9219521145687094`*^9}, 
   3.921952159519247*^9},
 CellLabel->
  "Out[732]=",ExpressionUUID->"6012f42c-519d-4570-a1e6-61333789ac9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "[", 
  FractionBox["\[ImaginaryI]", "2"], "]"}]], "Input",
 CellChangeTimes->{{3.9219521466046457`*^9, 3.921952149469813*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"c1c7d3b3-52f1-45fb-94fa-bd6fb0866101"],

Cell[BoxData["Complex"], "Output",
 CellChangeTimes->{3.9219521498024316`*^9},
 CellLabel->
  "Out[731]=",ExpressionUUID->"1dbfeb7f-5dd0-48ca-a967-1c995ea77c0c"]
}, Open  ]],

Cell[BoxData["Inte"], "Input",
 CellChangeTimes->{{3.9219520767878537`*^9, 
  3.9219520823370132`*^9}},ExpressionUUID->"aa35a8fc-4cd5-4ff0-8af7-\
6c371383a806"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"]}], ",", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"], " ", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "2"]}], " ", ",", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"]}], " ", "}"}], ",", 
   RowBox[{"Product", "[", 
    RowBox[{
     TemplateBox[{"_"},
      "Ket"], ",", "___"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921951446521107*^9, 3.9219515241557684`*^9}},
 CellLabel->
  "In[701]:=",ExpressionUUID->"e3c69973-e528-4cf3-9f62-6e11a5b40ecf"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.9219514729704976`*^9, {3.9219515067528563`*^9, 3.9219515246052237`*^9}},
 CellLabel->
  "Out[701]=",ExpressionUUID->"d9dfa1de-b21d-44b5-95a1-b69011e270af"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "try", " ", "to", " ", "find", " ", "the", " ", "ket", " ", "part", " ", 
     "of", " ", "the", " ", "states"}], ",", " ", 
    RowBox[{
    "so", " ", "we", " ", "can", " ", "group", " ", "the", " ", "op", " ", 
     "products", " ", "into", " ", "lists", " ", "for", " ", "a", " ", 
     "particular", " ", "state", " ", "they", " ", "herald"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exampleList", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "2"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SubscriptBox[
             TemplateBox[{"0"},
              "Ket"], "2"]}], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SubscriptBox[
             TemplateBox[{"0"},
              "Ket"], "2"]}], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "-", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "2"]}]}], ")"}]}], ",", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "2"], " ", 
           SubscriptBox[
            TemplateBox[{"1"},
             "Ket"], "1"]}], "+", 
          RowBox[{
           SubscriptBox[
            TemplateBox[{"0"},
             "Ket"], "1"], " ", 
           SubscriptBox[
            TemplateBox[{"Q"},
             "Ket"], "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "replace", " ", "with", " ", "the", " ", "validStates", " ", "later"}], 
     ",", " ", 
     RowBox[{
     "so", " ", "we", " ", "can", " ", "grab", " ", "the", " ", "ops", " ", 
      "as", " ", "we", " ", "go"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"statePatterns", "=", 
     RowBox[{"{", 
      RowBox[{"exampleList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", 
      RowBox[{
       RowBox[{"Length", "[", "exampleList", "]"}], "+", "1"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"state", "=", 
       RowBox[{"exampleList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"Length", "[", "states", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"state", ",", 
           RowBox[{"_states", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9219503126060553`*^9, 3.9219504002196236`*^9}, {
  3.921950455705933*^9, 3.921950501504757*^9}, {3.9219505318040752`*^9, 
  3.9219505415705643`*^9}, {3.9219508091038885`*^9, 3.921950895169928*^9}, {
  3.9219509485034027`*^9, 3.921951026386757*^9}, {3.921951124271801*^9, 
  3.921951148188301*^9}},ExpressionUUID->"8d52dc0f-f0ce-4a3a-82c5-\
71e734350239"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}], ",", 
   RowBox[{"_", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "2"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "-", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"0"},
         "Ket"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "2"]}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219509041866455`*^9, 3.921950937753872*^9}},
 CellLabel->
  "In[677]:=",ExpressionUUID->"8deaf9e2-cefe-4b06-8ac3-a7db6a4137fb"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9219509384027987`*^9},
 CellLabel->
  "Out[677]=",ExpressionUUID->"6a47e864-9164-4c11-aca9-b0828c2b7035"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"2"},
       "Ket"], "1"], 
     SubscriptBox[
      TemplateBox[{"3"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"5"},
       "Ket"], "3"], 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "4"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "u"], 
     SubscriptBox[
      TemplateBox[{"2"},
       "Ket"], "g"]}]}], ",", "1", ",", "1", ",", 
   RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
   RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
   RowBox[{"f", "[", "10", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.921950199187061*^9, 
  3.9219502153219995`*^9}},ExpressionUUID->"b588e630-8b01-4d0e-a79d-\
9a2efc5fac6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"]}], "+", 
      RowBox[{"0.5", 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{"0.25", 
       SubscriptBox[
        TemplateBox[{"5"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "_"}]}], "]"}]], "Input",
 CellLabel->
  "In[581]:=",ExpressionUUID->"d0940aba-73ca-4ea0-987e-b038ed24f990"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"]}], "+", 
   RowBox[{"0.5`", " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{"0.25`", " ", 
    SubscriptBox[
     TemplateBox[{"5"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9215330253204346`*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"f498c3a7-64f5-49df-b84e-f756a1f7bfdd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "__"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921533039884797*^9, 3.9215331025919104`*^9}, {
  3.921948046938168*^9, 3.9219480491704807`*^9}, {3.9219481071969814`*^9, 
  3.9219482829404435`*^9}, {3.9219486110539217`*^9, 3.9219487690039515`*^9}},
 CellLabel->
  "In[630]:=",ExpressionUUID->"88ebd716-79b8-4c72-b205-50738a911e4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"2"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9215330411210513`*^9, 3.921533103337509*^9}, {
  3.9219481084732685`*^9, 3.921948157372478*^9}, {3.9219481894846196`*^9, 
  3.9219482834241734`*^9}, {3.921948618454466*^9, 3.9219487702134056`*^9}},
 CellLabel->
  "Out[630]=",ExpressionUUID->"046c0618-dbd6-4913-9195-1712d3e7c748"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{3.9219488723747377`*^9},
 CellLabel->
  "In[676]:=",ExpressionUUID->"229c7679-b451-42db-baf1-3f7964973570"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"2"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"3"},
      "Ket"], "1"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.9219488728127527`*^9, 3.921950565003311*^9},
 CellLabel->
  "Out[676]=",ExpressionUUID->"984c49fb-461e-49ee-8b30-ed2c09bf8b76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"2"},
         "Ket"], "1"], 
       SubscriptBox[
        TemplateBox[{"3"},
         "Ket"], "1"]}], "+", 
      RowBox[{
       SubscriptBox[
        TemplateBox[{"5"},
         "Ket"], "3"], 
       SubscriptBox[
        TemplateBox[{"1"},
         "Ket"], "4"]}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", "+", 
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921948915190155*^9, 3.921948927439372*^9}, {
  3.9219492059204245`*^9, 3.921949214805207*^9}, {3.9219496305868626`*^9, 
  3.921949643003837*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"43e579e3-3580-484d-93ff-a4d850f673ff"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.921949228177019*^9, 3.9219496434700503`*^9},
 CellLabel->
  "Out[659]=",ExpressionUUID->"92c4503c-641c-42e9-bbb8-796b0d98cda5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"___", 
     SubscriptBox[
      TemplateBox[{"___"},
       "Ket"], "___"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.92194969808915*^9, 3.9219497552714124`*^9}, {
  3.92194987412086*^9, 3.921949887521564*^9}, {3.921950089303444*^9, 
  3.9219500925550847`*^9}},
 CellLabel->
  "In[671]:=",ExpressionUUID->"5754db48-49a6-4bf5-9acf-4f7f99d19bcd"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9219497114711514`*^9, 3.9219497408716683`*^9}, 
   3.9219498221033645`*^9, {3.9219498672366085`*^9, 3.921949888038537*^9}, 
   3.921950094405446*^9},
 CellLabel->
  "Out[671]=",ExpressionUUID->"bdca9420-8609-4b55-a0bf-0cf9eefe6180"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"___", 
       SubscriptBox[
        TemplateBox[{"___"},
         "Ket"], "___"]}], "+", "___"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219501083889217`*^9, 3.921950121270262*^9}},
 CellLabel->
  "In[675]:=",ExpressionUUID->"a158af68-1b66-48ca-a851-feb50ab80489"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       TemplateBox[{"0"},
        "Ket"], "u"], " ", 
      SubscriptBox[
       TemplateBox[{"2"},
        "Ket"], "g"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"2"},
        "Ket"], "1"], " ", 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], "+", 
     RowBox[{
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "4"], " ", 
      SubscriptBox[
       TemplateBox[{"5"},
        "Ket"], "3"]}]}], ")"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219501033051834`*^9, 3.9219501219198*^9}},
 CellLabel->
  "Out[675]=",ExpressionUUID->"7c1b9793-390c-4027-809b-5f8a55a088b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "1"], 
         SubscriptBox[
          TemplateBox[{"3"},
           "Ket"], "1"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"5"},
           "Ket"], "3"], 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "4"]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "u"], 
         SubscriptBox[
          TemplateBox[{"2"},
           "Ket"], "g"]}]}], ")"}]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"___", 
       SubscriptBox[
        TemplateBox[{"___"},
         "Ket"], "___"]}], "+", "___"}], ")"}]}]}], "]"}]], "Input",Expression\
UUID->"8bcf0818-1474-40e4-9368-e5832e5cb856"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"___", 
     SubscriptBox[
      TemplateBox[{"___"},
       "Ket"], "___"]}], "+", "___"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219499180231247`*^9, 3.9219499336892967`*^9}},
 CellLabel->
  "In[670]:=",ExpressionUUID->"4a907a91-d63c-4210-bdb0-b12891369fb5"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.921949922669856*^9, 3.921949934503233*^9}},
 CellLabel->
  "Out[670]=",ExpressionUUID->"e5199214-07df-4ce7-90b9-2fa2b6a3777f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"_", 
    SubscriptBox[
     TemplateBox[{"_"},
      "Ket"], "_"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921949239470619*^9, 3.921949362671127*^9}, {
  3.92194956091175*^9, 
  3.9219496052207923`*^9}},ExpressionUUID->"b0f6b4da-41d2-4d01-a4ac-\
2f6b0d27136c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"3"},
     "Ket"], "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219492758535233`*^9, 3.921949363153698*^9}, {
  3.921949564320405*^9, 3.9219495997376046`*^9}},
 CellLabel->
  "Out[658]=",ExpressionUUID->"8a872d9b-8c43-4e3a-a640-6ad81f0bd6f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", 
      SubscriptBox[
       TemplateBox[{"1"},
        "Ket"], "1"], 
      SubscriptBox[
       TemplateBox[{"3"},
        "Ket"], "1"]}], ",", "1", ",", "1", ",", 
     RowBox[{"f", "[", "a", "]"}], ",", "2", ",", "3", ",", "y", ",", 
     RowBox[{"f", "[", "8", "]"}], ",", "9", ",", 
     RowBox[{"f", "[", "10", "]"}]}], "}"}], ",", 
   RowBox[{"___", 
    SubscriptBox[
     TemplateBox[{"_"},
      "Ket"], "_"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9219488870267954`*^9, 3.921948905487571*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"95d0af5c-ca30-4c71-a45d-b0f2bac17ba4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"3"},
     "Ket"], "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.9219488897710342`*^9, 3.9219489058537683`*^9}},
 CellLabel->
  "Out[634]=",ExpressionUUID->"e01b08fa-e224-4139-9285-f50bc07deb1b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.921948253755091*^9, 
  3.9219501651372023`*^9},ExpressionUUID->"0949639f-d825-4e8f-9c18-\
fbf8f51ac938"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"validStates", ",", 
   RowBox[{
    RowBox[{"_", 
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"]}], "+", "_"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921532151455443*^9, 3.921532182661536*^9}, {
  3.921532271422226*^9, 3.921532337643084*^9}, {3.921532397957655*^9, 
  3.9215324012394896`*^9}, {3.921532974471082*^9, 3.921532999987961*^9}},
 CellLabel->
  "In[580]:=",ExpressionUUID->"25875e83-9e9c-47de-9d31-b39138224f65"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9215329786209*^9, 3.9215330005207644`*^9}},
 CellLabel->
  "Out[580]=",ExpressionUUID->"c47e6109-5b04-4799-92ad-b757ce76b1a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"validStates", ",", 
   RowBox[{"Sum", "[", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"_"},
       "Ket"], "_"], ",", "_"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921532766587878*^9, 3.921532813371369*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"8ecdf7da-f873-4cbb-a92e-105cede07fe6"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.9215328025381985`*^9, 3.9215328138721504`*^9}},
 CellLabel->
  "Out[577]=",ExpressionUUID->"ed88c8c2-16f0-4906-a7f7-4f3c36557f9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"validStates", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "0", "]"}], "]"}], "==", "Ket"}]], "Input",
 CellChangeTimes->{{3.9215323509568157`*^9, 3.92153244302277*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"4432dabc-5b54-44d5-a851-d1ebb3e14c02"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9215321556383533`*^9, 3.9215321830549088`*^9}, {
  3.921532328770241*^9, 3.9215323547882414`*^9}, {3.9215324109879656`*^9, 
  3.9215324440881925`*^9}},
 CellLabel->
  "Out[573]=",ExpressionUUID->"478cd623-e3c6-4526-b86a-d8f5d1b619b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"validStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",ExpressionUUID->"bf283087-115c-\
4b7f-9a08-dc1553dd069d"],

Cell[BoxData[
 RowBox[{"validStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",ExpressionUUID->"c5e04bad-ec32-\
4ccb-9e12-a52e2fff6ad5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "aOps", "]"}]], "Input",
 CellChangeTimes->{{3.9215311480561523`*^9, 3.9215311514728146`*^9}, {
  3.921615165340904*^9, 3.9216151661393375`*^9}},
 CellLabel->
  "In[587]:=",ExpressionUUID->"b73e3dd4-36ec-4c32-8d1f-2d6a40eda7f6"],

Cell[BoxData["36"], "Output",
 CellChangeTimes->{3.921615166608702*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"0980d1c9-e6a6-4e36-a158-c7231447a110"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9216151598249073`*^9, 
  3.921615162587039*^9}},ExpressionUUID->"d6d65a55-5e90-46bc-82b5-\
3b44dd0669d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "!=", "0"}], "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.921531082039147*^9, 3.921531110723776*^9}},
 CellLabel->
  "In[523]:=",ExpressionUUID->"b843d479-71ce-42ca-b872-d9cf772599a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921531104573149*^9, 3.9215311112066183`*^9}},
 CellLabel->
  "Out[523]=",ExpressionUUID->"b7132b50-d142-4e61-9e6b-1f909c82ee14"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"getStateWithoutPrefactors", "[", "#", "]"}], "&"}], ",", 
   "statesHeralded"}], "]"}]], "Input",
 CellChangeTimes->{{3.9215303709393635`*^9, 3.9215303858791323`*^9}, {
  3.9215308403556595`*^9, 3.9215308599068966`*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"33be6526-9db0-4976-b076-54e9ccdb6f12"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "-", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "-", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}], ",", 
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.921530841790413*^9, 3.921530860705645*^9}},
 CellLabel->
  "Out[521]=",ExpressionUUID->"adb50fa5-4bc9-4282-aefa-cc5e2ae57d7c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["heralding patterns", "Subsubsection",
 CellChangeTimes->{{3.9219524926360035`*^9, 
  3.9219524985047894`*^9}},ExpressionUUID->"c281e3a6-161c-448d-b6b7-\
2f619b151ebe"],

Cell[TextData[{
 "By inspection, there are no pairs of photons that would herald a state ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "e2c3bbb9-3ead-4861-88a5-48f9263afa6e"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ba6bca33-9538-4d45-8631-2ec161d89758"],
 " or ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"0"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "4b3460e1-5201-47ff-b2c8-f72b7f54c9f1"],
 "\[PlusMinus]",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "i"], " ", 
   SubscriptBox[
    TemplateBox[{"1"},
     "Ket"], "j"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "fec4dd0b-e432-42eb-88cd-5cb5754b3d8b"],
 ", so we can break up \[Psi]out into two parts and analyze the coefficients \
to see which measurements herald which states. For now, we will assume the \
detectors are not number resolving and ignore the states with two photons in \
the same mode."
}], "Text",
 CellChangeTimes->{{3.920909496236785*^9, 3.9209095898884883`*^9}, {
  3.9209097149915366`*^9, 3.920909741874401*^9}, {3.9211019130215664`*^9, 
  3.9211020211751757`*^9}, {3.921250392028551*^9, 
  3.921250392934794*^9}},ExpressionUUID->"34969d0a-90aa-48cf-a7af-\
854fe9ce7fe2"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "2"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "2"]}], "4"], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "4"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"]}], "4"], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "1"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "3"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "5"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "6"]}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "4"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"]}], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "6"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "7"]}], "4"], "-", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "1"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "3"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "5"], " ", 
        SubscriptBox[
         TemplateBox[{"a"},
          "ConjugateTranspose"], "8"]}], "4"], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "7"], " ", 
       SubscriptBox[
        TemplateBox[{"a"},
         "ConjugateTranspose"], "8"]}]}], ")"}]}]}], TraditionalForm]],
 CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
  3.9209060144807796`*^9},ExpressionUUID->"931356d4-5228-4a85-9073-\
b6ff10db34aa"]], "Text",
 CellChangeTimes->{{3.920908499708667*^9, 3.920908501992181*^9}, {
  3.920908884008483*^9, 
  3.9209088929508543`*^9}},ExpressionUUID->"b5be4602-a92e-4260-9c44-\
8c0e9a49bfd1"],

Cell[TextData[{
 "8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "-", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"de662d6b-8027-4874-aa32-6de524d94aaf"],
 ": ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "c33b9ff2-6f58-44d6-acf0-017fb4ad41e5"],
 ",  ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "2"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "975ab712-c98a-4c0b-afc9-3a51e1589773"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "f3a0826f-423b-4a3c-a66a-3bc53551014b"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "1"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "254341b9-b33f-442f-8caa-483b96a78759"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "5"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "6"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "98034b93-f96b-4246-81f0-b22ac4bb5a9e"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "4"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "5d533182-c8b6-4ea9-8b00-d9cf9a4be4c6"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "3"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "e5352759-3c3b-4256-abe3-e0d438c98d2e"],
 ", ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "7"], " ", 
   SubscriptBox[
    TemplateBox[{"a"},
     "ConjugateTranspose"], "8"]}]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "f6a42288-a525-4a27-b75b-3a2b5bfa1ee5"],
 " \n\n8 patterns herald ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"]}], "+", 
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "2"], " "}]}]],
  CellChangeTimes->{{3.920908344555558*^9, 3.9209084140945477`*^9}},
  ExpressionUUID->"838613ea-48b4-43d6-a79b-5cbe0d8283e2"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "094ae984-e991-420a-be02-be9f19804491"],
 ",  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "2"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ff046b48-7121-437e-bbbc-3fe6ab0d471c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{
       RowBox[{" ", "a"}]},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "271a6c9d-ac7e-42e5-9ecb-0e68b3cfaf7c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "4"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "96daee6a-c916-4ec3-9ba4-92b92c7e1522"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "3"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "8f3d2893-4a2f-4015-bf92-5ea37a688228"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "6"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "7"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "57fd3abe-20c8-4796-9f96-e74a64489d4a"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "ab248bf4-ced8-46e5-9d08-4a4459661cb6"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "5"], " ", 
    SubscriptBox[
     TemplateBox[{"a"},
      "ConjugateTranspose"], "8"]}], TraditionalForm]],
  CellChangeTimes->{3.9209052685304513`*^9, 3.9209053329935417`*^9, 
   3.9209060144807796`*^9},ExpressionUUID->
  "988d20c3-d597-49ea-a524-120ce96cfd7d"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.9209094747263203`*^9}, {3.9209096048768697`*^9, 3.920909630876568*^9}, {
   3.9209096731675744`*^9, 
   3.9209096835364027`*^9}},ExpressionUUID->"2f3346ac-e223-4584-bd7f-\
dbaba0097a01"],

Cell[BoxData[
 FormBox[
  StyleBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"0"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "1", "2"]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "5"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "1"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "3", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "5", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "7", "2"], "4"], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "3"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "7"]}], "2"]}], ")"}]}], "+", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "1"], " ", 
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", 
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "2", "2"]}], "-", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "6"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "2"]}], "2"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "4", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "6", "2"], "4"], "-", 
       FractionBox[
        SubsuperscriptBox[
         RowBox[{"(", 
          TemplateBox[{"a"},
           "ConjugateTranspose"], ")"}], "8", "2"], "4"], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "4"], " ", 
         SubscriptBox[
          TemplateBox[{"a"},
           "ConjugateTranspose"], "8"]}], "2"]}], ")"}]}]}],
   FontWeight->"Plain"], TraditionalForm]], "Input",ExpressionUUID->"1a0c6406-\
fd3f-4c18-b1c1-23c9a8cf2707"],

Cell[TextData[{
 "2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "1"], " ", 
    SubscriptBox[
     TemplateBox[{"0"},
      "Ket"], "2"], " "}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"24296baf-1b6b-4496-ad0c-7e1ebb3f5d30"],
 "and 2 patterns herald ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     TemplateBox[{"1"},
      "Ket"], "1"], " ", 
    RowBox[{
     SubscriptBox[
      TemplateBox[{"1"},
       "Ket"], "2"], " ", "."}]}], TraditionalForm]],
  CellChangeTimes->{{3.9209080309392815`*^9, 3.920908064581772*^9}},
  ExpressionUUID->"ab5d2462-fd16-4e14-bd4c-3059e443bf65"]
}], "Text",
 CellChangeTimes->{{3.920908933530702*^9, 3.9209091232637796`*^9}, {
   3.920909170580491*^9, 3.9209092996835966`*^9}, 3.9209093311153736`*^9, {
   3.9209094017414274`*^9, 3.920909420541523*^9}, {3.9209094673158236`*^9, 
   3.920909487348649*^9}, {3.9209096437272034`*^9, 3.9209097101183753`*^9}, {
   3.920909746659487*^9, 
   3.920909750477916*^9}},ExpressionUUID->"1da061fa-df64-4646-bdf2-\
2d0a5996c3d0"],

Cell["\<\
16 patterns for heralding Bell states, each with an |amplitude| 1/4. 4 \
patterns which herald product states, each with |amplitude| 1/2. 8 two-photon \
patterns which we can\[CloseCurlyQuote]t resolve,  with |amplitude| 1/4. \
Normalize the state.\
\>", "Text",
 CellChangeTimes->{{3.920909783315935*^9, 
  3.9209099797394195`*^9}},ExpressionUUID->"87b43e1f-9ecd-4a1c-99d0-\
e828e4189ac7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"norm", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
       SuperscriptBox[
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"]}], "]"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "include", " ", "only", " ", "the", " ", "events", " ", "with", " ", 
    "photons", " ", "detected", " ", "in", " ", "different", " ", "modes"}], 
   "*)"}]}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a Bell state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], "]"}], "/", 
  "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"d98586fb-c4a4-4f99-83e7-4ec891f8f561"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920910935549213*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"3a1561af-ac93-4556-86b5-814a3a1c5444"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355722184`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"443b3918-cf08-46c0-aa3b-3dfdb2f66fbd"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"fab19078-eb6c-43c9-86fb-06c78a2fc0b7"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.9209109355775003`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"e638003e-c6c8-4bc8-a0ca-1c426b5c0935"]
}, Open  ]],

Cell["\<\
However, if we normalize to all possible detection events including \
two-photons arriving at the same detector, we find the odds of getting a Bell \
state are actually slightly less than what would be achieved with the \
traditional Bell measurement scheme:\
\>", "Text",
 CellChangeTimes->{{3.9209109734262447`*^9, 
  3.9209111154142923`*^9}},ExpressionUUID->"79a2b524-a2f5-4f64-9574-\
cfbd3f93b6ca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
      SuperscriptBox[
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
    "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "include", " ", "all", " ", "possible", " ", "detection", " ", "events"}],
     ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "even"}], " ", "those", " ", "with", 
     " ", "two", " ", "photons", " ", "detected", " ", "in", " ", "the", " ", 
     "same", " ", "mode"}]}], "*)"}], "\[IndentingNewLine]", 
  "\"\<Fraction of detection events which herald a Bell state:\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   SuperscriptBox[
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "&"}], ",", "16"}], "]"}], "2"], "]"}], "/", 
  "norm"}], "\[IndentingNewLine]", "\"\<Fraction of detection events which \
herald a product state:\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], "&"}], ",", "4"}], "]"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], "&"}], ",", "8"}], "]"}], "2"]}], "]"}], 
   "]"}], "/", "norm"}]}], "Input",
 CellChangeTimes->{{3.920910412337701*^9, 3.9209104576037645`*^9}, {
  3.920910523710251*^9, 3.9209105427414975`*^9}, {3.920910592691845*^9, 
  3.9209105941375217`*^9}, {3.920910789456833*^9, 3.920910850854068*^9}, {
  3.92091090869254*^9, 3.920910935202504*^9}, {3.9209111247604403`*^9, 
  3.920911231061555*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"5249349e-d634-4d7b-957c-817c88ef1047"],

Cell[BoxData["\<\"Fraction of detection events which herald a Bell \
state:\"\>"], "Output",
 CellChangeTimes->{3.920911235927408*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"82a6e632-882c-46e6-9d29-cccb29ba60ab"],

Cell[BoxData[
 FractionBox["2", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"3b176131-b9d1-4c45-99ef-fd6d201981e0"],

Cell[BoxData["\<\"Fraction of detection events which herald a product \
state:\"\>"], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"62871f96-9f3d-4bb4-8161-1c0d23fba6bb"],

Cell[BoxData[
 FractionBox["3", "5"]], "Output",
 CellChangeTimes->{3.9209112359433007`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"fd9a9ca8-7a5b-4eb2-bc1d-520de746a4f9"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{960., 508.75},
WindowMargins->{{-4.5, Automatic}, {Automatic, -4.5}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"71be65f7-f4d5-4f92-877d-dacc1c2b587d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 50, "Section",ExpressionUUID->"ba1bde64-675f-4fdc-ba2c-e1439a6494b2"],
Cell[790, 27, 735, 12, 45, "Text",ExpressionUUID->"29422487-e01c-4f5b-96f8-401ca46f4c64"],
Cell[CellGroupData[{
Cell[1550, 43, 250, 4, 41, "Subsection",ExpressionUUID->"5a4b9c93-ce9d-4b4e-8634-03f724636300"],
Cell[1803, 49, 968, 20, 100, "Text",ExpressionUUID->"3e365bfd-2dc7-4001-ad74-26880ef4bed9"],
Cell[2774, 71, 1343, 40, 110, "Input",ExpressionUUID->"fdacad6e-79ce-458e-840c-bfde0bcb83eb"],
Cell[CellGroupData[{
Cell[4142, 115, 5309, 132, 82, "Input",ExpressionUUID->"7b11d53e-138a-400a-8320-9f18181437e1"],
Cell[9454, 249, 28362, 1003, 263, "Output",ExpressionUUID->"cf06a657-7707-4ce1-8038-3d1fffb392f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37853, 1257, 1932, 45, 216, "Input",ExpressionUUID->"990fd1e7-28a6-4d7c-9312-e3bbffd97cc4"],
Cell[39788, 1304, 23331, 704, 282, "Output",ExpressionUUID->"bb9323ff-e8c9-4118-b3e2-55ddb465a0e2"]
}, Open  ]],
Cell[63134, 2011, 254, 6, 27, "Text",ExpressionUUID->"896e5c36-a1c9-46f7-a57a-04508d74523b"],
Cell[CellGroupData[{
Cell[63413, 2021, 524, 15, 24, "Input",ExpressionUUID->"0690dfcc-206d-4e78-91ba-71911753c963"],
Cell[63940, 2038, 202, 3, 24, "Output",ExpressionUUID->"ee458aa8-eb48-48c3-8127-51b21efb1a06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64179, 2046, 276, 4, 21, "Input",ExpressionUUID->"facdc40f-a6b7-42b6-9837-50bfb7291059"],
Cell[64458, 2052, 11306, 377, 135, "Output",ExpressionUUID->"24905025-ee78-4c8a-addd-309eb1955ffa"]
}, Open  ]],
Cell[75779, 2432, 708, 13, 100, "Text",ExpressionUUID->"93d1a0ec-dff0-4e4a-850c-872b93d4e463"],
Cell[CellGroupData[{
Cell[76512, 2449, 1982, 51, 36, "Input",ExpressionUUID->"c9e9018a-b932-4be3-8db4-07588b8a1cbb"],
Cell[78497, 2502, 11218, 377, 154, "Output",ExpressionUUID->"9be71920-6839-4e0b-901c-2ebd54059fbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89752, 2884, 681, 16, 21, "Input",ExpressionUUID->"5f97363a-b724-40c4-b418-b6f6399c6f11"],
Cell[90436, 2902, 199, 3, 24, "Output",ExpressionUUID->"3a396bdf-0dbd-4f9a-a2bf-feb00587a8d6"]
}, Open  ]],
Cell[90650, 2908, 1510, 38, 122, "Input",ExpressionUUID->"7df1503b-775a-4da1-95ed-78cce3ad250f"],
Cell[92163, 2948, 1812, 57, 49, "Text",ExpressionUUID->"68a4fa9f-9829-4cf5-8093-4fc0538ab02f"],
Cell[93978, 3007, 8680, 284, 55, "Text",ExpressionUUID->"4c8cbc99-5a1f-4e64-a72f-ce09177c4e47"],
Cell[102661, 3293, 7251, 247, 68, "Text",ExpressionUUID->"9c447253-686b-4c3f-9f34-f313b746827c"],
Cell[109915, 3542, 2929, 99, 40, "Input",ExpressionUUID->"227d41a0-ccdf-4dbb-86df-3055b98a9a81"],
Cell[112847, 3643, 1152, 33, 31, "Text",ExpressionUUID->"3b934450-60af-4722-b0fc-e7d5cdc8582a"],
Cell[114002, 3678, 400, 8, 45, "Text",ExpressionUUID->"0557cc37-1f00-46f0-b7c2-e7504ea1b706"],
Cell[CellGroupData[{
Cell[114427, 3690, 1659, 45, 126, "Input",ExpressionUUID->"68aa6622-3632-4376-ae06-2ef5b6c06471"],
Cell[116089, 3737, 213, 3, 24, "Output",ExpressionUUID->"a05624dc-cc25-49fa-8070-1a4c4410f990"],
Cell[116305, 3742, 171, 3, 39, "Output",ExpressionUUID->"0a12aa38-4467-4d9d-a528-5ae1391c7fa8"],
Cell[116479, 3747, 218, 3, 24, "Output",ExpressionUUID->"5c2468d5-cd72-419a-8c25-66340c54c8b0"],
Cell[116700, 3752, 171, 3, 39, "Output",ExpressionUUID->"374c60b7-b4be-496d-9e0c-39ef3226b19f"]
}, Open  ]],
Cell[116886, 3758, 412, 8, 45, "Text",ExpressionUUID->"14a3b6f0-50bf-4f65-8399-0a7ba3d27174"],
Cell[CellGroupData[{
Cell[117323, 3770, 2206, 62, 140, "Input",ExpressionUUID->"1c7f3ea0-1f4a-4499-94e2-019055d35b18"],
Cell[119532, 3834, 213, 3, 24, "Output",ExpressionUUID->"d94751fb-c01c-4140-86a6-eaf65669698c"],
Cell[119748, 3839, 171, 3, 39, "Output",ExpressionUUID->"5b78c348-017c-404c-813d-2222c496fba7"],
Cell[119922, 3844, 218, 3, 24, "Output",ExpressionUUID->"10e74847-2f5b-4bb3-9cd5-c0bbc3e217e9"],
Cell[120143, 3849, 171, 3, 39, "Output",ExpressionUUID->"9fecd32a-9cb8-49eb-8529-dfb677d22b03"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[120363, 3858, 299, 4, 30, "Subsection",ExpressionUUID->"74461a26-51b1-44f3-947d-27731a78d2cf"],
Cell[120665, 3864, 1034, 21, 109, "Text",ExpressionUUID->"be1f3efc-36c4-4638-bab5-f49b0d7a1b01"],
Cell[121702, 3887, 1343, 40, 110, "Input",ExpressionUUID->"0e71092d-419a-45de-934e-fb8169158d33"],
Cell[CellGroupData[{
Cell[123070, 3931, 4241, 106, 99, "Input",ExpressionUUID->"a6c338b6-cd6f-47c3-918d-62854ebf2d1b"],
Cell[127314, 4039, 10465, 396, 174, "Output",ExpressionUUID->"c1dcc0e5-f937-4f2b-9078-e17849a703e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137816, 4440, 1932, 45, 216, "Input",ExpressionUUID->"03788572-f6dc-46ca-a009-98da09215437"],
Cell[139751, 4487, 7822, 261, 168, "Output",ExpressionUUID->"db3feb37-dcd0-4ed3-ae6a-4e6f8c9cfa39"]
}, Open  ]],
Cell[147588, 4751, 254, 6, 25, "Text",ExpressionUUID->"e7aa20f3-a582-4fb4-bf11-4e7ef6c4d600"],
Cell[CellGroupData[{
Cell[147867, 4761, 524, 15, 23, "Input",ExpressionUUID->"b4e64dde-6ccb-4e34-9369-da601b1fc5b3"],
Cell[148394, 4778, 202, 3, 26, "Output",ExpressionUUID->"ba495579-29fb-43a3-afb5-00d33316e075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148633, 4786, 276, 4, 23, "Input",ExpressionUUID->"d3c403b5-c16a-43a1-842f-ca9bf51ee1be"],
Cell[148912, 4792, 7746, 260, 168, "Output",ExpressionUUID->"0be912b1-f449-4f18-84d9-661385adf732"]
}, Open  ]],
Cell[156673, 5055, 708, 13, 125, "Text",ExpressionUUID->"7a3d8050-2414-4271-855f-78f170a6490a"],
Cell[CellGroupData[{
Cell[157406, 5072, 1982, 51, 50, "Input",ExpressionUUID->"e60cc60e-f8c7-452d-82e2-19c703fafe5d"],
Cell[159391, 5125, 7686, 260, 167, "Output",ExpressionUUID->"9f6a901c-09a3-43a4-96cd-29bb5a0911f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167114, 5390, 681, 16, 36, "Input",ExpressionUUID->"c4b6d782-444f-45ec-ae82-b6c7aae69da9"],
Cell[167798, 5408, 199, 3, 26, "Output",ExpressionUUID->"32d229da-1430-42b2-97d0-ca915bc96cc4"]
}, Open  ]],
Cell[168012, 5414, 1510, 38, 122, "Input",ExpressionUUID->"8f801a6b-cab4-44df-9c21-cdbceca4aed9"],
Cell[169525, 5454, 1812, 57, 85, "Text",ExpressionUUID->"d1d8315a-6a95-4b06-ad62-b3f5f38e8960"],
Cell[171340, 5513, 1024, 31, 31, "Text",ExpressionUUID->"1f1cba31-d2f1-4bfb-9fb7-c19ef0cb5254"],
Cell[172367, 5546, 3466, 114, 84, "Input",ExpressionUUID->"2f2148e4-7ae5-472a-aa94-5e4cc38cffa5"],
Cell[175836, 5662, 3052, 97, 65, "Text",ExpressionUUID->"171aeb0f-f8bf-4bf9-a168-e6aa6f59f44b"],
Cell[178891, 5761, 4738, 154, 75, "Input",ExpressionUUID->"067848ad-d8f9-4e2b-98ad-e7552d3288af"],
Cell[183632, 5917, 400, 8, 42, "Text",ExpressionUUID->"d8717362-dc76-4d2e-8543-710a1d5de05a"],
Cell[CellGroupData[{
Cell[184057, 5929, 1659, 45, 142, "Input",ExpressionUUID->"78f4fb49-849d-49d2-9a79-5a5745ecb6f6"],
Cell[185719, 5976, 213, 3, 26, "Output",ExpressionUUID->"24957581-0bdd-4c67-b3a1-8fbb661cc192"],
Cell[185935, 5981, 171, 3, 40, "Output",ExpressionUUID->"db5e49b8-1376-4612-bbf3-98df9e5a932f"],
Cell[186109, 5986, 218, 3, 26, "Output",ExpressionUUID->"3f357d42-32f5-493c-8fc2-d762782d5dfa"],
Cell[186330, 5991, 171, 3, 40, "Output",ExpressionUUID->"49cdc155-ee31-479e-a0b4-0029604078df"]
}, Open  ]],
Cell[186516, 5997, 412, 8, 59, "Text",ExpressionUUID->"2307627d-788d-4eb5-9e45-29fe98da7523"],
Cell[CellGroupData[{
Cell[186953, 6009, 2206, 62, 156, "Input",ExpressionUUID->"d2ad43f7-b950-492f-b991-0626d563a862"],
Cell[189162, 6073, 213, 3, 26, "Output",ExpressionUUID->"4ee9bc86-1dc0-455a-af62-22c91f2fd9ed"],
Cell[189378, 6078, 171, 3, 40, "Output",ExpressionUUID->"32650325-5a48-485d-a441-c61333c74ceb"],
Cell[189552, 6083, 218, 3, 26, "Output",ExpressionUUID->"5137b8be-60f8-4d9c-8c8a-709398a355d6"],
Cell[189773, 6088, 171, 3, 40, "Output",ExpressionUUID->"2db8aa03-379f-4427-939a-141fd50ea173"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[189993, 6097, 491, 8, 30, "Subsection",ExpressionUUID->"796a3f33-c13b-422a-b4df-ddf7327eb9fc"],
Cell[190487, 6107, 968, 20, 100, "Text",ExpressionUUID->"06e59ceb-0948-493c-a1c9-53158f48f94f"],
Cell[191458, 6129, 1349, 41, 110, "Input",ExpressionUUID->"6d23b60c-70a1-4aba-8d6e-85c11339850d"],
Cell[CellGroupData[{
Cell[192832, 6174, 5315, 133, 82, "Input",ExpressionUUID->"df02de35-0a1e-47f0-aa0e-65e0f2acb4b6"],
Cell[198150, 6309, 16006, 611, 171, "Output",ExpressionUUID->"7b047a85-9794-4137-87cd-f0c4fb00ea56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214193, 6925, 1937, 46, 216, "Input",ExpressionUUID->"538848c2-2f5c-4e4a-8d3a-a82576bfbbc0"],
Cell[216133, 6973, 11376, 376, 135, "Output",ExpressionUUID->"9f29417c-5d8a-4010-94fe-1b94c190a2b3"]
}, Open  ]],
Cell[227524, 7352, 254, 6, 27, "Text",ExpressionUUID->"27f2d663-6a66-42e0-989c-5afa5d2745c0"],
Cell[CellGroupData[{
Cell[227803, 7362, 529, 16, 24, "Input",ExpressionUUID->"c554fefb-18d0-4887-84ff-0add0a46e6e0"],
Cell[228335, 7380, 229, 4, 24, "Output",ExpressionUUID->"b5b9689a-6dd1-4fc5-be23-c29f272881f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228601, 7389, 15444, 426, 687, "Input",ExpressionUUID->"e3380705-cf9f-4909-836b-2e125089f6d8"],
Cell[CellGroupData[{
Cell[244070, 7819, 616, 10, 18, "Print",ExpressionUUID->"fe2a717c-63af-4b74-b950-be79b2f96437"],
Cell[244689, 7831, 1795, 63, 38, "Print",ExpressionUUID->"18407e81-b41f-415f-871c-3444659b88b9"],
Cell[246487, 7896, 643, 11, 18, "Print",ExpressionUUID->"a6e3e227-aa45-4eb8-92a5-d65afbdea414"]
}, Open  ]],
Cell[247145, 7910, 3337, 106, 129, "Output",ExpressionUUID->"41456e99-cf46-4a04-8775-0b12ca084f4f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250543, 8023, 204, 4, 50, "Section",ExpressionUUID->"27b89521-e416-4a44-b265-3b8020c27432"],
Cell[CellGroupData[{
Cell[250772, 8031, 357, 7, 34, "Subsubsection",ExpressionUUID->"054d14d8-8100-4e97-aa83-8b6f76a26375"],
Cell[251132, 8040, 247, 6, 27, "Text",ExpressionUUID->"f45dc3c2-92bb-44f4-a87f-74aa9f92effb"],
Cell[251382, 8048, 344, 7, 27, "Text",ExpressionUUID->"8998201f-8ee9-4eee-a720-a167e356c09e"],
Cell[CellGroupData[{
Cell[251751, 8059, 344, 7, 21, InheritFromParent,ExpressionUUID->"562bd3fd-16f1-4df0-a05a-b623f1cec7c3"],
Cell[252098, 8068, 266, 6, 24, "Output",ExpressionUUID->"cd64fe7b-09dc-494a-a45c-524db1c8e9f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252401, 8079, 967, 34, 36, "Input",ExpressionUUID->"ea8aadc3-f636-439e-8ddd-8abaad73e6c9"],
Cell[253371, 8115, 283, 6, 39, "Output",ExpressionUUID->"c056c3b9-04eb-4623-8f50-49f1ab04afc6"]
}, Open  ]],
Cell[253669, 8124, 1018, 35, 39, "Input",ExpressionUUID->"845a21e8-f92b-4aca-8967-879001bf731c"],
Cell[CellGroupData[{
Cell[254712, 8163, 608, 17, 36, "Input",ExpressionUUID->"9ffe797c-2ab8-4fdb-b461-db6e7e8a3eb5"],
Cell[255323, 8182, 446, 8, 24, "Output",ExpressionUUID->"108246b0-5743-4e59-8107-836f16f03d75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255806, 8195, 241, 5, 36, "Input",ExpressionUUID->"bea5723d-6cd9-4df7-a77a-caff34e71cbe"],
Cell[256050, 8202, 161, 3, 24, "Output",ExpressionUUID->"466c3eaa-f0c7-4daf-a164-f5496b944feb"]
}, Open  ]],
Cell[256226, 8208, 160, 3, 21, "Input",ExpressionUUID->"5aa980e3-a9f4-497e-b02d-da780356dd7f"],
Cell[CellGroupData[{
Cell[256411, 8215, 835, 31, 25, "Input",ExpressionUUID->"81b7ea50-1cc5-4983-b090-18bbfa1b603a"],
Cell[257249, 8248, 225, 5, 24, "Output",ExpressionUUID->"1b94b0f0-0f49-4280-946a-ae0cd85e6e2c"]
}, Open  ]],
Cell[257489, 8256, 4322, 131, 139, "Input",ExpressionUUID->"e2bea2b0-a51c-46ef-b55d-993779013fec"],
Cell[CellGroupData[{
Cell[261836, 8391, 1067, 40, 36, "Input",ExpressionUUID->"17312149-1fef-4363-b418-cdbe1e4a0679"],
Cell[262906, 8433, 158, 3, 24, "Output",ExpressionUUID->"f3fcbe38-364e-4bdb-9b74-212c1f05389f"]
}, Open  ]],
Cell[263079, 8439, 985, 37, 28, "Input",ExpressionUUID->"8480a91e-5a29-4230-8a7f-5e980a8ab996"],
Cell[CellGroupData[{
Cell[264089, 8480, 800, 27, 28, "Input",ExpressionUUID->"8e9f252c-c9bd-4d9b-817c-ccd185f2c41f"],
Cell[264892, 8509, 463, 17, 28, "Output",ExpressionUUID->"f6e8e541-8d3e-46fe-bef4-94a78477b985"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265392, 8531, 1058, 32, 28, "Input",ExpressionUUID->"0d65dfb6-4a2e-46b5-a57f-d9a9fc3bbf90"],
Cell[266453, 8565, 666, 21, 28, "Output",ExpressionUUID->"679431da-6736-464e-9d0d-461a8d7bbf2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267156, 8591, 881, 30, 28, "Input",ExpressionUUID->"97744d6b-f3ee-4ea6-b36d-3084841e316e"],
Cell[268040, 8623, 512, 19, 28, "Output",ExpressionUUID->"0d1204eb-7986-4cbb-897f-ceb8938b76c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268589, 8647, 1183, 39, 28, "Input",ExpressionUUID->"35351b94-5e63-401b-9741-7cd5f5c14f12"],
Cell[269775, 8688, 194, 4, 24, "Output",ExpressionUUID->"f24b8286-49f7-4cb6-b079-0898a478920d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270006, 8697, 1442, 48, 28, "Input",ExpressionUUID->"746c61c1-636b-4719-a782-185a5ae62015"],
Cell[271451, 8747, 300, 6, 24, "Output",ExpressionUUID->"d9aae294-4461-4442-aa74-2f3063124f3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271788, 8758, 1400, 48, 28, "Input",ExpressionUUID->"6403bc70-696a-4098-83c6-26f0fc81a204"],
Cell[273191, 8808, 907, 35, 31, "Output",ExpressionUUID->"c0eb9b02-f5b1-4bc7-86b3-c898c8d58fc4"]
}, Open  ]],
Cell[274113, 8846, 1306, 46, 28, "Input",ExpressionUUID->"5767a2ac-1014-45be-a48a-44a7dc03befd"],
Cell[CellGroupData[{
Cell[275444, 8896, 724, 22, 28, "Input",ExpressionUUID->"6c25e3db-7a68-4467-959c-e10f9e9fe871"],
Cell[276171, 8920, 194, 4, 24, "Output",ExpressionUUID->"cfe58887-4581-4206-bf62-e8ab919e7449"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276402, 8929, 711, 22, 28, "Input",ExpressionUUID->"ebc660c9-6a58-45fd-8b95-cd214cc8bd93"],
Cell[277116, 8953, 395, 12, 28, "Output",ExpressionUUID->"1757da17-0863-4898-8042-0f8d11fb086a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277548, 8970, 688, 21, 28, "Input",ExpressionUUID->"7d2e549e-dca2-4615-bd2d-d255558b1181"],
Cell[278239, 8993, 346, 11, 28, "Output",ExpressionUUID->"2e2100ee-7909-4207-aaa2-ff4891ea3baa"]
}, Open  ]],
Cell[278600, 9007, 152, 3, 21, "Input",ExpressionUUID->"0eac660c-ef02-4fdd-a3d7-904bf67e756a"],
Cell[CellGroupData[{
Cell[278777, 9014, 491, 12, 28, "Input",ExpressionUUID->"159e02b7-363b-4ddd-9868-066fa33af947"],
Cell[279271, 9028, 194, 4, 24, "Output",ExpressionUUID->"a20eccda-52ff-4199-b776-5434171c2f75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279502, 9037, 357, 10, 28, "Input",ExpressionUUID->"f5f652df-6671-4f22-b561-732156184b02"],
Cell[279862, 9049, 198, 4, 24, "Output",ExpressionUUID->"36c14575-510c-4dfc-8179-8bf391b927ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280097, 9058, 454, 13, 21, "Input",ExpressionUUID->"156a2de9-f020-4460-b705-62b368eedefc"],
Cell[280554, 9073, 288, 5, 24, "Output",ExpressionUUID->"60b4a3a0-c817-4f65-b818-4df1baaf3824"]
}, Open  ]],
Cell[280857, 9081, 144, 3, 21, "Input",ExpressionUUID->"434c7fa0-30a9-4a2f-b932-8e0daa0ec8ae"],
Cell[281004, 9086, 144, 3, 21, "Input",ExpressionUUID->"ba2648f6-8ba7-464b-9954-faa0b9d69067"],
Cell[CellGroupData[{
Cell[281173, 9093, 266, 5, 21, "Input",ExpressionUUID->"bcd1bdb3-a5e4-4a1b-b8c4-a92a091db542"],
Cell[281442, 9100, 154, 3, 24, "Output",ExpressionUUID->"db3988c6-d753-472a-b31c-ea4f3b5ce8bc"]
}, Open  ]],
Cell[281611, 9106, 154, 3, 21, InheritFromParent,ExpressionUUID->"09c3178d-5778-4a19-8b32-5c16afafbe7a"],
Cell[CellGroupData[{
Cell[281790, 9113, 552, 17, 21, "Input",ExpressionUUID->"6fbf90aa-0a68-4672-bd8b-567fc2c899b4"],
Cell[282345, 9132, 322, 9, 24, "Output",ExpressionUUID->"4ad81e1c-ad8c-4304-9b27-6983ff7dcb5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282704, 9146, 375, 9, 21, "Input",ExpressionUUID->"f2048f2a-dc39-44d6-ae72-3a78c9b1cc8d"],
Cell[283082, 9157, 1926, 77, 28, "Output",ExpressionUUID->"9a87dec5-27a8-43d6-8660-51394c602408"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[285057, 9240, 173, 3, 29, "Subsubsection",ExpressionUUID->"f107a1b5-5005-49eb-a1dc-4e1691bcf81c"],
Cell[285233, 9245, 1911, 58, 49, "Text",ExpressionUUID->"c3ea9baa-9bb1-4e0a-ab74-c199853905ae"],
Cell[287147, 9305, 8680, 284, 55, "Text",ExpressionUUID->"a8bea38e-5406-4ad3-8150-c9b82d31a6fc"],
Cell[295830, 9591, 7251, 247, 68, "Text",ExpressionUUID->"d82b43cf-0f9c-4694-aac5-507e5c8b4bdc"],
Cell[303084, 9840, 2929, 99, 40, "Input",ExpressionUUID->"29f5795f-dbe5-4986-8be8-3fca903f6e44"],
Cell[306016, 9941, 1152, 33, 31, "Text",ExpressionUUID->"c21357f7-7dc2-45b9-8dba-03c84ebf255d"],
Cell[307171, 9976, 400, 8, 45, "Text",ExpressionUUID->"133c08af-b490-4252-9d2e-a900aa8a33c4"],
Cell[CellGroupData[{
Cell[307596, 9988, 1659, 45, 126, "Input",ExpressionUUID->"15ef4c28-cfb5-45b6-af92-219e0755edb6"],
Cell[309258, 10035, 213, 3, 24, "Output",ExpressionUUID->"f45c399b-eab7-4bb3-b0fd-640661f723c6"],
Cell[309474, 10040, 171, 3, 39, "Output",ExpressionUUID->"c7fb7d71-710f-4661-8469-f65513c5e6ca"],
Cell[309648, 10045, 218, 3, 24, "Output",ExpressionUUID->"0f6bf3fe-0437-4693-b692-c945b3c84cb2"],
Cell[309869, 10050, 171, 3, 39, "Output",ExpressionUUID->"0c082d88-4bc6-4efe-9e6d-2fec0f74da28"]
}, Open  ]],
Cell[310055, 10056, 412, 8, 45, "Text",ExpressionUUID->"14485818-c671-433c-ba66-4655ac977f8a"],
Cell[CellGroupData[{
Cell[310492, 10068, 2206, 62, 140, "Input",ExpressionUUID->"01682fe4-fe7c-4f02-9eb9-4764cf0d062c"],
Cell[312701, 10132, 213, 3, 24, "Output",ExpressionUUID->"52887c83-28e2-4d31-9795-362db7c2e0a2"],
Cell[312917, 10137, 171, 3, 39, "Output",ExpressionUUID->"de696cd3-7dd6-4a8a-8803-f6f3c36a320e"],
Cell[313091, 10142, 218, 3, 24, "Output",ExpressionUUID->"ce52e5e7-a7ad-4053-9a5d-609ed4666673"],
Cell[313312, 10147, 171, 3, 39, "Output",ExpressionUUID->"434f4d0e-5963-4600-8194-6515ca89c0a7"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[313532, 10156, 155, 3, 29, "Subsubsection",ExpressionUUID->"2a3d44d2-d295-4ea1-a4b3-4e27d857c4fd"],
Cell[CellGroupData[{
Cell[313712, 10163, 466, 15, 25, "Input",ExpressionUUID->"ada376d2-dc9a-42fd-80f3-e0f87766311e"],
Cell[314181, 10180, 428, 13, 28, "Output",ExpressionUUID->"6a9a8b00-68d8-4982-9a33-5619b5f0d817"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314646, 10198, 239, 6, 21, "Input",ExpressionUUID->"ae9ec4c8-a105-4a14-8fc6-5dd232832525"],
Cell[314888, 10206, 266, 6, 24, "Output",ExpressionUUID->"c6a42074-3ac3-48f9-9d68-35bebe8e56ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315191, 10217, 664, 20, 25, "Input",ExpressionUUID->"664312cd-5c4f-472c-8558-228b061b6f7f"],
Cell[315858, 10239, 617, 19, 28, "Output",ExpressionUUID->"6de82bed-ce52-4e71-adb4-4dc7de1d934a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316512, 10263, 845, 32, 96, "Input",ExpressionUUID->"8b1c4027-7e4a-4ed8-839c-5d9acfc05e33"],
Cell[317360, 10297, 194, 4, 24, "Output",ExpressionUUID->"d947e275-c828-4151-80ff-e3153a3a5862"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317591, 10306, 2192, 55, 202, "Input",ExpressionUUID->"1b67f3bf-a730-437d-82ba-57bd6c5bf2ec"],
Cell[CellGroupData[{
Cell[319808, 10365, 375, 12, 19, "Print",ExpressionUUID->"bcbf4adb-a201-4400-b0b2-96603997f0ee"],
Cell[320186, 10379, 373, 12, 19, "Print",ExpressionUUID->"be3ba821-6d82-4030-9ed0-a55a43281af8"],
Cell[320562, 10393, 373, 12, 19, "Print",ExpressionUUID->"39dd96ec-0b59-44b3-8664-7a12e8624471"],
Cell[320938, 10407, 373, 12, 19, "Print",ExpressionUUID->"27321107-1629-44fc-9857-1db37b364b88"],
Cell[321314, 10421, 373, 12, 19, "Print",ExpressionUUID->"57d92ecd-1709-4755-9fb4-ec71a4c9583f"],
Cell[321690, 10435, 373, 12, 19, "Print",ExpressionUUID->"390a9210-5e71-47ac-b49f-c49eceb1f7cc"],
Cell[322066, 10449, 373, 12, 19, "Print",ExpressionUUID->"c1661334-ebf1-4d1a-a093-c98dcd2afa05"],
Cell[322442, 10463, 373, 12, 19, "Print",ExpressionUUID->"71f680b4-8243-4e9d-8aa6-82a3228f231b"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[322876, 10482, 395, 8, 30, "Subsection",ExpressionUUID->"193087ec-8546-43bb-b7a8-29dc61c0111c"],
Cell[323274, 10492, 968, 20, 100, "Text",ExpressionUUID->"35b3848d-b5cf-4f6a-8f80-7c2a9518dc4b"],
Cell[324245, 10514, 1343, 40, 110, "Input",ExpressionUUID->"95f874b1-1700-452f-8a92-afc733d1f2cf"],
Cell[CellGroupData[{
Cell[325613, 10558, 5309, 132, 82, "Input",ExpressionUUID->"e1f20290-245b-4aa6-a0a9-5072edd9c3dd"],
Cell[330925, 10692, 28362, 1003, 263, "Output",ExpressionUUID->"765c2990-48b5-4500-895d-946be51eec91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359324, 11700, 1932, 45, 216, "Input",ExpressionUUID->"48ec06e5-c9a2-4d9f-b832-5c5d1d648c26"],
Cell[361259, 11747, 23331, 704, 282, "Output",ExpressionUUID->"102c4316-7d36-4a05-a308-76feb59834dd"]
}, Open  ]],
Cell[384605, 12454, 254, 6, 27, "Text",ExpressionUUID->"ffcde52b-6c71-4ee6-8093-cc29d75502bb"],
Cell[CellGroupData[{
Cell[384884, 12464, 524, 15, 24, "Input",ExpressionUUID->"7edf914d-e556-476a-a18c-013027442fc1"],
Cell[385411, 12481, 202, 3, 24, "Output",ExpressionUUID->"e7b3ea48-dd13-48d1-b76d-322bfa44fe34"]
}, Open  ]],
Cell[385628, 12487, 445, 10, 63, "Text",ExpressionUUID->"eefd9884-62c5-467f-aa13-e192d6185a8e"],
Cell[386076, 12499, 4222, 104, 109, "Input",ExpressionUUID->"eab61bca-4122-4e0e-b615-d0a953a2a662"],
Cell[CellGroupData[{
Cell[390323, 12607, 1587, 40, 122, "Input",ExpressionUUID->"669aba74-5910-482c-a666-ef8c9414164d"],
Cell[391913, 12649, 594, 12, 33, "Output",ExpressionUUID->"8f671697-4275-44ac-b72b-f02b135984f3"],
Cell[392510, 12663, 596, 12, 33, "Output",ExpressionUUID->"7d00959b-fff8-4e36-a765-f7c55e74afe1"],
Cell[393109, 12677, 596, 12, 33, "Output",ExpressionUUID->"2aff5c29-c353-4e50-9968-a8e665d0f706"],
Cell[393708, 12691, 596, 12, 33, "Output",ExpressionUUID->"b03c24fc-453a-4d32-a6aa-31c6724dc06b"],
Cell[394307, 12705, 594, 12, 33, "Output",ExpressionUUID->"87542101-cf93-4bef-b8c1-39b89d2add2b"],
Cell[394904, 12719, 594, 12, 33, "Output",ExpressionUUID->"1bdb6cce-ec9a-4a44-bb3b-7b81183368fb"],
Cell[395501, 12733, 594, 12, 33, "Output",ExpressionUUID->"0cb90de9-22a3-4ba7-8fa9-0908aac5336a"],
Cell[396098, 12747, 596, 12, 33, "Output",ExpressionUUID->"cc956468-9a0a-4f39-bd85-dbfa27884a57"]
}, Open  ]],
Cell[396709, 12762, 176, 3, 21, "Input",ExpressionUUID->"800cb7c3-ef8b-4bc5-bfdc-29004baa7642"],
Cell[396888, 12767, 211, 4, 21, "Input",ExpressionUUID->"03dea4c3-7113-40f2-b115-7a4444090477"],
Cell[CellGroupData[{
Cell[397124, 12775, 216, 4, 21, InheritFromParent,ExpressionUUID->"cebd212a-2fc9-4417-979f-9dd210eed8d6"],
Cell[397343, 12781, 191, 4, 24, "Output",ExpressionUUID->"248297c5-805c-4239-b447-bc85c8afbcfd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397571, 12790, 187, 3, 21, "Input",ExpressionUUID->"201b88f2-22e3-4f6b-99a0-fdcdc70bd47b"],
Cell[397761, 12795, 164, 3, 24, "Output",ExpressionUUID->"dbcdf54c-a2b2-4569-879a-a5d379458a1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397962, 12803, 256, 5, 21, "Input",ExpressionUUID->"97428c8f-c0e9-4a0d-9d26-1601fb1374b4"],
Cell[398221, 12810, 320, 7, 24, "Output",ExpressionUUID->"610f6e5d-9269-4685-9fba-d34bfcfbf345"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398578, 12822, 1222, 31, 38, "Input",ExpressionUUID->"ad956fd0-7360-46af-ad5a-140495d4d2dc"],
Cell[399803, 12855, 984, 23, 39, "Output",ExpressionUUID->"0c465a21-ad91-442c-90fa-cd3da9ec44f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[400824, 12883, 407, 10, 21, "Input",ExpressionUUID->"6980351a-ca7c-4ac6-84dd-e072616ba2b4"],
Cell[401234, 12895, 235, 4, 24, "Output",ExpressionUUID->"4dac9569-60af-413b-9b14-51fc5b987cf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[401506, 12904, 295, 6, 21, "Input",ExpressionUUID->"dacea9c9-c779-4409-9b5e-75040cecd945"],
Cell[401804, 12912, 1657, 71, 26, "Output",ExpressionUUID->"51f66591-32bd-48ce-94f4-71bc32ba0398"]
}, Open  ]],
Cell[CellGroupData[{
Cell[403498, 12988, 2486, 65, 50, "Input",ExpressionUUID->"c2549459-07a9-42cf-9390-066c14d4c116"],
Cell[405987, 13055, 19704, 771, 148, "Output",ExpressionUUID->"d3babc71-7bde-4abb-8fa2-a953b0000578"]
}, Open  ]],
Cell[425706, 13829, 232, 4, 27, "Text",ExpressionUUID->"26e8a332-1e1f-42ed-a5de-41251d7f5d09"],
Cell[CellGroupData[{
Cell[425963, 13837, 1524, 43, 53, "Input",ExpressionUUID->"38e5df3c-a12e-4272-8ef7-e31a89c82b5c"],
Cell[427490, 13882, 1455, 63, 28, "Output",ExpressionUUID->"5dfc2f75-0106-465c-82ff-3f1f205fe006"]
}, Open  ]],
Cell[CellGroupData[{
Cell[428982, 13950, 702, 17, 36, "Input",ExpressionUUID->"ed12f9bb-ed25-4fd7-82b6-4f29e408ff12"],
Cell[429687, 13969, 38037, 1478, 240, "Output",ExpressionUUID->"115bc7f7-89e6-465c-aedb-9340db4d6a3f"]
}, Open  ]],
Cell[467739, 15450, 443, 9, 45, "Text",ExpressionUUID->"c33fbcea-b064-48ff-94cb-fc6f7aa5141a"],
Cell[CellGroupData[{
Cell[468207, 15463, 217, 5, 21, "Input",ExpressionUUID->"f873ce24-f1f0-4762-829d-ae2accc0a7d7"],
Cell[468427, 15470, 2103, 86, 41, "Output",ExpressionUUID->"eb37ba73-1931-4047-bc41-74e1da9ab9dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470567, 15561, 298, 6, 21, "Input",ExpressionUUID->"e812169d-b292-4fee-a3d1-cec795299780"],
Cell[470868, 15569, 2002, 83, 41, "Output",ExpressionUUID->"476245e4-ec7c-4332-a0bf-ce269d6055a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[472907, 15657, 693, 19, 23, "Input",ExpressionUUID->"884add1b-c438-4185-8770-f508bf168a1a"],
Cell[473603, 15678, 2102, 83, 41, "Output",ExpressionUUID->"ca89e004-9de7-47ea-98d2-5be05e46f379"]
}, Open  ]],
Cell[CellGroupData[{
Cell[475742, 15766, 736, 30, 22, "Input",ExpressionUUID->"06b05388-bfcf-41aa-8f35-7286ae77b6e5"],
Cell[476481, 15798, 158, 3, 24, "Output",ExpressionUUID->"57d1859e-94d7-4a8a-9d9e-355d56b3d867"]
}, Open  ]],
Cell[CellGroupData[{
Cell[476676, 15806, 776, 23, 25, "Input",ExpressionUUID->"ff5f7949-0fd3-4855-a6d6-d4fe63d7ef0e"],
Cell[477455, 15831, 564, 15, 39, "Output",ExpressionUUID->"06b09f62-8478-455e-85f3-474f338204db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[478056, 15851, 377, 9, 21, "Input",ExpressionUUID->"e94b33ef-33bb-4452-a84a-19f5bc36c972"],
Cell[478436, 15862, 153, 3, 24, "Output",ExpressionUUID->"e305f8e2-ce58-4aa0-af09-da1855740bdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[478626, 15870, 214, 5, 21, "Input",ExpressionUUID->"5ab3263b-cdfe-4732-b015-2ca022c49cd4"],
Cell[478843, 15877, 878, 37, 26, "Output",ExpressionUUID->"879ec2bf-19f9-477e-a253-5f735e533383"]
}, Open  ]],
Cell[CellGroupData[{
Cell[479758, 15919, 594, 19, 21, "Input",ExpressionUUID->"f0048fbd-672b-4293-9928-ac527980ac7b"],
Cell[480355, 15940, 1080, 43, 40, "Output",ExpressionUUID->"e26a76ad-46b7-497e-9786-ab936b49a7a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[481472, 15988, 1266, 46, 23, "Input",ExpressionUUID->"adc70d77-48ed-48d3-a98a-b1f64039e3b1"],
Cell[482741, 16036, 297, 6, 24, "Output",ExpressionUUID->"d3c7b4e1-38ce-4649-80db-42e3c74d998b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483075, 16047, 824, 23, 21, "Input",ExpressionUUID->"05a976b1-146c-4103-9076-1c7ffb4bae5d"],
Cell[483902, 16072, 1082, 43, 40, "Output",ExpressionUUID->"be45c175-8574-421d-a0be-38307b5803c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485021, 16120, 1307, 39, 38, "Input",ExpressionUUID->"2d8c9107-90ef-459a-b85b-e583b7e5542b"],
Cell[486331, 16161, 714, 14, 22, "Message",ExpressionUUID->"bd1f99e3-4f94-42f1-8202-4476334ef012"],
Cell[487048, 16177, 583, 17, 26, "Output",ExpressionUUID->"c8f34380-2b2d-4c39-8d90-15b431201ce4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487668, 16199, 706, 20, 23, "Input",ExpressionUUID->"e93dea84-3205-4dbc-a518-ca192761bf22"],
Cell[488377, 16221, 9840, 413, 45, "Output",ExpressionUUID->"deb9ff63-69e7-4e63-bb00-c09700d1fe32"]
}, Open  ]],
Cell[498232, 16637, 685, 19, 23, "Input",ExpressionUUID->"82acf61c-dcff-438f-8959-da749b22f9e4"],
Cell[CellGroupData[{
Cell[498942, 16660, 518, 13, 21, "Input",ExpressionUUID->"385c280f-cbf6-4d1b-9145-203cdab3a969"],
Cell[499463, 16675, 581, 10, 24, "Output",ExpressionUUID->"37415b72-65a0-4970-8084-39a52b3a5e56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[500081, 16690, 539, 15, 21, "Input",ExpressionUUID->"5f4d47fa-9e62-473c-aecd-9eee5bb87601"],
Cell[500623, 16707, 181, 3, 24, "Output",ExpressionUUID->"b3e68d44-a108-4f4c-a74f-4aa95b6ef97c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[500841, 16715, 372, 9, 21, "Input",ExpressionUUID->"82e1ffd1-63c9-4e04-8ec7-85088b6a8309"],
Cell[501216, 16726, 372, 9, 22, "Message",ExpressionUUID->"d9fba332-2a1b-4636-8710-a5bc29887fa9"],
Cell[501591, 16737, 412, 10, 22, "Message",ExpressionUUID->"8819ca62-9159-480b-9ad9-d4f9e88a10e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[502040, 16752, 367, 9, 21, InheritFromParent,ExpressionUUID->"94d8e6b0-2791-4a72-ad6d-22dd339e8036"],
Cell[502410, 16763, 497, 13, 24, "Output",ExpressionUUID->"18f43c1f-1b3c-4c30-b245-b9b9a43818d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[502944, 16781, 305, 8, 21, "Input",ExpressionUUID->"0f10cecd-8417-4355-ae10-f87939dab213"],
Cell[503252, 16791, 219, 5, 24, "Output",ExpressionUUID->"f2dff92d-a3d6-49b4-ae94-f46acf3da916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503508, 16801, 179, 3, 21, "Input",ExpressionUUID->"3c86929a-8a79-415e-af99-027dc4538593"],
Cell[503690, 16806, 878, 37, 26, "Output",ExpressionUUID->"e9296bbe-158a-4eec-ad58-745982f67811"]
}, Open  ]],
Cell[CellGroupData[{
Cell[504605, 16848, 1134, 27, 23, "Input",ExpressionUUID->"9784a9c2-56db-428a-9a92-abbfa79a98c3"],
Cell[505742, 16877, 139680, 5078, 797, "Output",ExpressionUUID->"ab6099e7-1817-4415-b0a1-b87c9f31312b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[645459, 21960, 463, 11, 21, "Input",ExpressionUUID->"5dfa06f7-549f-4049-b41f-60bffddb9bd3"],
Cell[645925, 21973, 229, 5, 24, "Output",ExpressionUUID->"3fc0519e-8271-4f35-8319-fb93915eb8d4"]
}, Open  ]],
Cell[646169, 21981, 308, 5, 21, "Input",ExpressionUUID->"7f31760b-ebef-4935-af64-808ceaa7dc05"],
Cell[646480, 21988, 1911, 58, 49, "Text",ExpressionUUID->"93bc6892-64e1-4b24-806f-03bb40bc4e25"],
Cell[648394, 22048, 8680, 284, 55, "Text",ExpressionUUID->"7d5f4521-086e-436a-8e03-cf745980cc1b"],
Cell[657077, 22334, 7251, 247, 68, "Text",ExpressionUUID->"35b21fe6-90a3-43bd-89be-9cf12e436387"],
Cell[664331, 22583, 2929, 99, 40, "Input",ExpressionUUID->"dad91494-fe8c-4806-83f5-f20924a2435f"],
Cell[667263, 22684, 1152, 33, 31, "Text",ExpressionUUID->"0b1be21c-cfff-4364-b85d-26f66ae61d52"],
Cell[668418, 22719, 400, 8, 45, "Text",ExpressionUUID->"92c3b245-4719-4589-9a9f-728534f1aa19"],
Cell[CellGroupData[{
Cell[668843, 22731, 1659, 45, 126, "Input",ExpressionUUID->"3a4dc14e-72be-4169-9ab7-9438047721a1"],
Cell[670505, 22778, 213, 3, 24, "Output",ExpressionUUID->"9de9aac6-beae-4723-acdc-8fd6d14a5f1d"],
Cell[670721, 22783, 171, 3, 39, "Output",ExpressionUUID->"3795cea8-2617-4dba-b635-b31d63b2cace"],
Cell[670895, 22788, 218, 3, 24, "Output",ExpressionUUID->"c6aba67e-3386-4eed-a597-2a3948ba33f1"],
Cell[671116, 22793, 171, 3, 39, "Output",ExpressionUUID->"0b3b5349-3821-4ffc-b493-b9ecd20e80d5"]
}, Open  ]],
Cell[671302, 22799, 412, 8, 45, "Text",ExpressionUUID->"3b3358ff-c711-45d9-960d-0e4f39f7ef67"],
Cell[CellGroupData[{
Cell[671739, 22811, 2206, 62, 140, "Input",ExpressionUUID->"0d66911a-0bd4-4fd2-9a0d-6f2059cbc638"],
Cell[673948, 22875, 213, 3, 24, "Output",ExpressionUUID->"25a9ad02-444c-4e8d-b172-7d791b17ba42"],
Cell[674164, 22880, 171, 3, 39, "Output",ExpressionUUID->"91fcbb0a-5f29-4fa9-86c8-2c1ef2bd6c98"],
Cell[674338, 22885, 218, 3, 24, "Output",ExpressionUUID->"8ef7d732-8020-46fe-974d-77ea81ee2895"],
Cell[674559, 22890, 171, 3, 39, "Output",ExpressionUUID->"6b49c163-ad4a-4616-8fa2-d14778bfb603"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[674779, 22899, 538, 9, 30, "Subsection",ExpressionUUID->"e61a11c5-2701-419a-b2fb-41b744005df9"],
Cell[675320, 22910, 968, 20, 100, "Text",ExpressionUUID->"25586c9a-c79c-4bae-b0c5-c6b8b202bf7f"],
Cell[676291, 22932, 1348, 41, 110, "Input",ExpressionUUID->"6e5dd0a2-eb54-45ef-a198-5625c967de37"],
Cell[CellGroupData[{
Cell[677664, 22977, 5314, 133, 82, "Input",ExpressionUUID->"f38e86be-f385-4d49-83a1-cf1745bdb239"],
Cell[682981, 23112, 15981, 611, 171, "Output",ExpressionUUID->"3065fefe-d707-4315-a04e-90b098255217"]
}, Open  ]],
Cell[CellGroupData[{
Cell[698999, 23728, 1936, 46, 216, "Input",ExpressionUUID->"b79ac29f-8c0d-4a90-93ba-5311b7e926b2"],
Cell[700938, 23776, 11353, 376, 135, "Output",ExpressionUUID->"cc763afb-a676-426c-914c-1e6fc169377f"]
}, Open  ]],
Cell[712306, 24155, 254, 6, 27, "Text",ExpressionUUID->"cc501e67-ac4b-41dc-a6b5-02a7e6aef78e"],
Cell[CellGroupData[{
Cell[712585, 24165, 524, 15, 24, "Input",ExpressionUUID->"d12f9960-daef-4514-86c5-df10dcaf0acd"],
Cell[713112, 24182, 202, 3, 24, "Output",ExpressionUUID->"0a3d1360-cc4e-43ae-8354-5ae1dc95fd35"]
}, Open  ]],
Cell[713329, 24188, 445, 10, 63, "Text",ExpressionUUID->"d3dba80c-8748-4176-a5a0-08d0b884d0be"],
Cell[713777, 24200, 4341, 105, 124, "Input",ExpressionUUID->"1e7b700c-eea0-4a8f-a087-7588cc07117d"],
Cell[CellGroupData[{
Cell[718143, 24309, 1587, 40, 122, "Input",ExpressionUUID->"8847451f-10df-4986-99ca-16346de7c458"],
Cell[719733, 24351, 507, 8, 24, "Output",ExpressionUUID->"58118228-6389-4ab8-9fa1-0e24521ba445"],
Cell[720243, 24361, 507, 8, 24, "Output",ExpressionUUID->"aa746e28-6d5d-4027-a8bf-13f818b8dcbc"],
Cell[720753, 24371, 507, 8, 24, "Output",ExpressionUUID->"e50a3b81-280d-4e9e-a0b7-e40e165db3db"],
Cell[721263, 24381, 506, 8, 24, "Output",ExpressionUUID->"e4ba0bef-fe6e-49a3-97d7-0a7775883c82"],
Cell[721772, 24391, 509, 8, 24, "Output",ExpressionUUID->"38e13d80-0f19-464d-ad66-f8c9a2e67755"],
Cell[722284, 24401, 509, 8, 24, "Output",ExpressionUUID->"b2ab640f-0f8d-4ee3-8df6-07336220b704"],
Cell[722796, 24411, 507, 8, 24, "Output",ExpressionUUID->"4e61a404-1bca-4278-b582-3c0dca4f0315"],
Cell[723306, 24421, 507, 8, 24, "Output",ExpressionUUID->"84b41e54-0fdd-4d28-8eb2-ac4213f7690e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[723850, 24434, 1222, 31, 38, "Input",ExpressionUUID->"4335d170-7a0c-4740-a44a-3832106e4467"],
Cell[725075, 24467, 1006, 23, 39, "Output",ExpressionUUID->"5d3fdc43-57fd-4241-a620-7d1899cf0651"]
}, Open  ]],
Cell[CellGroupData[{
Cell[726118, 24495, 407, 10, 21, "Input",ExpressionUUID->"02ac4ff2-07a0-44d2-93c1-da9a42d86bd6"],
Cell[726528, 24507, 235, 4, 24, "Output",ExpressionUUID->"78dd8061-f8d0-49dd-9bb1-cb022ded1dca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[726800, 24516, 295, 6, 21, "Input",ExpressionUUID->"02ddf7db-880e-45b0-a341-eb145d81685a"],
Cell[727098, 24524, 1657, 71, 26, "Output",ExpressionUUID->"797aa666-39f5-463f-8dfd-15e363ed8e65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[728792, 24600, 2432, 63, 36, "Input",ExpressionUUID->"7baa1b82-0100-4dd5-8c4d-41eb190d49a8"],
Cell[731227, 24665, 4127, 131, 146, "Output",ExpressionUUID->"d63022fc-4cd3-4782-befd-4cbd9cc68b40"]
}, Open  ]],
Cell[735369, 24799, 232, 4, 27, "Text",ExpressionUUID->"b035c6e2-fd7c-4f31-9e94-96756e3e7378"],
Cell[CellGroupData[{
Cell[735626, 24807, 1071, 31, 39, "Input",ExpressionUUID->"8f5c4af7-2bd6-4f86-8901-106ed1ada38d"],
Cell[736700, 24840, 778, 33, 28, "Output",ExpressionUUID->"4bb15b7b-9e76-4099-bc55-58d9bf60850b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[737515, 24878, 637, 14, 21, "Input",ExpressionUUID->"4c9c5495-1205-4a45-81db-cde69291f15f"],
Cell[738155, 24894, 3358, 100, 104, "Output",ExpressionUUID->"4b44c965-179b-4859-97ac-4da4a02bd0f9"]
}, Open  ]],
Cell[741528, 24997, 443, 9, 45, "Text",ExpressionUUID->"fe46663e-9346-4432-b914-c2cd00610a00"],
Cell[CellGroupData[{
Cell[741996, 25010, 298, 6, 21, "Input",ExpressionUUID->"ae6251bd-8ecd-4a7a-8725-1fa4c8143176"],
Cell[742297, 25018, 622, 18, 41, "Output",ExpressionUUID->"321c89da-3d3b-49cb-a8a3-042578c2c5d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[742956, 25041, 498, 13, 21, "Input",ExpressionUUID->"08f8adf8-92f1-4be1-b14d-1f4c2bc55d5d"],
Cell[743457, 25056, 327, 8, 24, "Output",ExpressionUUID->"233e57ba-50ee-4430-a792-69a4e13d6790"]
}, Open  ]],
Cell[CellGroupData[{
Cell[743821, 25069, 829, 22, 21, "Input",ExpressionUUID->"eadcdf08-4683-46f2-a378-4bb9c0e11628"],
Cell[744653, 25093, 1500, 41, 44, "Output",ExpressionUUID->"7e5bf8a0-3ae8-45c8-bd35-00311395db43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[746190, 25139, 625, 15, 36, "Input",ExpressionUUID->"f986f0ee-4ea4-4348-a157-f307e7af466d"],
Cell[746818, 25156, 624, 18, 41, "Output",ExpressionUUID->"7329a68d-e6fc-4e32-ac00-fb2cb4214b53"],
Cell[747445, 25176, 829, 17, 39, "Output",ExpressionUUID->"1c50ec99-5698-44cf-9831-ed90c749eeee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[748311, 25198, 1122, 30, 36, "Input",ExpressionUUID->"9c8700b2-95ad-4e43-8076-9005cc443960"],
Cell[749436, 25230, 3673, 87, 130, "Output",ExpressionUUID->"ffbf5442-1f91-4ae7-a175-790a8bd555ab"]
}, Open  ]],
Cell[753124, 25320, 268, 6, 27, "Text",ExpressionUUID->"5ecb4185-da56-4a89-b36f-9379dd5a4d26"],
Cell[CellGroupData[{
Cell[753417, 25330, 294, 7, 21, "Input",ExpressionUUID->"976742e7-779a-4908-ab42-b2a5ed4144ff"],
Cell[753714, 25339, 330, 7, 39, "Output",ExpressionUUID->"dcbf2366-d020-461a-ae68-56b3488c31ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[754081, 25351, 187, 3, 21, "Input",ExpressionUUID->"5990b94c-b100-4250-be89-53987af06c38"],
Cell[754271, 25356, 800, 33, 28, "Output",ExpressionUUID->"1a4e9d01-064c-44fa-9bb4-0238418104e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[755108, 25394, 619, 17, 21, "Input",ExpressionUUID->"1bc36d87-b68c-4e46-b1a8-a0fa656c5d02"],
Cell[755730, 25413, 2477, 97, 43, "Output",ExpressionUUID->"4bfa34a4-bd5b-4a2d-8681-f8f64066abfa"]
}, Open  ]],
Cell[758222, 25513, 1415, 33, 36, "Input",ExpressionUUID->"a8d78d5f-fb0c-45b4-bec1-6b5c3be233a6"],
Cell[CellGroupData[{
Cell[759662, 25550, 688, 23, 36, "Input",ExpressionUUID->"f93138bb-bcc8-4f1a-8f29-e6146751dcd6"],
Cell[760353, 25575, 465, 18, 28, "Output",ExpressionUUID->"8484e606-37a8-4938-b701-34a7b20883b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[760855, 25598, 1156, 36, 38, "Input",ExpressionUUID->"e22bb895-d612-40ce-a081-0c25d3b8fcd4"],
Cell[762014, 25636, 386, 7, 24, "Output",ExpressionUUID->"011bcaf5-5b58-4c2f-9367-d96c565469dc"]
}, Open  ]],
Cell[762415, 25646, 979, 20, 64, "Text",ExpressionUUID->"cb3b16c0-4c70-4337-beb1-00f03224cc08"],
Cell[CellGroupData[{
Cell[763419, 25670, 1150, 28, 36, "Input",ExpressionUUID->"31b54a1c-d95e-46f2-bb48-a420f6a007a2"],
Cell[764572, 25700, 9821, 402, 150, "Output",ExpressionUUID->"69dca628-3f8a-434e-b9c7-3b9118280828"]
}, Open  ]],
Cell[CellGroupData[{
Cell[774430, 26107, 290, 5, 36, "Input",ExpressionUUID->"a32cdea5-34de-4be7-996b-795ef46f090f"],
Cell[774723, 26114, 154, 3, 24, "Output",ExpressionUUID->"3b7d5feb-e218-4437-bbc3-d05471ae1da6"],
Cell[774880, 26119, 154, 3, 24, "Output",ExpressionUUID->"c3084533-d70c-42a2-8ab0-bdb9f0b7c677"]
}, Open  ]],
Cell[CellGroupData[{
Cell[775071, 26127, 532, 11, 21, "Input",ExpressionUUID->"b6809d16-a3ad-4d12-8baa-b7282a09af9f"],
Cell[775606, 26140, 13464, 511, 221, "Output",ExpressionUUID->"1c3973b2-c051-4289-bde4-338ff98eaf7f"]
}, Open  ]],
Cell[789085, 26654, 400, 8, 45, "Text",ExpressionUUID->"c0ad6000-1f01-4e05-8f27-0ce1d91be034"],
Cell[CellGroupData[{
Cell[789510, 26666, 654, 14, 36, "Input",ExpressionUUID->"ddae2b1e-a3a7-470f-bd3e-4294b7ee17c1"],
Cell[790167, 26682, 9769, 402, 150, "Output",ExpressionUUID->"1154266d-0302-4021-9074-fa4939f34a52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[799973, 27089, 229, 5, 34, "Subsubsection",ExpressionUUID->"dd2ace86-8039-472d-b458-8ef55dac2822"],
Cell[CellGroupData[{
Cell[800227, 27098, 300, 6, 21, "Input",ExpressionUUID->"5f4b443e-74f7-4067-8be8-e2b7ea250e14"],
Cell[800530, 27106, 4853, 144, 130, "Output",ExpressionUUID->"4ad643f5-a854-4e1e-ae2f-1264d9de4501"]
}, Open  ]],
Cell[CellGroupData[{
Cell[805420, 27255, 4042, 96, 150, "Input",ExpressionUUID->"a86a706c-744b-4515-b16e-609316dc666b"],
Cell[809465, 27353, 816, 26, 34, "Print",ExpressionUUID->"b7755c31-f4f5-4f42-a2c2-f38bf66cc68f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[810318, 27384, 278, 6, 21, "Input",ExpressionUUID->"d3c8aa73-f3b2-4b69-b4b9-0b235c18f1be"],
Cell[810599, 27392, 220, 5, 24, "Output",ExpressionUUID->"70c6be31-2ed6-4da6-819f-fabdaed6b127"]
}, Open  ]],
Cell[CellGroupData[{
Cell[810856, 27402, 400, 11, 40, "Input",ExpressionUUID->"50786d56-ef86-4600-a8c6-0708fd9ff3d4"],
Cell[811259, 27415, 236, 6, 24, "Output",ExpressionUUID->"f25f5c71-cb60-4dde-be9b-5f06600554a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[811532, 27426, 374, 12, 40, "Input",ExpressionUUID->"bfacb578-8b8a-4b7f-b010-4c7a274ef98c"],
Cell[811909, 27440, 218, 5, 24, "Output",ExpressionUUID->"f3da609c-81ea-4755-9dc7-b184b3f860e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[812164, 27450, 278, 6, 21, "Input",ExpressionUUID->"b8f15443-ee7f-43e5-a93c-2edf375c2728"],
Cell[812445, 27458, 220, 5, 24, "Output",ExpressionUUID->"56d24719-a9dd-4958-9601-e6c1fecadbba"]
}, Open  ]],
Cell[812680, 27466, 752, 20, 36, "Input",ExpressionUUID->"c3bb9368-813a-4d5c-bd69-1e94e417066b"],
Cell[813435, 27488, 156, 3, 21, "Input",ExpressionUUID->"df09738b-e1b5-447b-a689-3faa4b4a3b07"],
Cell[CellGroupData[{
Cell[813616, 27495, 305, 7, 21, "Input",ExpressionUUID->"7b43667c-2844-4d0e-ae7c-a4e841f96244"],
Cell[813924, 27504, 7828, 251, 192, "Output",ExpressionUUID->"6382360e-9401-4316-b6b9-8eaa02395125"]
}, Open  ]],
Cell[821767, 27758, 1282, 32, 64, "Input",ExpressionUUID->"ee6b26f6-cbe2-4407-a6a2-058ff6ec4a93"],
Cell[CellGroupData[{
Cell[823074, 27794, 199, 3, 21, "Input",ExpressionUUID->"862b53ab-99e3-46ed-99a2-2eec801ff3ba"],
Cell[823276, 27799, 5992, 186, 111, "Output",ExpressionUUID->"18fc4a48-0a4b-4e34-92a3-08e30fa63433"]
}, Open  ]],
Cell[829283, 27988, 2035, 55, 122, "Input",ExpressionUUID->"4a91ac10-5ad3-40fd-a0bb-a170e79169f9"],
Cell[CellGroupData[{
Cell[831343, 28047, 198, 3, 21, "Input",ExpressionUUID->"45f93d51-7bf7-4d2c-8c8a-baf2ffa93167"],
Cell[831544, 28052, 2289, 69, 76, "Output",ExpressionUUID->"c252acb8-228f-4457-b70c-5d8fe084bfdb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[833882, 28127, 305, 7, 34, "Subsubsection",ExpressionUUID->"20fc6b2d-d577-4b9e-8b0c-c1fc65849c15"],
Cell[834190, 28136, 247, 6, 27, "Text",ExpressionUUID->"cb1f53ed-1cc1-404c-8335-b8fa00976e3a"],
Cell[834440, 28144, 344, 7, 27, "Text",ExpressionUUID->"f7333b32-9e14-460c-8139-05046096cdd2"],
Cell[CellGroupData[{
Cell[834809, 28155, 344, 7, 21, InheritFromParent,ExpressionUUID->"1df282b7-834b-445d-aaec-a1c8b1d7a492"],
Cell[835156, 28164, 266, 6, 24, "Output",ExpressionUUID->"7f445c33-407d-4885-920a-e39aac1852fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[835459, 28175, 967, 34, 36, "Input",ExpressionUUID->"04eb16c7-fb48-4679-86ee-2b8815dde837"],
Cell[836429, 28211, 283, 6, 39, "Output",ExpressionUUID->"f3510bcd-4911-4179-97b2-76a5129dceca"]
}, Open  ]],
Cell[836727, 28220, 1018, 35, 39, "Input",ExpressionUUID->"590bcf45-0a6d-4847-a8cf-d0d39195814b"],
Cell[CellGroupData[{
Cell[837770, 28259, 608, 17, 36, "Input",ExpressionUUID->"cad0c05b-0d2b-4ba5-bf51-5b4c7f8cd1c7"],
Cell[838381, 28278, 446, 8, 24, "Output",ExpressionUUID->"6012f42c-519d-4570-a1e6-61333789ac9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[838864, 28291, 241, 5, 36, "Input",ExpressionUUID->"c1c7d3b3-52f1-45fb-94fa-bd6fb0866101"],
Cell[839108, 28298, 161, 3, 24, "Output",ExpressionUUID->"1dbfeb7f-5dd0-48ca-a967-1c995ea77c0c"]
}, Open  ]],
Cell[839284, 28304, 160, 3, 21, "Input",ExpressionUUID->"aa35a8fc-4cd5-4ff0-8af7-6c371383a806"],
Cell[CellGroupData[{
Cell[839469, 28311, 835, 31, 25, "Input",ExpressionUUID->"e3c69973-e528-4cf3-9f62-6e11a5b40ecf"],
Cell[840307, 28344, 225, 5, 24, "Output",ExpressionUUID->"d9dfa1de-b21d-44b5-95a1-b69011e270af"]
}, Open  ]],
Cell[840547, 28352, 4322, 131, 139, "Input",ExpressionUUID->"8d52dc0f-f0ce-4a3a-82c5-71e734350239"],
Cell[CellGroupData[{
Cell[844894, 28487, 1067, 40, 36, "Input",ExpressionUUID->"8deaf9e2-cefe-4b06-8ac3-a7db6a4137fb"],
Cell[845964, 28529, 158, 3, 24, "Output",ExpressionUUID->"6a47e864-9164-4c11-aca9-b0828c2b7035"]
}, Open  ]],
Cell[846137, 28535, 985, 37, 28, "Input",ExpressionUUID->"b588e630-8b01-4d0e-a79d-9a2efc5fac6f"],
Cell[CellGroupData[{
Cell[847147, 28576, 800, 27, 28, "Input",ExpressionUUID->"d0940aba-73ca-4ea0-987e-b038ed24f990"],
Cell[847950, 28605, 463, 17, 28, "Output",ExpressionUUID->"f498c3a7-64f5-49df-b84e-f756a1f7bfdd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[848450, 28627, 1058, 32, 28, "Input",ExpressionUUID->"88ebd716-79b8-4c72-b205-50738a911e4e"],
Cell[849511, 28661, 666, 21, 28, "Output",ExpressionUUID->"046c0618-dbd6-4913-9195-1712d3e7c748"]
}, Open  ]],
Cell[CellGroupData[{
Cell[850214, 28687, 881, 30, 28, "Input",ExpressionUUID->"229c7679-b451-42db-baf1-3f7964973570"],
Cell[851098, 28719, 512, 19, 28, "Output",ExpressionUUID->"984c49fb-461e-49ee-8b30-ed2c09bf8b76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[851647, 28743, 1183, 39, 28, "Input",ExpressionUUID->"43e579e3-3580-484d-93ff-a4d850f673ff"],
Cell[852833, 28784, 194, 4, 24, "Output",ExpressionUUID->"92c4503c-641c-42e9-bbb8-796b0d98cda5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[853064, 28793, 1442, 48, 28, "Input",ExpressionUUID->"5754db48-49a6-4bf5-9acf-4f7f99d19bcd"],
Cell[854509, 28843, 300, 6, 24, "Output",ExpressionUUID->"bdca9420-8609-4b55-a0bf-0cf9eefe6180"]
}, Open  ]],
Cell[CellGroupData[{
Cell[854846, 28854, 1400, 48, 28, "Input",ExpressionUUID->"a158af68-1b66-48ca-a851-feb50ab80489"],
Cell[856249, 28904, 907, 35, 31, "Output",ExpressionUUID->"7c1b9793-390c-4027-809b-5f8a55a088b6"]
}, Open  ]],
Cell[857171, 28942, 1306, 46, 28, "Input",ExpressionUUID->"8bcf0818-1474-40e4-9368-e5832e5cb856"],
Cell[CellGroupData[{
Cell[858502, 28992, 724, 22, 28, "Input",ExpressionUUID->"4a907a91-d63c-4210-bdb0-b12891369fb5"],
Cell[859229, 29016, 194, 4, 24, "Output",ExpressionUUID->"e5199214-07df-4ce7-90b9-2fa2b6a3777f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[859460, 29025, 711, 22, 28, "Input",ExpressionUUID->"b0f6b4da-41d2-4d01-a4ac-2f6b0d27136c"],
Cell[860174, 29049, 395, 12, 28, "Output",ExpressionUUID->"8a872d9b-8c43-4e3a-a640-6ad81f0bd6f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[860606, 29066, 688, 21, 28, "Input",ExpressionUUID->"95d0af5c-ca30-4c71-a45d-b0f2bac17ba4"],
Cell[861297, 29089, 346, 11, 28, "Output",ExpressionUUID->"e01b08fa-e224-4139-9285-f50bc07deb1b"]
}, Open  ]],
Cell[861658, 29103, 152, 3, 21, "Input",ExpressionUUID->"0949639f-d825-4e8f-9c18-fbf8f51ac938"],
Cell[CellGroupData[{
Cell[861835, 29110, 491, 12, 28, "Input",ExpressionUUID->"25875e83-9e9c-47de-9d31-b39138224f65"],
Cell[862329, 29124, 194, 4, 24, "Output",ExpressionUUID->"c47e6109-5b04-4799-92ad-b757ce76b1a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[862560, 29133, 357, 10, 28, "Input",ExpressionUUID->"8ecdf7da-f873-4cbb-a92e-105cede07fe6"],
Cell[862920, 29145, 198, 4, 24, "Output",ExpressionUUID->"ed88c8c2-16f0-4906-a7f7-4f3c36557f9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[863155, 29154, 454, 13, 21, "Input",ExpressionUUID->"4432dabc-5b54-44d5-a851-d1ebb3e14c02"],
Cell[863612, 29169, 288, 5, 24, "Output",ExpressionUUID->"478cd623-e3c6-4526-b86a-d8f5d1b619b1"]
}, Open  ]],
Cell[863915, 29177, 144, 3, 21, "Input",ExpressionUUID->"bf283087-115c-4b7f-9a08-dc1553dd069d"],
Cell[864062, 29182, 144, 3, 21, "Input",ExpressionUUID->"c5e04bad-ec32-4ccb-9e12-a52e2fff6ad5"],
Cell[CellGroupData[{
Cell[864231, 29189, 266, 5, 21, "Input",ExpressionUUID->"b73e3dd4-36ec-4c32-8d1f-2d6a40eda7f6"],
Cell[864500, 29196, 154, 3, 24, "Output",ExpressionUUID->"0980d1c9-e6a6-4e36-a158-c7231447a110"]
}, Open  ]],
Cell[864669, 29202, 154, 3, 21, InheritFromParent,ExpressionUUID->"d6d65a55-5e90-46bc-82b5-3b44dd0669d9"],
Cell[CellGroupData[{
Cell[864848, 29209, 552, 17, 21, "Input",ExpressionUUID->"b843d479-71ce-42ca-b872-d9cf772599a0"],
Cell[865403, 29228, 322, 9, 24, "Output",ExpressionUUID->"b7132b50-d142-4e61-9e6b-1f909c82ee14"]
}, Open  ]],
Cell[CellGroupData[{
Cell[865762, 29242, 375, 9, 21, "Input",ExpressionUUID->"33be6526-9db0-4976-b076-54e9ccdb6f12"],
Cell[866140, 29253, 1926, 77, 28, "Output",ExpressionUUID->"adb50fa5-4bc9-4282-aefa-cc5e2ae57d7c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[868115, 29336, 173, 3, 29, "Subsubsection",ExpressionUUID->"c281e3a6-161c-448d-b6b7-2f619b151ebe"],
Cell[868291, 29341, 1911, 58, 67, "Text",ExpressionUUID->"34969d0a-90aa-48cf-a7af-854fe9ce7fe2"],
Cell[870205, 29401, 8680, 284, 55, "Text",ExpressionUUID->"b5be4602-a92e-4260-9c44-8c0e9a49bfd1"],
Cell[878888, 29687, 7251, 247, 68, "Text",ExpressionUUID->"2f3346ac-e223-4584-bd7f-dbaba0097a01"],
Cell[886142, 29936, 2929, 99, 40, "Input",ExpressionUUID->"1a0c6406-fd3f-4c18-b1c1-23c9a8cf2707"],
Cell[889074, 30037, 1152, 33, 31, "Text",ExpressionUUID->"1da061fa-df64-4646-bdf2-2d0a5996c3d0"],
Cell[890229, 30072, 400, 8, 45, "Text",ExpressionUUID->"87b43e1f-9ecd-4a1c-99d0-e828e4189ac7"],
Cell[CellGroupData[{
Cell[890654, 30084, 1659, 45, 126, "Input",ExpressionUUID->"d98586fb-c4a4-4f99-83e7-4ec891f8f561"],
Cell[892316, 30131, 213, 3, 24, "Output",ExpressionUUID->"3a1561af-ac93-4556-86b5-814a3a1c5444"],
Cell[892532, 30136, 171, 3, 39, "Output",ExpressionUUID->"443b3918-cf08-46c0-aa3b-3dfdb2f66fbd"],
Cell[892706, 30141, 218, 3, 24, "Output",ExpressionUUID->"fab19078-eb6c-43c9-86fb-06c78a2fc0b7"],
Cell[892927, 30146, 171, 3, 39, "Output",ExpressionUUID->"e638003e-c6c8-4bc8-a0ca-1c426b5c0935"]
}, Open  ]],
Cell[893113, 30152, 412, 8, 45, "Text",ExpressionUUID->"79a2b524-a2f5-4f64-9574-cfbd3f93b6ca"],
Cell[CellGroupData[{
Cell[893550, 30164, 2206, 62, 140, "Input",ExpressionUUID->"5249349e-d634-4d7b-957c-817c88ef1047"],
Cell[895759, 30228, 213, 3, 24, "Output",ExpressionUUID->"82a6e632-882c-46e6-9d29-cccb29ba60ab"],
Cell[895975, 30233, 171, 3, 39, "Output",ExpressionUUID->"3b176131-b9d1-4c45-99ef-fd6d201981e0"],
Cell[896149, 30238, 218, 3, 24, "Output",ExpressionUUID->"62871f96-9f3d-4bb4-8161-1c0d23fba6bb"],
Cell[896370, 30243, 171, 3, 39, "Output",ExpressionUUID->"fd9a9ca8-7a5b-4eb2-bc1d-520de746a4f9"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

